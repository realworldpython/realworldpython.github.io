{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Titus 2 is a fork of the original Titus python library which resides in the (now defunct) Hadrian repository . Titus is not actively maintained by the Open Data Group and only supports Python 2, so this fork was created to actively support its development for Python 3. Titus 2 is a complete, independent implementation of PFA in pure Python. It focuses on model development, so it includes model producers and PFA manipulation tools in addition to runtime execution (scoring) engine.","title":"Overview"},{"location":"about/","text":"I am Ankit Mahato, a Full-Stack Data/Computational Scientist and an Educationist. A die hard Pythonista, I am also an open source contributor and a former Google Summer of Code (GSoC) scholar under Python Software Foundation 1 . With a decade of Python programming experience and 8+ years of industrial and research experience (Associate - JP Morgan, Data Scientist & Product Manager - Fuzzy Logix, USA) in machine learning, quantitative modelling, data analytics and visualization, I have developed an expertise in handling the entire data analytics pipeline comprising \u2013 ingestion, exploration, transformation, modeling and deployment. An IIT Kanpur alumnus, I am also an active researcher with publications on scientific computing ( Google Scholar , Research Gate ) in international journal and conferences. An active member of the Python Community, I have delivered talks in PyCon India 2017 , Scipy India 2017 , Scipy India 2018 , PyCon India 2019 , and Scipy India 2019 . I am passionate about education and love teaching Python. My goal is to make Python programming accessible to everyone at all levels of knowledge and experience. After spending years pouring through boooks, research papers and working on real life projects across various industrial sectors, I decided to create Real World Python, a guide to help people solve analytical problems pertaining to any walk of life. Is a real world problem bothering you? Don't worry, I will help you conquer it! You can connect with me over: E-mail Twitter Linkedin Github Youtube GSoC 2013: SfePy \u21a9","title":"Ankit Mahato"},{"location":"contribute/","text":"Issues, Questions and Feature Requests \u00b6 Please raise an issue/question/request here . Development \u00b6 Want to contribute? Great! Please raise an issue to discuss your ideas and send a pull request . Some contribution ideas are as follows: Write MORE Tests for scripts/* . Add scikit-learn model export to PFA tutorials.","title":"Contribute"},{"location":"contribute/#issues-questions-and-feature-requests","text":"Please raise an issue/question/request here .","title":"Issues, Questions and Feature Requests"},{"location":"contribute/#development","text":"Want to contribute? Great! Please raise an issue to discuss your ideas and send a pull request . Some contribution ideas are as follows: Write MORE Tests for scripts/* . Add scikit-learn model export to PFA tutorials.","title":"Development"},{"location":"installation/","text":"Requirements \u00b6 Titus 2 uses a number of open source projects to work properly: avro-python3 >= 1.8.2 numpy >= 1.15.0 pytz >= 2019.1 pyyaml >= 5.1.2 ply >= 3.11 The above packages are available via pip3 and are automatically installed during setup. Installation \u00b6 Titus 2 requires Python 3.4+ to run. The latest version of Python 3 can be downloaded from the official website . It can be installed via pip3 as follows: 1 pip3 install titus2 or you can directly install the developer version from github repository via 1 pip3 install git+https://github.com/animator/titus2.git Attention The library is named titus2 as it is a fork which is not maintained by the original developers of the titus library. To an end user, the module is still accessible as titus to ensure compatibilty across Python 2.x and 3.x codes. Verify Installation \u00b6 To confirm your installation please run the following elementary example in python: 1 2 3 4 5 6 7 8 9 10 11 12 13 from titus.genpy import PFAEngine pfa = { \"input\" : \"double\" , \"output\" : \"double\" , \"action\" : [ { \"+\" : [ \"input\" , 100 ]} ]} engine , = PFAEngine . fromJson ( pfa ) l = [ 1.0 , 2.0 , 3.0 , 4.0 , 5.0 ] for num in l : print ( num , engine . action ( num )) Error If you are getting any error message please contact the author via e-mail or raise an issue here .","title":"Installation"},{"location":"installation/#requirements","text":"Titus 2 uses a number of open source projects to work properly: avro-python3 >= 1.8.2 numpy >= 1.15.0 pytz >= 2019.1 pyyaml >= 5.1.2 ply >= 3.11 The above packages are available via pip3 and are automatically installed during setup.","title":"Requirements"},{"location":"installation/#installation","text":"Titus 2 requires Python 3.4+ to run. The latest version of Python 3 can be downloaded from the official website . It can be installed via pip3 as follows: 1 pip3 install titus2 or you can directly install the developer version from github repository via 1 pip3 install git+https://github.com/animator/titus2.git Attention The library is named titus2 as it is a fork which is not maintained by the original developers of the titus library. To an end user, the module is still accessible as titus to ensure compatibilty across Python 2.x and 3.x codes.","title":"Installation"},{"location":"installation/#verify-installation","text":"To confirm your installation please run the following elementary example in python: 1 2 3 4 5 6 7 8 9 10 11 12 13 from titus.genpy import PFAEngine pfa = { \"input\" : \"double\" , \"output\" : \"double\" , \"action\" : [ { \"+\" : [ \"input\" , 100 ]} ]} engine , = PFAEngine . fromJson ( pfa ) l = [ 1.0 , 2.0 , 3.0 , 4.0 , 5.0 ] for num in l : print ( num , engine . action ( num )) Error If you are getting any error message please contact the author via e-mail or raise an issue here .","title":"Verify Installation"},{"location":"status/","text":"Unit testing status of titus2 is available here Conformance testing status is available here","title":"Project Status"},{"location":"avro-types/function-signatures/","text":"Special forms and regular functions impose constraints on the types they are willing to accept. For instance, the if special form requires a \"boolean\" predicate. All special forms are unique, but the types accepted by library functions follow prescribed patterns. User-defined functions are even more restrictive: only one explicit combination of types is accepted (along with their subtypes). Library functions have one or more signatures, and these signatures include explicit types, wildcards, and function references. The explicit types found in type signatures are: \"boolean\" \"int\" \"long\" \"float\" \"double\" \"string\" \"bytes\" arrays of explicit types maps of explicit types unions of explicit types For instance, the m.round function has two signatures, one takes a \"float\" and returns an \"int\" , the other takes a \"double\" and returns a \"long\" . As another example, the s.join function function has one signature that takes a {\"type\": \"array\", \"items\": \"string\"} and a \"string\" delimiter and returns a single \"string\" . Wildcards in function signatures \u00b6 Wildcards are parts of a function signature that could take different types. This is not like a union type, which accepts different types at runtime, because a wildcard gets resolved during the type-check when a PFA engine is being built. Once resolved, all values must conform to that resolved type. Wildcards are labeled with letters and the same label may be repeated to indicate that whatever type one wildcard resolves to, all others with the same label must resolve to the same type. For instance, the == function takes two arguments, both with the same wildcard, and returns \"boolean\" . If the first argument is a \"string\" , then the second argument must be a \"string\" . If one argument is an \"int\" and the other is a \"double\" , that is acceptable because the wildcard resolves to the supertype \"double\" . As another example, the a.last function takes an array of some wildcard A and returns the last item in the array, which has type A. Records in function signatures \u00b6 All record types in library function signatures are wildcards with an additional restriction: they must have a specified subset of fields. For instance, the stat.sample.updateEWMA function takes a record that must have a field named \"mean\" of type \"double\" . The function updates an exponentially weighted moving average (EWMA) and returns a new record with a new \"mean\" . The record type does not need to have any particular name and it is allowed to have other fields in addition to \"mean\" . (Those other fields are passed through without modification.) Thus, the library function does not exclusively \"own\" its input data type: other library functions can operate on the same record type, requiring it to have other fields, as long as those requirements do not conflict. As another example, the model.tree.simpleTest and model.tree.simpleWalk functions each perform half of the job of evaluating a decision tree. The model.tree.simpleTest function decides how to step from one tree node to the next, and it requires the tree node to contain \"field\" , \"operator\" , and \"value\" fields. The model.tree.simpleWalk function repeatedly applies the test to different nodes until it gets to a leaf, and it requires the tree node to contain \"pass\" and \"fail\" fields. When the two functions are used together, they require all five fields. Alternate stepping functions and walking functions can be combined different functionality. The form of the tree data structure is determined by the set of functions that are to be used on it. Enumerated fields in function signatures \u00b6 Some library functions require an enumeration set whose symbols are fields of another record (referenced by its wildcard label). This ensures that values passed to the function name a field. An example of this is the \"fields\" field of model.tree.simpleTest , which requires the tree node to only name fields in the data records. Function references in function signatures \u00b6 Some library functions require function references as arguments. Functions are not first-class objects in PFA, in part because the Avro type system cannot express them, but also because this restriction makes PFA algorithms subject to more thorough analysis offline. Accepting a function as an argument to another function is useful for building workflows from generic algorithms, so PFA has the ability to take function references as arguments, even though they cannot be assigned to values. The parameter types and return types of these function references are restricted, and they share in the same set of wildcard labels as the rest of the calling function\u2019s signature. For instance, the a.map function takes the following arguments: an array of any A a function that maps A to any B and returns: an array of B That is, a.map can apply a given function to arrays of any type, but the given function has to operate on that type. Whatever the given function returns, a.map returns an array of that type. The function references may refer to named user-defined functions, inline (anonymous) user-defined functions, or library functions. Named user-defined functions are defined in the \"fcns\" top-level field , and user-defined functions have the same syntax, but they can appear directly in the argument list. Both of the following examples square the elements of an array of numbers and round the results. {\"a.map\": [\"arrayOfNumbers\", {\"fcn\": \"u.squareAndRound\"}]} where \"squareAndRound\" is defined in the \"fcns\" top-level field. 1 2 3 4 5 6 7 8 { \"a.map\" : [ \"arrayOfNumbers\" , { \"params\" : [{ \"x\" : \"double\" }], \"ret\" : \"int\" , \"do\" : { \"cast.int\" : { \"m.round\" : { \"**\" : [ \"x\" , 2 ]}}}} ]} The parameter type of \"x\" has to accept the item type of \"arrayOfNumbers\" because they both resolve the same wildcard A . The function\u2019s return type \"int\" resolves B , so the final result of this operation is an array of \"int\" . Library functions can be used as function references, but only if the library function has exactly one signature and no wildcards. For example, the s.len function, which returns the length of a string, can be applied to an array of strings: {\"a.map\": \"arrayOfStrings\", {\"fcn\": \"s.len\"}} but the a.len function, which returns the length of an array of any type, cannot. (PFA employs a simple type inference algorithm that propagates upward from the leaves of an expression, so the type of A in the function reference would be ambiguous before it can be matched to A in the array.) However, we can always \"wrap\" a multi-signature or wildcarded library function in a user-defined function to resolve all the types: 1 2 3 4 5 { \"a.map\" : [ \"arrayOfArraysOfStrings\" , { \"params\" : [{ \"x\" : { \"type\" : \"array\" , \"items\" : \"string\" }}], \"ret\" : \"int\" , \"do\" : { \"a.len\" : \"x\" }}]} Wrapping library functions is useful for resolving types, but it isn\u2019t needed if you only want to turn a two-argument function into a one-argument function by specifying one of the arguments ( partial application ). PFA has a special form for this. Below, we apply m.special.nChooseK to an array of \"k\" values with \"n\" fixed to 100. 1 2 { \"a.map\" : [ \"arrayOfK\" , { \"fcn\" : \"m.special.nChooseK\" , \"fill\" : { \"n\" : 100 }}]} Source Data Mining Group Website","title":"Function Signatures"},{"location":"avro-types/function-signatures/#wildcards-in-function-signatures","text":"Wildcards are parts of a function signature that could take different types. This is not like a union type, which accepts different types at runtime, because a wildcard gets resolved during the type-check when a PFA engine is being built. Once resolved, all values must conform to that resolved type. Wildcards are labeled with letters and the same label may be repeated to indicate that whatever type one wildcard resolves to, all others with the same label must resolve to the same type. For instance, the == function takes two arguments, both with the same wildcard, and returns \"boolean\" . If the first argument is a \"string\" , then the second argument must be a \"string\" . If one argument is an \"int\" and the other is a \"double\" , that is acceptable because the wildcard resolves to the supertype \"double\" . As another example, the a.last function takes an array of some wildcard A and returns the last item in the array, which has type A.","title":"Wildcards in function signatures"},{"location":"avro-types/function-signatures/#records-in-function-signatures","text":"All record types in library function signatures are wildcards with an additional restriction: they must have a specified subset of fields. For instance, the stat.sample.updateEWMA function takes a record that must have a field named \"mean\" of type \"double\" . The function updates an exponentially weighted moving average (EWMA) and returns a new record with a new \"mean\" . The record type does not need to have any particular name and it is allowed to have other fields in addition to \"mean\" . (Those other fields are passed through without modification.) Thus, the library function does not exclusively \"own\" its input data type: other library functions can operate on the same record type, requiring it to have other fields, as long as those requirements do not conflict. As another example, the model.tree.simpleTest and model.tree.simpleWalk functions each perform half of the job of evaluating a decision tree. The model.tree.simpleTest function decides how to step from one tree node to the next, and it requires the tree node to contain \"field\" , \"operator\" , and \"value\" fields. The model.tree.simpleWalk function repeatedly applies the test to different nodes until it gets to a leaf, and it requires the tree node to contain \"pass\" and \"fail\" fields. When the two functions are used together, they require all five fields. Alternate stepping functions and walking functions can be combined different functionality. The form of the tree data structure is determined by the set of functions that are to be used on it.","title":"Records in function signatures"},{"location":"avro-types/function-signatures/#enumerated-fields-in-function-signatures","text":"Some library functions require an enumeration set whose symbols are fields of another record (referenced by its wildcard label). This ensures that values passed to the function name a field. An example of this is the \"fields\" field of model.tree.simpleTest , which requires the tree node to only name fields in the data records.","title":"Enumerated fields in function signatures"},{"location":"avro-types/function-signatures/#function-references-in-function-signatures","text":"Some library functions require function references as arguments. Functions are not first-class objects in PFA, in part because the Avro type system cannot express them, but also because this restriction makes PFA algorithms subject to more thorough analysis offline. Accepting a function as an argument to another function is useful for building workflows from generic algorithms, so PFA has the ability to take function references as arguments, even though they cannot be assigned to values. The parameter types and return types of these function references are restricted, and they share in the same set of wildcard labels as the rest of the calling function\u2019s signature. For instance, the a.map function takes the following arguments: an array of any A a function that maps A to any B and returns: an array of B That is, a.map can apply a given function to arrays of any type, but the given function has to operate on that type. Whatever the given function returns, a.map returns an array of that type. The function references may refer to named user-defined functions, inline (anonymous) user-defined functions, or library functions. Named user-defined functions are defined in the \"fcns\" top-level field , and user-defined functions have the same syntax, but they can appear directly in the argument list. Both of the following examples square the elements of an array of numbers and round the results. {\"a.map\": [\"arrayOfNumbers\", {\"fcn\": \"u.squareAndRound\"}]} where \"squareAndRound\" is defined in the \"fcns\" top-level field. 1 2 3 4 5 6 7 8 { \"a.map\" : [ \"arrayOfNumbers\" , { \"params\" : [{ \"x\" : \"double\" }], \"ret\" : \"int\" , \"do\" : { \"cast.int\" : { \"m.round\" : { \"**\" : [ \"x\" , 2 ]}}}} ]} The parameter type of \"x\" has to accept the item type of \"arrayOfNumbers\" because they both resolve the same wildcard A . The function\u2019s return type \"int\" resolves B , so the final result of this operation is an array of \"int\" . Library functions can be used as function references, but only if the library function has exactly one signature and no wildcards. For example, the s.len function, which returns the length of a string, can be applied to an array of strings: {\"a.map\": \"arrayOfStrings\", {\"fcn\": \"s.len\"}} but the a.len function, which returns the length of an array of any type, cannot. (PFA employs a simple type inference algorithm that propagates upward from the leaves of an expression, so the type of A in the function reference would be ambiguous before it can be matched to A in the array.) However, we can always \"wrap\" a multi-signature or wildcarded library function in a user-defined function to resolve all the types: 1 2 3 4 5 { \"a.map\" : [ \"arrayOfArraysOfStrings\" , { \"params\" : [{ \"x\" : { \"type\" : \"array\" , \"items\" : \"string\" }}], \"ret\" : \"int\" , \"do\" : { \"a.len\" : \"x\" }}]} Wrapping library functions is useful for resolving types, but it isn\u2019t needed if you only want to turn a two-argument function into a one-argument function by specifying one of the arguments ( partial application ). PFA has a special form for this. Below, we apply m.special.nChooseK to an array of \"k\" values with \"n\" fixed to 100. 1 2 { \"a.map\" : [ \"arrayOfK\" , { \"fcn\" : \"m.special.nChooseK\" , \"fill\" : { \"n\" : 100 }}]} Source Data Mining Group Website","title":"Function references in function signatures"},{"location":"avro-types/inherited-type-system/","text":"Every programming language has an implicit or explicit type system, and most of these type systems are similar to one another. Rather than invent a new type system, PFA uses the same one as the Avro serialization format . Avro describes data types using strings and JSON objects, so PFA simply includes Avro as a language subset. The Avro/PFA type system has boolean, integer, floating-point, and string primitives, a null type, which PFA uses to represent missing data, arrays of homogeneous, sequential items, maps of homogeneous, unordered key-value pairs, named records of heterogeneous named fields, named enumeration sets, byte sequences (raw strings), named, fixed-width byte sequences, and tagged unions. The same type system applies to input data, output data, persistent data structures like model parameters, and function signatures. Source Data Mining Group Website","title":"Inherited Type System"},{"location":"avro-types/subtypes-supertypes/","text":"Although this type system has no classes, some types are subtypes of others. If X is a subtype of Y , a value of type X would be accepted where type Y is expected. In Avro, this is known as [schema resolution]. The four number types form a chain of subtypes in which an \"int\" can be used where a \"double\" is expected, etc. A supertype can always be constructed using unions, since an instance of type X can be used where an [X, Y, Z] is expected. A type describes a set of possible values; its subtype describes a subset of those values and its supertype describes a superset of those values. If a type X accepts values of type Y and Y accepts values of type X , then X and Y are exactly the same type. Some special forms result in the \"narrowest possible supertype\" of their arguments, the smallest superset of possible values that can be described in the type system, to allow for return values from all code branches. For example, the return type of 1 2 3 { \"if\" : \"predicate\" , \"then\" : 3.14 , \"else\" : { \"string\" : \"hello\" }} is [\"double\", \"string\"] since it might return a \"double\" and it might return a \"string\" . On the other hand, 1 2 3 { \"if\" : \"predicate\" , \"then\" : 3.14 , \"else\" : { \"int\" : 3 }} returns a \"double\" since the \"int\" is already a subtype of \"double\" . Expected Accepts null \"null\" or [\"null\"] boolean \"boolean\" or [\"boolean\"] int \"int\" or [\"int\"] long \"long\" or a union of any subset of {\"int\", \"long\"} float \"float\" or a union of any subset of {\"int\", \"long\", \"float\"} double \"double\" or a union of any subset of {\"int\", \"long\", \"float\", \"double\"} string \"string\" or [\"string\"] bytes \"bytes\" or [\"bytes\"] an array of X an array of Y for which X accepts Y (arrays are covariant) a map of X a map of Y for which X accepts Y (maps are covariant) a record type the same record type, by name an enum type the same enum type, by name a fixed type the same fixed type, by name a union of types T either a union of types T' such that for all t' in T' , there exists a t in T for which t accepts t' , or a single type t'' such that there exists a t in T for which t accepts t'' . Source Data Mining Group Website","title":"Subtypes and Supertypes"},{"location":"avro-types/type-specification/","text":"The Avro specification page fully describes this type system, but it is reproduced here with PFA-specific notes. Since Avro is a serialization format, it does not raise the issue of whether its values are mutable (can be changed in-place) or immutable. All values in PFA are immutable. In both Avro and PFA, values cannot contain circular references: all data structures are trees. In both Avro and PFA, all values have a well-defined sort order: PFA inerits Avro sort order and equivalence when performing comparisons in functions such as \"<\" , \"max\" , and \"==\" . Null type \u00b6 The null type is referred to as \"null\" (in quotes, as a string), and it has only one possible value (also null , but without quotes). PFA variables cannot change type, so a variable of null type is not useful: it can only ever be null. The null type is used in tagged unions and as a return value for functions and special forms that have nothing to return (instead of introducing \"void\"). A union of any type, such as string, and null is represented as [\"null\", \"string\"] and indicates that the string value may be missing. Since this type is distinct from \"string\" , the rigor of the type system enforces an action to be defined for the missing-string case. Boolean \u00b6 The boolean type is referred to as \"boolean\" and it has only two possible values, true and false (without quotes). Boolean is not a subclass of integers, so turning a boolean variable x into zero or one requires an expression like {\"if\": \"x\", \"then\": 1, \"else\": 0} Integer types \u00b6 There are two integer types, \"int\" for 32-bit, signed integers and \"long\" for 64-bit, signed integers. The \"int\" form is default for most functions, and literal integers in JSON and PFA expressions are interpreted as \"int\" . Floating point types \u00b6 There are two floating-point types, \"float\" for 32-bit, IEEE floating-point numbers and \"double\" for 64-bit. The \"double\" form is default for most functions, and literal floating-point numbers in JSON and PFA expressions are interpreted as \"double\" . The \"int\" , \"long\" , \"float\" , and \"double\" types form a chain of subtypes: This type Can be used where this is expected \"int\" \"int\", \"long\", \"float\", \"double\" \"long\" \"long\", \"float\", \"double\" \"float\" \"float\", \"double\" \"double\" \"double\" String type \u00b6 The string type is referred to as \"string\" and it can accept any valid Unicode sequence. Strings are not arrays and they cannot be changed in-place (all PFA values are immutable). There is no character type: characters are represented by strings of length 1. In JSON, a value of type \"string\" is represented as a simple JSON string: \"hello\" but in a PFA expression , it has to be qualified to avoid confusion with variable names: {\"string\": \"hello\"} The appropriate form to use depends on context within the PFA document. A cell or pool\u2019s \"init\" section takes a value as JSON, while the \"action\" top-level field takes expressions. This allows large sets of model parameters to be expressed more concisely in a cell or pool while expressions that apply the model can be more expressive. Bytes type \u00b6 The bytes type is referred to as \"bytes\" and it can accept any byte sequence. It is therefore a generalization of a string (though neither is a subtype of the other). Values of type \"bytes\" are not arrays and cannot be changed in-place (all PFA values are immutable). In JSON, a value of type \"bytes\" is a raw string: \"hello\" but in a PFA expression , it has to be qualified, either using base-64 or as a wrapped string: {\"type\": \"bytes\", \"value\": \"hello\"} or {\"base64\": \"aGVsbG8=\"} Arrays \u00b6 Arrays are homogeneous, ordered collections of items. For any type X, an array of X can be constructed by {\"type\": \"array\", \"items\": X} For instance, an array of strings is {\"type\": \"array\", \"items\": \"string\"} For an array to contain items of mixed type, they must be explicitly declared as a union. For instance, an array of nullable, floating-point numbers is {\"type\": \"array\", \"items\": [\"null\", \"double\"]} When extracted from the array, these items would have to be further unpacked to handle both \"null\" and \"double\" cases. The \"items\" may contain any type, no matter how complex. Two-dimensional arrays are formed by constructing an array of arrays: 1 2 3 { \"type\" : \"array\" , \"items\" : { \"type\" : \"array\" , \"items\" : \"double\" } } Since arrays, like all PFA values, are immutable, they have fixed length. To grow an array, you must replace short versions with longer versions using something like the a.append function. Functional programming with a.map , a.filter , a.reduce , etc., is a better match to array's immutability. In JSON, an array object is represented by square brakets: [\"one\", \"two\", \"three\"] The type of a JSON array is ambiguous without reference to the schema. (The above could be an array of strings, an array of bytes, or an array of enumeration symbols.) In a PFA expression , a type must be given: 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [ \"one\" , \"two\" , \"three\" ]} Maps \u00b6 Maps are homogeneous, unordered key-value pairs in which the keys are strings. They may be thought of as arrays in which the index (key) is a string, rather than an integer (position). For any type X , a map from string to X can be constructed by {\"type\": \"map\", \"values\": X} For instance, a map from strings to floating-point numbers is {\"type\": \"map\", \"values\": \"double\"} Maps follow the same composition rules as arrays, and they are similarly immutable. Maps may be grown using map.add or transformed with map.map , map.filter , etc., in direct analogy with arrays. In JSON, a map object is represented by curly brackets: {\"one\": 1, \"two\": 2, \"three\": 3} Like arrays, the type of a JSON map is ambiguous without reference to the schema. (The above could be a map of integers or a map of floating-point numbers.) In a PFA expression , a type must be given: 1 2 { \"type\" : { \"type\" : \"map\" , \"values\" : \"int\" }, \"value\" : { \"one\" : 1 , \"two\" : 2 , \"three\" : 3 } ] } Records \u00b6 Records are named, heterogeneous collections of a fixed set of named fields. Below is an example of a record with three fields: one (an int), two (a double), and three (a string). 1 2 3 4 5 6 7 { \"type\" : \"record\" , \"name\" : \"MyRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" } ]} Records are similar to maps, but with three exceptions: Maps can have any string-valued keys; records have specific fields that must always be present, and those field names are restricted to the following regular expression: [A-Za-z_][A-Za-z0-9_]* . Map values must all have the same type; record field values can each be different. Maps are unnamed; records have names to distinguish records with different sets of keys and to allow records to be recursively nested (see example below). Like a map, a record in JSON is represented by curly brakets: {\"one\": 1, \"two\": 2.2, \"three\": \"THREE\"} Again, the JSON is ambiguous without reference to the schema, since the above could be a record or a {\"type\": \"map\", \"values\": [\"double\", \"string\"]} . As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific record type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of a record is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. Here is an example of a recursively defined record type: a binary tree with strings as leaves. 1 2 3 4 5 6 7 { \"type\" : \"record\" , \"name\" : \"Node\" , \"namespace\" : \"tree\" , \"fields\" : [ { \"name\" : \"left\" , \"type\" : [ \"tree.Node\" , \"string\" ]}, { \"name\" : \"right\" , \"type\" : [ \"tree.Node\" , \"string\" ]} ]} The types of this record's fields refer to the record by reference: \"tree.Node\" is its fully-qualified name. The fields are unions of \"tree.Node\" with \"string\" so that the tree can terminate on values of a different type (and not be infinite). Here\u2019s what an example of such a tree would look like in JSON: 1 2 3 4 5 6 { \"left\" : { \"tree.Node\" : { \"left\" : { \"string\" : \"L-L\" }, \"right\" : { \"string\" : \"L-R\" }}}, \"right\" : { \"tree.Node\" : { \"left\" : { \"string\" : \"R-L\" }, \"right\" : { \"string\" : \"R-R\" }}}} The {\"tree.Node\": ...} and {\"string\": ...} qualifiers are for tagging the union values in JSON. Another way to form a recursive record is to give it array or map subfields, since these containers may be empty, making it possible to terminate the tree. 1 2 3 4 5 { \"type\" : \"record\" , \"name\" : \"Tree\" , \"fields\" : [ { \"name\" : \"children\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"Tree\" }} ]} Here is an example of such a tree in JSON: {\"children\": [{\"children\": []}, {\"children\": []}]} As with all PFA values, records are immutable. To change one field in a record, use the attr-to special form. To change multiple fields, create a new record with the new special form. Records have additional features that are primarily relevant for serialization and deserialization. See the Avro specification for details. Only the sort order property affects processing in PFA (for functions such as \"<\" , \"max\" , and \"==\" ). Enumeration sets \u00b6 Enumeration sets or \u201cenums\u201d are small, finite sets of strings. The strings must be Avro names ( [A-Za-z_][A-Za-z0-9_]* ). Below is an example of an enum with five symbol values. 1 2 3 { \"type\" : \"enum\" , \"name\" : \"SmallNumbers\" , \"symbols\" : [ \"one\" , \"two\" , \"three\" , \"four\" , \"five\" ]} As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific enum type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of an enum is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. To refer to an enumeration value in JSON, simply reference its symbol name: \"three\" This is, of course, ambiguous, since it could also be a string (or a bytes). PFA usually uses enumeration sets to specify categorical variables with a fixed set of categories. If sorted or compared using PFA\u2019s inequalities, the order is given by the order of the symbols in the type declaration. For example, the five symbols above would be sorted as \"one\", \"two\", \"three\", \"four\", \"five\" not as \"five\", \"four\", \"one\", \"three\", \"two\" Fixed-width byte sequences \u00b6 Avro also provides for named raw byte sequences with fixed length. A 6-byte MAC address type would be defined as 1 2 3 { \"type\" : \"fixed\" , \"name\" : \"MACAddress\" , \"size\" : 6 } As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific enum type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of an enum is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. Fixed-type values are not arrays and cannot be changed in-place (all PFA values are immutable). They are primarily intended for tighter packing in Avro serialization and are not particularly useful in PFA. Tagged unions \u00b6 To allow for variables that can take one of several types, Avro and PFA have tagged unions. They are \"tagged\" in the sense that a value\u2019s specific type is always available. A union of X , Y , and Z is represented as a list of these three types: [X, Y, Z] For instance, a variable that could be \"null\" , \"string\" , or a map of \"int\" would be expressed as [\"null\", \"string\", {\"type\": \"map\", \"values\": \"int\"}] At least two types must be provided, types may not be repeated, and directly nested unions are not allowed. With the exception of \"null\" , union values in JSON are singleton JSON objects whose key is the type name and whose value is the value. Type Name Example value in JSON null none null (without quotes) boolean \"boolean\" {\"boolean\": true} int \"int\" {\"int\": 3} long \"long\" {\"long\": 3} float \"float\" {\"float\": 3.14} double \"double\" {\"double\": 3.14} string \"string\" {\"string\": \"hello\"} bytes \"bytes\" {\"bytes\": \"hello\"} array \"array\" {\"array\": [1, 2, 3]} map \"map\" {\"map\": {\"one\": 1, \"two\": 2, \"three\": 3}} record fully-qualified name {\"MyRecord\": {\"one\": 1, \"two\": 2, \"three\": 3}} enum fully-qualified name {\"SmallNumbers\": \"three\"} fixed fully-qualified name {\"MACAddress\": \"^)=;T{\"} union not allowed (Note that a union containing two types of arrays, such as an array of \"int\" and an array of \"string\" , cannot be disambiguated. An array of [\"int\", \"string\"] , however, is unambiguous and less restrictive.) PFA primarily uses unions to express the possibility of missing data. For instance, values of type \"double\" are never missing, but values of type [\"double\", \"null\"] are either floating-point numbers or null (missing). The non-nullable and nullable types are not interchangeable. For example, you cannot add nullable numbers: 1 2 3 4 5 [{ \"let\" : { \"xornull\" : { \"type\" : [ \"double\" , \"null\" ], \"value\" : null }, \"yornull\" : { \"type\" : [ \"double\" , \"null\" ], \"value\" : { \"double\" : 3.14 }}}}, { \"+\" : [ \"xornull\" , \"yornull\" ]}] The above is invalid because the \"+\" function can only add numbers, not nullable numbers. Even if xornull and yornull are usually numbers, a PFA consumer will not accept their sum because one of them might, at runtime, be null . To add them, you must provide for the null case, which is known as a type-safe null. For example, the sum could be replaced with the ifnotnull special form: 1 2 3 { \"ifnotnull\" : { \"x\" : \"xornull\" , \"y\" : \"yornull\" }, \"then\" : { \"+\" : [ \"x\" , \"y\" ]}, \"else\" : 0 } Some functions, such as the ones in the impute library, three-state logic, and missing value variants of the tree model, take nullable types directly. Of course, null is not the only type that can be included in a union, so PFA has the cast-cases special form for unpacking general unions. Source Data Mining Group Website","title":"Specification of All Types"},{"location":"avro-types/type-specification/#null-type","text":"The null type is referred to as \"null\" (in quotes, as a string), and it has only one possible value (also null , but without quotes). PFA variables cannot change type, so a variable of null type is not useful: it can only ever be null. The null type is used in tagged unions and as a return value for functions and special forms that have nothing to return (instead of introducing \"void\"). A union of any type, such as string, and null is represented as [\"null\", \"string\"] and indicates that the string value may be missing. Since this type is distinct from \"string\" , the rigor of the type system enforces an action to be defined for the missing-string case.","title":"Null type"},{"location":"avro-types/type-specification/#boolean","text":"The boolean type is referred to as \"boolean\" and it has only two possible values, true and false (without quotes). Boolean is not a subclass of integers, so turning a boolean variable x into zero or one requires an expression like {\"if\": \"x\", \"then\": 1, \"else\": 0}","title":"Boolean"},{"location":"avro-types/type-specification/#integer-types","text":"There are two integer types, \"int\" for 32-bit, signed integers and \"long\" for 64-bit, signed integers. The \"int\" form is default for most functions, and literal integers in JSON and PFA expressions are interpreted as \"int\" .","title":"Integer types"},{"location":"avro-types/type-specification/#floating-point-types","text":"There are two floating-point types, \"float\" for 32-bit, IEEE floating-point numbers and \"double\" for 64-bit. The \"double\" form is default for most functions, and literal floating-point numbers in JSON and PFA expressions are interpreted as \"double\" . The \"int\" , \"long\" , \"float\" , and \"double\" types form a chain of subtypes: This type Can be used where this is expected \"int\" \"int\", \"long\", \"float\", \"double\" \"long\" \"long\", \"float\", \"double\" \"float\" \"float\", \"double\" \"double\" \"double\"","title":"Floating point types"},{"location":"avro-types/type-specification/#string-type","text":"The string type is referred to as \"string\" and it can accept any valid Unicode sequence. Strings are not arrays and they cannot be changed in-place (all PFA values are immutable). There is no character type: characters are represented by strings of length 1. In JSON, a value of type \"string\" is represented as a simple JSON string: \"hello\" but in a PFA expression , it has to be qualified to avoid confusion with variable names: {\"string\": \"hello\"} The appropriate form to use depends on context within the PFA document. A cell or pool\u2019s \"init\" section takes a value as JSON, while the \"action\" top-level field takes expressions. This allows large sets of model parameters to be expressed more concisely in a cell or pool while expressions that apply the model can be more expressive.","title":"String type"},{"location":"avro-types/type-specification/#bytes-type","text":"The bytes type is referred to as \"bytes\" and it can accept any byte sequence. It is therefore a generalization of a string (though neither is a subtype of the other). Values of type \"bytes\" are not arrays and cannot be changed in-place (all PFA values are immutable). In JSON, a value of type \"bytes\" is a raw string: \"hello\" but in a PFA expression , it has to be qualified, either using base-64 or as a wrapped string: {\"type\": \"bytes\", \"value\": \"hello\"} or {\"base64\": \"aGVsbG8=\"}","title":"Bytes type"},{"location":"avro-types/type-specification/#arrays","text":"Arrays are homogeneous, ordered collections of items. For any type X, an array of X can be constructed by {\"type\": \"array\", \"items\": X} For instance, an array of strings is {\"type\": \"array\", \"items\": \"string\"} For an array to contain items of mixed type, they must be explicitly declared as a union. For instance, an array of nullable, floating-point numbers is {\"type\": \"array\", \"items\": [\"null\", \"double\"]} When extracted from the array, these items would have to be further unpacked to handle both \"null\" and \"double\" cases. The \"items\" may contain any type, no matter how complex. Two-dimensional arrays are formed by constructing an array of arrays: 1 2 3 { \"type\" : \"array\" , \"items\" : { \"type\" : \"array\" , \"items\" : \"double\" } } Since arrays, like all PFA values, are immutable, they have fixed length. To grow an array, you must replace short versions with longer versions using something like the a.append function. Functional programming with a.map , a.filter , a.reduce , etc., is a better match to array's immutability. In JSON, an array object is represented by square brakets: [\"one\", \"two\", \"three\"] The type of a JSON array is ambiguous without reference to the schema. (The above could be an array of strings, an array of bytes, or an array of enumeration symbols.) In a PFA expression , a type must be given: 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [ \"one\" , \"two\" , \"three\" ]}","title":"Arrays"},{"location":"avro-types/type-specification/#maps","text":"Maps are homogeneous, unordered key-value pairs in which the keys are strings. They may be thought of as arrays in which the index (key) is a string, rather than an integer (position). For any type X , a map from string to X can be constructed by {\"type\": \"map\", \"values\": X} For instance, a map from strings to floating-point numbers is {\"type\": \"map\", \"values\": \"double\"} Maps follow the same composition rules as arrays, and they are similarly immutable. Maps may be grown using map.add or transformed with map.map , map.filter , etc., in direct analogy with arrays. In JSON, a map object is represented by curly brackets: {\"one\": 1, \"two\": 2, \"three\": 3} Like arrays, the type of a JSON map is ambiguous without reference to the schema. (The above could be a map of integers or a map of floating-point numbers.) In a PFA expression , a type must be given: 1 2 { \"type\" : { \"type\" : \"map\" , \"values\" : \"int\" }, \"value\" : { \"one\" : 1 , \"two\" : 2 , \"three\" : 3 } ] }","title":"Maps"},{"location":"avro-types/type-specification/#records","text":"Records are named, heterogeneous collections of a fixed set of named fields. Below is an example of a record with three fields: one (an int), two (a double), and three (a string). 1 2 3 4 5 6 7 { \"type\" : \"record\" , \"name\" : \"MyRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" } ]} Records are similar to maps, but with three exceptions: Maps can have any string-valued keys; records have specific fields that must always be present, and those field names are restricted to the following regular expression: [A-Za-z_][A-Za-z0-9_]* . Map values must all have the same type; record field values can each be different. Maps are unnamed; records have names to distinguish records with different sets of keys and to allow records to be recursively nested (see example below). Like a map, a record in JSON is represented by curly brakets: {\"one\": 1, \"two\": 2.2, \"three\": \"THREE\"} Again, the JSON is ambiguous without reference to the schema, since the above could be a record or a {\"type\": \"map\", \"values\": [\"double\", \"string\"]} . As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific record type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of a record is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. Here is an example of a recursively defined record type: a binary tree with strings as leaves. 1 2 3 4 5 6 7 { \"type\" : \"record\" , \"name\" : \"Node\" , \"namespace\" : \"tree\" , \"fields\" : [ { \"name\" : \"left\" , \"type\" : [ \"tree.Node\" , \"string\" ]}, { \"name\" : \"right\" , \"type\" : [ \"tree.Node\" , \"string\" ]} ]} The types of this record's fields refer to the record by reference: \"tree.Node\" is its fully-qualified name. The fields are unions of \"tree.Node\" with \"string\" so that the tree can terminate on values of a different type (and not be infinite). Here\u2019s what an example of such a tree would look like in JSON: 1 2 3 4 5 6 { \"left\" : { \"tree.Node\" : { \"left\" : { \"string\" : \"L-L\" }, \"right\" : { \"string\" : \"L-R\" }}}, \"right\" : { \"tree.Node\" : { \"left\" : { \"string\" : \"R-L\" }, \"right\" : { \"string\" : \"R-R\" }}}} The {\"tree.Node\": ...} and {\"string\": ...} qualifiers are for tagging the union values in JSON. Another way to form a recursive record is to give it array or map subfields, since these containers may be empty, making it possible to terminate the tree. 1 2 3 4 5 { \"type\" : \"record\" , \"name\" : \"Tree\" , \"fields\" : [ { \"name\" : \"children\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"Tree\" }} ]} Here is an example of such a tree in JSON: {\"children\": [{\"children\": []}, {\"children\": []}]} As with all PFA values, records are immutable. To change one field in a record, use the attr-to special form. To change multiple fields, create a new record with the new special form. Records have additional features that are primarily relevant for serialization and deserialization. See the Avro specification for details. Only the sort order property affects processing in PFA (for functions such as \"<\" , \"max\" , and \"==\" ).","title":"Records"},{"location":"avro-types/type-specification/#enumeration-sets","text":"Enumeration sets or \u201cenums\u201d are small, finite sets of strings. The strings must be Avro names ( [A-Za-z_][A-Za-z0-9_]* ). Below is an example of an enum with five symbol values. 1 2 3 { \"type\" : \"enum\" , \"name\" : \"SmallNumbers\" , \"symbols\" : [ \"one\" , \"two\" , \"three\" , \"four\" , \"five\" ]} As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific enum type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of an enum is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. To refer to an enumeration value in JSON, simply reference its symbol name: \"three\" This is, of course, ambiguous, since it could also be a string (or a bytes). PFA usually uses enumeration sets to specify categorical variables with a fixed set of categories. If sorted or compared using PFA\u2019s inequalities, the order is given by the order of the symbols in the type declaration. For example, the five symbols above would be sorted as \"one\", \"two\", \"three\", \"four\", \"five\" not as \"five\", \"four\", \"one\", \"three\", \"two\"","title":"Enumeration sets"},{"location":"avro-types/type-specification/#fixed-width-byte-sequences","text":"Avro also provides for named raw byte sequences with fixed length. A 6-byte MAC address type would be defined as 1 2 3 { \"type\" : \"fixed\" , \"name\" : \"MACAddress\" , \"size\" : 6 } As with all three named types (record, enum, and fixed), a \"name\" field must be present and a \"namespace\" is optional. Also, a specific enum type can only be defined once per PFA document; all other references must be by name (though the full declaration does not need to be first). The name of an enum is fully-qualified: if it has a namespace, that namespace must precede the name with a dot. Fixed-type values are not arrays and cannot be changed in-place (all PFA values are immutable). They are primarily intended for tighter packing in Avro serialization and are not particularly useful in PFA.","title":"Fixed-width byte sequences"},{"location":"avro-types/type-specification/#tagged-unions","text":"To allow for variables that can take one of several types, Avro and PFA have tagged unions. They are \"tagged\" in the sense that a value\u2019s specific type is always available. A union of X , Y , and Z is represented as a list of these three types: [X, Y, Z] For instance, a variable that could be \"null\" , \"string\" , or a map of \"int\" would be expressed as [\"null\", \"string\", {\"type\": \"map\", \"values\": \"int\"}] At least two types must be provided, types may not be repeated, and directly nested unions are not allowed. With the exception of \"null\" , union values in JSON are singleton JSON objects whose key is the type name and whose value is the value. Type Name Example value in JSON null none null (without quotes) boolean \"boolean\" {\"boolean\": true} int \"int\" {\"int\": 3} long \"long\" {\"long\": 3} float \"float\" {\"float\": 3.14} double \"double\" {\"double\": 3.14} string \"string\" {\"string\": \"hello\"} bytes \"bytes\" {\"bytes\": \"hello\"} array \"array\" {\"array\": [1, 2, 3]} map \"map\" {\"map\": {\"one\": 1, \"two\": 2, \"three\": 3}} record fully-qualified name {\"MyRecord\": {\"one\": 1, \"two\": 2, \"three\": 3}} enum fully-qualified name {\"SmallNumbers\": \"three\"} fixed fully-qualified name {\"MACAddress\": \"^)=;T{\"} union not allowed (Note that a union containing two types of arrays, such as an array of \"int\" and an array of \"string\" , cannot be disambiguated. An array of [\"int\", \"string\"] , however, is unambiguous and less restrictive.) PFA primarily uses unions to express the possibility of missing data. For instance, values of type \"double\" are never missing, but values of type [\"double\", \"null\"] are either floating-point numbers or null (missing). The non-nullable and nullable types are not interchangeable. For example, you cannot add nullable numbers: 1 2 3 4 5 [{ \"let\" : { \"xornull\" : { \"type\" : [ \"double\" , \"null\" ], \"value\" : null }, \"yornull\" : { \"type\" : [ \"double\" , \"null\" ], \"value\" : { \"double\" : 3.14 }}}}, { \"+\" : [ \"xornull\" , \"yornull\" ]}] The above is invalid because the \"+\" function can only add numbers, not nullable numbers. Even if xornull and yornull are usually numbers, a PFA consumer will not accept their sum because one of them might, at runtime, be null . To add them, you must provide for the null case, which is known as a type-safe null. For example, the sum could be replaced with the ifnotnull special form: 1 2 3 { \"ifnotnull\" : { \"x\" : \"xornull\" , \"y\" : \"yornull\" }, \"then\" : { \"+\" : [ \"x\" , \"y\" ]}, \"else\" : 0 } Some functions, such as the ones in the impute library, three-state logic, and missing value variants of the tree model, take nullable types directly. Of course, null is not the only type that can be included in a union, so PFA has the cast-cases special form for unpacking general unions. Source Data Mining Group Website","title":"Tagged unions"},{"location":"function-library/","text":"Function Category Count Link Core Library 29 Math Library 45 Linear Algebra Library 13 Metric Library 12 Random Number Library 12 String Manipulation Library 25 Regular Expressions and Text Pre-processing 15 Parsing Library 4 Casting Library 13 Array Manipulation Library 82 Map Manipulation Library 41 Bytes Manipulation Library 23 Manipulation of Other Data Structures 5 Date/Time Handling 18 Impute/Missing Data Handling Library 7 Interpolation Library 5 Probability Library 48 Descriptive Statistics Library 22 Data Mining Library 23","title":"Overview"},{"location":"function-library/array/","text":"Basic Access (7) \u00b6 Short Description Function Length a.len Extract subsequence a.subseq Extract the first item a.head Extract all but the first item a.tail Extract the last item a.last Extract all but the last item a.init Modify subsequence a.subseqto Search and Replace (6) \u00b6 Short Description Function Contains a.contains Count instances a.count Find first index a.index Find last index a.rindex Check start a.startswith Check end a.endswith Manipulation (7) \u00b6 Short Description Function Concatenate two arrays a.concat Append a.append Append to a circular buffer with a maximum size a.cycle Insert or prepend a.insert Replace item a.replace Remove item a.remove Rotate an array left a.rotate Reordering (4) \u00b6 Short Description Function Sort a.sort Sort with a less-than function a.sortLT Randomly shuffle array a.shuffle Reverse order a.reverse Extreme Values (16) \u00b6 Short Description Function Maximum of all values a.max Minimum of all values a.min Maximum with a less-than function a.maxLT Minimum with a less-than function a.minLT Maximum N items a.maxN Minimum N items a.minN Maximum N with a less-than function a.maxNLT Minimum N with a less-than function a.minNLT Argument maximum a.argmax Argument minimum a.argmin Argument maximum with a less-than function a.argmaxLT Argument minimum with a less-than function a.argminLT Maximum N arguments a.argmaxN Minimum N arguments a.argminN Maximum N arguments with a less-than function a.argmaxNLT Minimum N arguments with a less-than function a.argminNLT Numerical Combinations (9) \u00b6 Short Description Function Add all array values a.sum Multiply all array values a.product Sum of logarithms a.lnsum Log of the sum of exponentials without roundoff error a.logsumexp Arithmetic mean a.mean Geometric mean a.geomean Median a.median Percentile in unit interval a.ntile Mode, or most common value a.mode Set or Set-like Functions (8) \u00b6 Short Description Function Distinct items a.distinct Set equality a.seteq Union a.union Intersection a.intersection Set difference a.diff Symmetric set difference a.symdiff Subset check a.subset Disjointness check a.disjoint Functional Programming (16) \u00b6 Short Description Function Transform array items with function a.map Transform array items, providing access to the index a.mapWithIndex Filter array items with a function a.filter Filter array items, providing access to the index a.filterWithIndex Filter and map a.filterMap Filter and map, providing access to the index a.filterMapWithIndex Map and flatten a.flatMap Map and flatten, providing access to the index a.flatMapWithIndex Zip and map a.zipmap Zip and map, providing access to the index a.zipmapWithIndex Reduce array items to a single value a.reduce Right-to-left reduce a.reduceRight Fold array items to another type a.fold Right-to-left fold a.foldRight Take items until predicate is false a.takeWhile Drop items until predicate is true a.dropWhile Functional Tests (4) \u00b6 Short Description Function Existential check, \u2203 a.any Univeral check, \u2200 a.all Pairwise check of two arrays a.corresponds Pairwise check, providing access to the index a.correspondsWithIndex Restructuring (5) \u00b6 Short Description Function Sliding window a.slidingWindow Unique combinations of a fixed size a.combinations Permutations a.permutations Flatten array a.flatten Group items by category a.groupby","title":"Array Manipulation Library (82)"},{"location":"function-library/array/#basic-access-7","text":"Short Description Function Length a.len Extract subsequence a.subseq Extract the first item a.head Extract all but the first item a.tail Extract the last item a.last Extract all but the last item a.init Modify subsequence a.subseqto","title":"Basic Access (7)"},{"location":"function-library/array/#search-and-replace-6","text":"Short Description Function Contains a.contains Count instances a.count Find first index a.index Find last index a.rindex Check start a.startswith Check end a.endswith","title":"Search and Replace (6)"},{"location":"function-library/array/#manipulation-7","text":"Short Description Function Concatenate two arrays a.concat Append a.append Append to a circular buffer with a maximum size a.cycle Insert or prepend a.insert Replace item a.replace Remove item a.remove Rotate an array left a.rotate","title":"Manipulation (7)"},{"location":"function-library/array/#reordering-4","text":"Short Description Function Sort a.sort Sort with a less-than function a.sortLT Randomly shuffle array a.shuffle Reverse order a.reverse","title":"Reordering (4)"},{"location":"function-library/array/#extreme-values-16","text":"Short Description Function Maximum of all values a.max Minimum of all values a.min Maximum with a less-than function a.maxLT Minimum with a less-than function a.minLT Maximum N items a.maxN Minimum N items a.minN Maximum N with a less-than function a.maxNLT Minimum N with a less-than function a.minNLT Argument maximum a.argmax Argument minimum a.argmin Argument maximum with a less-than function a.argmaxLT Argument minimum with a less-than function a.argminLT Maximum N arguments a.argmaxN Minimum N arguments a.argminN Maximum N arguments with a less-than function a.argmaxNLT Minimum N arguments with a less-than function a.argminNLT","title":"Extreme Values (16)"},{"location":"function-library/array/#numerical-combinations-9","text":"Short Description Function Add all array values a.sum Multiply all array values a.product Sum of logarithms a.lnsum Log of the sum of exponentials without roundoff error a.logsumexp Arithmetic mean a.mean Geometric mean a.geomean Median a.median Percentile in unit interval a.ntile Mode, or most common value a.mode","title":"Numerical Combinations (9)"},{"location":"function-library/array/#set-or-set-like-functions-8","text":"Short Description Function Distinct items a.distinct Set equality a.seteq Union a.union Intersection a.intersection Set difference a.diff Symmetric set difference a.symdiff Subset check a.subset Disjointness check a.disjoint","title":"Set or Set-like Functions (8)"},{"location":"function-library/array/#functional-programming-16","text":"Short Description Function Transform array items with function a.map Transform array items, providing access to the index a.mapWithIndex Filter array items with a function a.filter Filter array items, providing access to the index a.filterWithIndex Filter and map a.filterMap Filter and map, providing access to the index a.filterMapWithIndex Map and flatten a.flatMap Map and flatten, providing access to the index a.flatMapWithIndex Zip and map a.zipmap Zip and map, providing access to the index a.zipmapWithIndex Reduce array items to a single value a.reduce Right-to-left reduce a.reduceRight Fold array items to another type a.fold Right-to-left fold a.foldRight Take items until predicate is false a.takeWhile Drop items until predicate is true a.dropWhile","title":"Functional Programming (16)"},{"location":"function-library/array/#functional-tests-4","text":"Short Description Function Existential check, \u2203 a.any Univeral check, \u2200 a.all Pairwise check of two arrays a.corresponds Pairwise check, providing access to the index a.correspondsWithIndex","title":"Functional Tests (4)"},{"location":"function-library/array/#restructuring-5","text":"Short Description Function Sliding window a.slidingWindow Unique combinations of a fixed size a.combinations Permutations a.permutations Flatten array a.flatten Group items by category a.groupby","title":"Restructuring (5)"},{"location":"function-library/bytes/","text":"Basic Access (3) \u00b6 Short Description Function Length bytes.len Extract subsequence bytes.subseq Modify subsequence bytes.subseqto Test Validity (6) \u00b6 Short Description Function Verify ASCII format bytes.isAscii Verify LATIN-1 format bytes.isLatin1 Verify UTF-8 format bytes.isUtf8 Verify UTF-16 format bytes.isUtf16 Verify UTF-16 big endian format bytes.isUtf16be Verify UTF-16 little endian format bytes.isUtf16le Decode Bytes to Strings (6) \u00b6 Short Description Function Decode from ASCII format bytes.decodeAscii Decode from LATIN-1 format bytes.decodeLatin1 Decode from UTF-8 format bytes.decodeUtf8 Decode from UTF-16 format bytes.decodeUtf16 Decode from UTF-16 big endian format bytes.decodeUtf16be Decode from UTF-16 little endian format bytes.decodeUtf16le Encode Strings to Bytes (6) \u00b6 Short Description Function Encode to ASCII format bytes.encodeAscii Encode to LATIN-1 format bytes.encodeLatin1 Encode to UTF-8 format bytes.encodeUtf8 Encode to UTF-16 format bytes.encodeUtf16 Encode to UTF-16 big endian format bytes.encodeUtf16be Encode to UTF-16 little endian format bytes.encodeUtf16le Base64 Encoding (2) \u00b6 Short Description Function Encode bytes as a base64 string bytes.toBase64 Decode base64 string to bytes bytes.fromBase64","title":"Bytes Manipulation Library (23)"},{"location":"function-library/bytes/#basic-access-3","text":"Short Description Function Length bytes.len Extract subsequence bytes.subseq Modify subsequence bytes.subseqto","title":"Basic Access (3)"},{"location":"function-library/bytes/#test-validity-6","text":"Short Description Function Verify ASCII format bytes.isAscii Verify LATIN-1 format bytes.isLatin1 Verify UTF-8 format bytes.isUtf8 Verify UTF-16 format bytes.isUtf16 Verify UTF-16 big endian format bytes.isUtf16be Verify UTF-16 little endian format bytes.isUtf16le","title":"Test Validity (6)"},{"location":"function-library/bytes/#decode-bytes-to-strings-6","text":"Short Description Function Decode from ASCII format bytes.decodeAscii Decode from LATIN-1 format bytes.decodeLatin1 Decode from UTF-8 format bytes.decodeUtf8 Decode from UTF-16 format bytes.decodeUtf16 Decode from UTF-16 big endian format bytes.decodeUtf16be Decode from UTF-16 little endian format bytes.decodeUtf16le","title":"Decode Bytes to Strings  (6)"},{"location":"function-library/bytes/#encode-strings-to-bytes-6","text":"Short Description Function Encode to ASCII format bytes.encodeAscii Encode to LATIN-1 format bytes.encodeLatin1 Encode to UTF-8 format bytes.encodeUtf8 Encode to UTF-16 format bytes.encodeUtf16 Encode to UTF-16 big endian format bytes.encodeUtf16be Encode to UTF-16 little endian format bytes.encodeUtf16le","title":"Encode Strings to Bytes (6)"},{"location":"function-library/bytes/#base64-encoding-2","text":"Short Description Function Encode bytes as a base64 string bytes.toBase64 Decode base64 string to bytes bytes.fromBase64","title":"Base64 Encoding (2)"},{"location":"function-library/casting/","text":"Casting Numbers as Numbers of a Different Type (6) \u00b6 Short Description Function Signed integers with wrap-around cast.signed Unsigned integers with wrap-around cast.unsigned 32-bit integers cast.int 64-bit integers cast.long Single-precision floating point cast.float Double-precision floating point cast.double Fanning Out Variables to Arrays of Various Types (5) \u00b6 Short Description Function Fan a variable out to an array of booleans cast.fanoutBoolean Fan a variable out to an array of ints cast.fanoutInt Fan a variable out to an array of longs cast.fanoutLong Fan a variable out to an array of floats cast.fanoutFloat Fan a variable out to an array of doubles cast.fanoutDouble Serializing Arbitrary Objects (2) \u00b6 Short Description Function Serialize an arbitrary object as Avro bytes cast.avro Serialize an arbitrary object as a JSON string cast.json","title":"Casting Library (13)"},{"location":"function-library/casting/#casting-numbers-as-numbers-of-a-different-type-6","text":"Short Description Function Signed integers with wrap-around cast.signed Unsigned integers with wrap-around cast.unsigned 32-bit integers cast.int 64-bit integers cast.long Single-precision floating point cast.float Double-precision floating point cast.double","title":"Casting Numbers as Numbers of a Different Type (6)"},{"location":"function-library/casting/#fanning-out-variables-to-arrays-of-various-types-5","text":"Short Description Function Fan a variable out to an array of booleans cast.fanoutBoolean Fan a variable out to an array of ints cast.fanoutInt Fan a variable out to an array of longs cast.fanoutLong Fan a variable out to an array of floats cast.fanoutFloat Fan a variable out to an array of doubles cast.fanoutDouble","title":"Fanning Out Variables to Arrays of Various Types (5)"},{"location":"function-library/casting/#serializing-arbitrary-objects-2","text":"Short Description Function Serialize an arbitrary object as Avro bytes cast.avro Serialize an arbitrary object as a JSON string cast.json","title":"Serializing Arbitrary Objects (2)"},{"location":"function-library/core/","text":"Basic Arithmetic (9) \u00b6 Short Description Function Addition of two values + Subtraction \u2212 Multiplication of two values * Floating-point division / Integer division // Negation u\u2212 Modulo % Remainder %% Raising to a power ** Comparison Operators (9) \u00b6 Short Description Function General comparison cmp Equality == Inequality != Less than < Less than or equal to <= Greater than > Greater than or equal to >= Maximum of two values max Minimum of two values min Logical operators (4) \u00b6 Short Description Function Logical and && Logical or || Logical xor \u02c6\u02c6 Logical not ! Kleene operators (three-way logic) (3) \u00b6 Short Description Function Kleene and &&& Kleene or ||| Kleene not !!! Bitwise arithmetic (4) \u00b6 Short Description Function Bitwise and & Bitwise or | Bitwise xor \u02c6 Bitwise not ~","title":"Core Library (29)"},{"location":"function-library/core/#basic-arithmetic-9","text":"Short Description Function Addition of two values + Subtraction \u2212 Multiplication of two values * Floating-point division / Integer division // Negation u\u2212 Modulo % Remainder %% Raising to a power **","title":"Basic Arithmetic (9)"},{"location":"function-library/core/#comparison-operators-9","text":"Short Description Function General comparison cmp Equality == Inequality != Less than < Less than or equal to <= Greater than > Greater than or equal to >= Maximum of two values max Minimum of two values min","title":"Comparison Operators (9)"},{"location":"function-library/core/#logical-operators-4","text":"Short Description Function Logical and && Logical or || Logical xor \u02c6\u02c6 Logical not !","title":"Logical operators (4)"},{"location":"function-library/core/#kleene-operators-three-way-logic-3","text":"Short Description Function Kleene and &&& Kleene or ||| Kleene not !!!","title":"Kleene operators (three-way logic) (3)"},{"location":"function-library/core/#bitwise-arithmetic-4","text":"Short Description Function Bitwise and & Bitwise or | Bitwise xor \u02c6 Bitwise not ~","title":"Bitwise arithmetic  (4)"},{"location":"function-library/data-mining/","text":"Regression (3) \u00b6 Short Description Function Apply the result of a linear regression model.reg.linear Propagate uncertainties through a linear regression model.reg.linearVariance Fit and predict a Gaussian Process model.reg.gaussianProcess Decision and Regression Trees (7) \u00b6 Short Description Function All-in-one function for simplest case model.tree.simpleTree Simple test function for a tree node model.tree.simpleTest Test function for a tree node with logical operators model.tree.compoundTest Test function with missing value handling model.tree.missingTest Chain of surrogate tests model.tree.surrogateTest Tree walk without explicit missing value handling model.tree.simpleWalk Tree walk with three branches: pass, fail, and missing model.tree.missingWalk Cluster Models (5) \u00b6 Short Description Function Closest cluster model.cluster.closest Closest N clusters or N-nearest neighbours model.cluster.closestN Random seeds for online clustering model.cluster.randomSeeds Online clustering with k-means model.cluster.kmeansIteration Update cluster using the mean of data points model.cluster.updateMean Nearest Neighbor Models (3) \u00b6 Short Description Function K nearest points model.neighbor.nearestK All points within R model.neighbor.ballR Mean of a sample of points, with weights model.neighbor.mean Naive Bayes (3) \u00b6 Short Description Function Bernoulli two-category likelihood model.naive.bernoulli Multinomial multi-category likelihood model.naive.multinomial Gaussian continuous likelihood model.naive.gaussian Neural Networks (1) \u00b6 Short Description Function Feedforward neural network organized in layers model.neural.simpleLayers Support Vector Machines (1) \u00b6 Short Description Function Basic SVM model.svm.score","title":"Data Mining Library (23)"},{"location":"function-library/data-mining/#regression-3","text":"Short Description Function Apply the result of a linear regression model.reg.linear Propagate uncertainties through a linear regression model.reg.linearVariance Fit and predict a Gaussian Process model.reg.gaussianProcess","title":"Regression (3)"},{"location":"function-library/data-mining/#decision-and-regression-trees-7","text":"Short Description Function All-in-one function for simplest case model.tree.simpleTree Simple test function for a tree node model.tree.simpleTest Test function for a tree node with logical operators model.tree.compoundTest Test function with missing value handling model.tree.missingTest Chain of surrogate tests model.tree.surrogateTest Tree walk without explicit missing value handling model.tree.simpleWalk Tree walk with three branches: pass, fail, and missing model.tree.missingWalk","title":"Decision and Regression Trees (7)"},{"location":"function-library/data-mining/#cluster-models-5","text":"Short Description Function Closest cluster model.cluster.closest Closest N clusters or N-nearest neighbours model.cluster.closestN Random seeds for online clustering model.cluster.randomSeeds Online clustering with k-means model.cluster.kmeansIteration Update cluster using the mean of data points model.cluster.updateMean","title":"Cluster Models (5)"},{"location":"function-library/data-mining/#nearest-neighbor-models-3","text":"Short Description Function K nearest points model.neighbor.nearestK All points within R model.neighbor.ballR Mean of a sample of points, with weights model.neighbor.mean","title":"Nearest Neighbor Models (3)"},{"location":"function-library/data-mining/#naive-bayes-3","text":"Short Description Function Bernoulli two-category likelihood model.naive.bernoulli Multinomial multi-category likelihood model.naive.multinomial Gaussian continuous likelihood model.naive.gaussian","title":"Naive Bayes (3)"},{"location":"function-library/data-mining/#neural-networks-1","text":"Short Description Function Feedforward neural network organized in layers model.neural.simpleLayers","title":"Neural Networks (1)"},{"location":"function-library/data-mining/#support-vector-machines-1","text":"Short Description Function Basic SVM model.svm.score","title":"Support Vector Machines (1)"},{"location":"function-library/date-time/","text":"Extracting Conventional Time Units from Timestamp (8) \u00b6 Short Description Function Year from timestamp time.year Month of year from timestamp time.monthOfYear Day of year from timestamp time.dayOfYear Day of month from timestamp time.dayOfMonth Day of week from timestamp time.dayOfWeek Hour of day from timestamp time.hourOfDay Minutes past the hour from timestamp time.minuteOfHour Seconds past the minute from timestamp time.secondOfMinute Constructing Timestamp from Conventional Units (1) \u00b6 Short Description Function Make timestamp time.makeTimestamp Querying Time Intervals (9) \u00b6 Short Description Function Seconds of minute range time.isSecondOfMinute Minutes of hour range time.isMinuteOfHour Hour of day range time.isHourOfDay Day of week range time.isDayOfWeek Day of month range time.isDayOfMonth Month of year range time.isMonthOfYear Day of year range time.isDayOfYear Weekend range time.isWeekend Working hours range time.isWorkHours","title":"Date/Time Handling (18)"},{"location":"function-library/date-time/#extracting-conventional-time-units-from-timestamp-8","text":"Short Description Function Year from timestamp time.year Month of year from timestamp time.monthOfYear Day of year from timestamp time.dayOfYear Day of month from timestamp time.dayOfMonth Day of week from timestamp time.dayOfWeek Hour of day from timestamp time.hourOfDay Minutes past the hour from timestamp time.minuteOfHour Seconds past the minute from timestamp time.secondOfMinute","title":"Extracting Conventional Time Units from Timestamp (8)"},{"location":"function-library/date-time/#constructing-timestamp-from-conventional-units-1","text":"Short Description Function Make timestamp time.makeTimestamp","title":"Constructing Timestamp from Conventional Units (1)"},{"location":"function-library/date-time/#querying-time-intervals-9","text":"Short Description Function Seconds of minute range time.isSecondOfMinute Minutes of hour range time.isMinuteOfHour Hour of day range time.isHourOfDay Day of week range time.isDayOfWeek Day of month range time.isDayOfMonth Month of year range time.isMonthOfYear Day of year range time.isDayOfYear Weekend range time.isWeekend Working hours range time.isWorkHours","title":"Querying Time Intervals (9)"},{"location":"function-library/descriptive-stats/","text":"Statistical Tests (7) \u00b6 Short Description Function Kolmogorov-Smirnov test of two distributions stat.test.kolmogorov Compute residual of a fit stat.test.residual Compute the pull of a fit stat.test.pull Compute the Mahalanobis of a fit stat.test.mahalanobis Update a cumulative \u03c72 calculation stat.test.updateChi2 Compute the reduced \u03c72 stat.test.reducedChi2 Compute the \u03c72 probability stat.test.chi2Prob Sample Statistics (12) \u00b6 Short Description Function Incremental count, mean, and/or variance stat.sample.update Incremental covariance matrix stat.sample.updateCovariance Incremental count, mean, and/or variance in a window stat.sample.updateWindow Exponentially weighted moving average (EWMA) stat.sample.updateEWMA Doubly exponential average with trend stat.sample.updateHoltWinters Triply exponential average: trend and period stat.sample.updateHoltWintersPeriodic Make one forecast from a Holt-Winters state stat.sample.forecast1HoltWinters Make many forecasts from a Holt-Winters state stat.sample.forecastHoltWinters Fill a histogram stat.sample.fillHistogram Fill a two-dimensional histogram stat.sample.fillHistogram2d Fill a counter/categorical histogram stat.sample.fillCounter Maintain a top-N list stat.sample.topN Change Detection (3) \u00b6 Short Description Function Historical record of triggered events stat.change.updateTrigger Simple difference over uncertainty stat.change.zValue Cumulative sum stat.change.updateCUSUM","title":"Descriptive Statistics Library (22)"},{"location":"function-library/descriptive-stats/#statistical-tests-7","text":"Short Description Function Kolmogorov-Smirnov test of two distributions stat.test.kolmogorov Compute residual of a fit stat.test.residual Compute the pull of a fit stat.test.pull Compute the Mahalanobis of a fit stat.test.mahalanobis Update a cumulative \u03c72 calculation stat.test.updateChi2 Compute the reduced \u03c72 stat.test.reducedChi2 Compute the \u03c72 probability stat.test.chi2Prob","title":"Statistical Tests (7)"},{"location":"function-library/descriptive-stats/#sample-statistics-12","text":"Short Description Function Incremental count, mean, and/or variance stat.sample.update Incremental covariance matrix stat.sample.updateCovariance Incremental count, mean, and/or variance in a window stat.sample.updateWindow Exponentially weighted moving average (EWMA) stat.sample.updateEWMA Doubly exponential average with trend stat.sample.updateHoltWinters Triply exponential average: trend and period stat.sample.updateHoltWintersPeriodic Make one forecast from a Holt-Winters state stat.sample.forecast1HoltWinters Make many forecasts from a Holt-Winters state stat.sample.forecastHoltWinters Fill a histogram stat.sample.fillHistogram Fill a two-dimensional histogram stat.sample.fillHistogram2d Fill a counter/categorical histogram stat.sample.fillCounter Maintain a top-N list stat.sample.topN","title":"Sample Statistics (12)"},{"location":"function-library/descriptive-stats/#change-detection-3","text":"Short Description Function Historical record of triggered events stat.change.updateTrigger Simple difference over uncertainty stat.change.zValue Cumulative sum stat.change.updateCUSUM","title":"Change Detection (3)"},{"location":"function-library/impute/","text":"Missing Values as null (2) \u00b6 Short Description Function Skip record or halt processing impute.errorOnNull Replace with default impute.defaultOnNull Floating Point Missing Values (5) \u00b6 Short Description Function Check for not-a-number impute.isnan Check for infinity impute.isinf Ensure a finite number impute.isnum Skip record or halt processing impute.errorOnNonNum Replace with default impute.defaultOnNonNum","title":"Impute/Missing Data Handling Library (7)"},{"location":"function-library/impute/#missing-values-as-null-2","text":"Short Description Function Skip record or halt processing impute.errorOnNull Replace with default impute.defaultOnNull","title":"Missing Values as null (2)"},{"location":"function-library/impute/#floating-point-missing-values-5","text":"Short Description Function Check for not-a-number impute.isnan Check for infinity impute.isinf Ensure a finite number impute.isnum Skip record or halt processing impute.errorOnNonNum Replace with default impute.defaultOnNonNum","title":"Floating Point Missing Values (5)"},{"location":"function-library/interpolation/","text":"Short Description Function Histogram-like binning interp.bin Nearest point, vector, or abstract type interp.nearest Linear interpolation between two nearest 1-dim points interp.linear Linear interpolation with flat endpoints interp.linearFlat Linear interpolation with missing values after endpoints interp.linearMissing","title":"Interpolation Library (5)"},{"location":"function-library/linear-algebra/","text":"Short Description Function Unary scaling of vectors or matrices la.scale Generalized unary operator la.map Addition of vectors or matrices la.add Subtraction of vectors or matrices la.sub Generalized binary operator la.zipmap Vector and matrix dot product la.dot Transpose la.transpose Inverse and pseudo-inverse la.inverse Trace la.trace Determinant la.det Check for symmetry la.symmetric Real eigenbasis of symmetric matrix la.eigenBasis Truncate rows la.truncate","title":"Linear Algebra Library (13)"},{"location":"function-library/map/","text":"Basic Access (3) \u00b6 Short Description Function Length map.len Extract the keys map.keys Extract the values map.values Search and Replace (2) \u00b6 Short Description Function Contains key map.containsKey Contains value map.containsValue Manipulation (7) \u00b6 Short Description Function Insert a key-value pair map.add Remove a key map.remove Keep only certain keys map.only Keep all except certain keys map.except Add or replace keys with an overlay map map.update Split map into an array of single-key maps map.split Join an array of maps into one map map.join Extreme Values by Key (8) \u00b6 Short Description Function Argument maximum map.argmax Argument minimum map.argmin Argument maximum with a less-than function map.argmaxLT Argument minimum with a less-than function map.argminLT Maximum N arguments map.argmaxN Minimum N arguments map.argminN Maximum N arguments with a less-than function map.argmaxNLT Minimum N arguments with a less-than function map.argminNLT Set or Set-like Functions (9) \u00b6 Short Description Function Convert an array to a map-set map.toset Convert a map to an array-set map.fromset Determine if an object is in the set map.in Union map.union Intersection map.intersection Set difference map.diff Symmetric set difference map.symdiff Subset check map.subset Disjointness check map.disjoint Functional Programming (10) \u00b6 Short Description Function Transform map items with a function map.map Transform map items, providing access to the key map.mapWithKey Filter map items with a function map.filter Filter map items, providing access to the key map.filterWithKey Filter and map map.filterMap Filter and map, providing access to the keys map.filterMapWithKey Map and flatten map.flatMap Map and flatten, providing access to the keys map.flatMapWithKey Zip and map map.zipmap Zip and map, providing access to the keys map.zipmapWithKey Functional Tests (2) \u00b6 Short Description Function Pairwise check of two maps map.corresponds Pairwise check, providing access to the keys map.correspondsWithKey","title":"Map Manipulation Library (41)"},{"location":"function-library/map/#basic-access-3","text":"Short Description Function Length map.len Extract the keys map.keys Extract the values map.values","title":"Basic Access (3)"},{"location":"function-library/map/#search-and-replace-2","text":"Short Description Function Contains key map.containsKey Contains value map.containsValue","title":"Search and Replace (2)"},{"location":"function-library/map/#manipulation-7","text":"Short Description Function Insert a key-value pair map.add Remove a key map.remove Keep only certain keys map.only Keep all except certain keys map.except Add or replace keys with an overlay map map.update Split map into an array of single-key maps map.split Join an array of maps into one map map.join","title":"Manipulation (7)"},{"location":"function-library/map/#extreme-values-by-key-8","text":"Short Description Function Argument maximum map.argmax Argument minimum map.argmin Argument maximum with a less-than function map.argmaxLT Argument minimum with a less-than function map.argminLT Maximum N arguments map.argmaxN Minimum N arguments map.argminN Maximum N arguments with a less-than function map.argmaxNLT Minimum N arguments with a less-than function map.argminNLT","title":"Extreme Values by Key (8)"},{"location":"function-library/map/#set-or-set-like-functions-9","text":"Short Description Function Convert an array to a map-set map.toset Convert a map to an array-set map.fromset Determine if an object is in the set map.in Union map.union Intersection map.intersection Set difference map.diff Symmetric set difference map.symdiff Subset check map.subset Disjointness check map.disjoint","title":"Set or Set-like Functions (9)"},{"location":"function-library/map/#functional-programming-10","text":"Short Description Function Transform map items with a function map.map Transform map items, providing access to the key map.mapWithKey Filter map items with a function map.filter Filter map items, providing access to the key map.filterWithKey Filter and map map.filterMap Filter and map, providing access to the keys map.filterMapWithKey Map and flatten map.flatMap Map and flatten, providing access to the keys map.flatMapWithKey Zip and map map.zipmap Zip and map, providing access to the keys map.zipmapWithKey","title":"Functional Programming (10)"},{"location":"function-library/map/#functional-tests-2","text":"Short Description Function Pairwise check of two maps map.corresponds Pairwise check, providing access to the keys map.correspondsWithKey","title":"Functional Tests (2)"},{"location":"function-library/math/","text":"Constants (2) \u00b6 Short Description Constant Archimedes' constant \u03c0 m.pi Euler's constant e m.e Common Functions (18) \u00b6 Short Description Function Square root m.sqrt Hypotenuse m.hypot Trigonometric sine m.sin Trigonometric cosine m.cos Trigonometric tangent m.tan Inverse trigonometric sine m.asin Inverse trigonometric cosine m.acos Inverse trigonometric tangent m.atan Robust inverse trigonometric tangent m.atan2 Hyperbolic sine m.sinh Hyperbolic cosine m.cosh Hyperbolic tangent m.tanh Natural exponential m.exp Natural exponential minus one m.expm1 Natural logarithm m.ln Logarithm base 10 m.log10 Arbitrary logarithm m.log Natural logarithm of one plus square m.ln1p Rounding (7) \u00b6 Short Description Function Absolute value m.abs Floor m.floor Ceiling m.ceil Simple rounding m.round Unbiased rounding m.rint Threshold function m.signum Copy sign m.copysign Special Functions (5) \u00b6 Short Description Function Error function m.special.erf Complimentary error function m.special.erfc Natural log of the gamma function m.special.lnGamma Natural log of the beta function m.special.lnBeta Binomial coefficient m.special.nChooseK Link or Activation Functions (9) \u00b6 Short Description Function Logit m.link.logit Probit m.link.probit Log-log m.link.loglog Complement of log-log m.link.cloglog Cauchit m.link.cauchit Hyperbolic tangent m.link.tanh Softmax m.link.softmax SoftPlus m.link.softplus Rectified linear unit m.link.relu Kernel Functions (4) \u00b6 Short Description Function Linear m.kernel.linear Radial basis function m.kernel.rbf Polynomial m.kernel.poly Sigmoidal m.kernel.linear","title":"Math Library (45)"},{"location":"function-library/math/#constants-2","text":"Short Description Constant Archimedes' constant \u03c0 m.pi Euler's constant e m.e","title":"Constants (2)"},{"location":"function-library/math/#common-functions-18","text":"Short Description Function Square root m.sqrt Hypotenuse m.hypot Trigonometric sine m.sin Trigonometric cosine m.cos Trigonometric tangent m.tan Inverse trigonometric sine m.asin Inverse trigonometric cosine m.acos Inverse trigonometric tangent m.atan Robust inverse trigonometric tangent m.atan2 Hyperbolic sine m.sinh Hyperbolic cosine m.cosh Hyperbolic tangent m.tanh Natural exponential m.exp Natural exponential minus one m.expm1 Natural logarithm m.ln Logarithm base 10 m.log10 Arbitrary logarithm m.log Natural logarithm of one plus square m.ln1p","title":"Common Functions (18)"},{"location":"function-library/math/#rounding-7","text":"Short Description Function Absolute value m.abs Floor m.floor Ceiling m.ceil Simple rounding m.round Unbiased rounding m.rint Threshold function m.signum Copy sign m.copysign","title":"Rounding (7)"},{"location":"function-library/math/#special-functions-5","text":"Short Description Function Error function m.special.erf Complimentary error function m.special.erfc Natural log of the gamma function m.special.lnGamma Natural log of the beta function m.special.lnBeta Binomial coefficient m.special.nChooseK","title":"Special Functions (5)"},{"location":"function-library/math/#link-or-activation-functions-9","text":"Short Description Function Logit m.link.logit Probit m.link.probit Log-log m.link.loglog Complement of log-log m.link.cloglog Cauchit m.link.cauchit Hyperbolic tangent m.link.tanh Softmax m.link.softmax SoftPlus m.link.softplus Rectified linear unit m.link.relu","title":"Link or Activation Functions (9)"},{"location":"function-library/math/#kernel-functions-4","text":"Short Description Function Linear m.kernel.linear Radial basis function m.kernel.rbf Polynomial m.kernel.poly Sigmoidal m.kernel.linear","title":"Kernel Functions (4)"},{"location":"function-library/metric/","text":"Short Description Function Euclidean metric without similarity or missing values metric.simpleEuclidean Absolute difference similarity function metric.absDiff Gaussian similarity function metric.gaussianSimilarity Euclidean metric metric.euclidean Squared euclidean metric metric.squaredEuclidean Chebyshev metric metric.chebyshev Taxicab metric metric.taxicab Minkowski metric metric.minkowski Simple binary metric metric.simpleMatching Jaccard binary similarity metric.jaccard Tanimoto binary similarity metric.tanimoto General binary metric metric.binarySimilarity","title":"Metric Library (12)"},{"location":"function-library/other-ds/","text":"Fixed (2) \u00b6 Short Description Function Convert to bytes fixed.toBytes Convert from bytes fixed.fromBytes Enum (3) \u00b6 Short Description Function String representation enum.toString Integer representation enum.toInt Number of symbols enum.numSymbols","title":"Manipulation of Other Data Structures (5)"},{"location":"function-library/other-ds/#fixed-2","text":"Short Description Function Convert to bytes fixed.toBytes Convert from bytes fixed.fromBytes","title":"Fixed (2)"},{"location":"function-library/other-ds/#enum-3","text":"Short Description Function String representation enum.toString Integer representation enum.toInt Number of symbols enum.numSymbols","title":"Enum (3)"},{"location":"function-library/parsing/","text":"Parsing Numbers (4) \u00b6 Short Description Function 32-bit integers parse.int 64-bit integers parse.long Single-precision floating point parse.float Double-precision floating point parse.double","title":"Parsing Library (4)"},{"location":"function-library/parsing/#parsing-numbers-4","text":"Short Description Function 32-bit integers parse.int 64-bit integers parse.long Single-precision floating point parse.float Double-precision floating point parse.double","title":"Parsing Numbers (4)"},{"location":"function-library/prob/","text":"Uniform Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.uniformPDF Cumulative distribution function prob.dist.uniformCDF Quantile function prob.dist.uniformQF Exponential Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.exponentialPDF Cumulative distribution function prob.dist.exponentialCDF Quantile function prob.dist.exponentialQF Gaussian (Normal) Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.gaussianLL Cumulative distribution function prob.dist.gaussianCDF Quantile function prob.dist.gaussianQF Lognormal Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.lognormalPDF Cumulative distribution function prob.dist.lognormalCDF Quantile function prob.dist.lognormalQF Cauchy Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.cauchyPDF Cumulative distribution function prob.dist.cauchyCDF Quantile function prob.dist.cauchyQF Binomial Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.binomialPDF Cumulative distribution function prob.dist.binomialCDF Quantile function prob.dist.binomialQF Negative Binomial (3) \u00b6 Short Description Function Probability density function prob.dist.negativebinomialPDF Cumulative distribution function prob.dist.negativebinomialCDF Quantile function prob.dist.negativebinomialQF Poisson Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.poissonPDF Cumulative distribution function prob.dist.poissonCDF Quantile function prob.dist.poissonQF Student's t Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.tPDF Cumulative distribution function prob.dist.tCDF Quantile function prob.dist.tQF F Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.fPDF Cumulative distribution function prob.dist.fCDF Quantile function prob.dist.fQF Chi-square Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.chi2PDF Cumulative distribution function prob.dist.chi2CDF Quantile function prob.dist.chi2QF Beta Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.betaPDF Cumulative distribution function prob.dist.betaCDF Quantile function prob.dist.betaQF Gamma Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.gammaPDF Cumulative distribution function prob.dist.gammaCDF Quantile function prob.dist.gammaQF Geometric Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.geometricPDF Cumulative distribution function prob.dist.geometricCDF Quantile function prob.dist.geometricQF Hypergeometric Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.hypergeometricPDF Cumulative distribution function prob.dist.hypergeometricCDF Quantile function prob.dist.hypergeometricQF Weibull Distribution (3) \u00b6 Short Description Function Probability density function prob.dist.weibullPDF Cumulative distribution function prob.dist.weibullCDF Quantile function prob.dist.weibullQF","title":"Probability Library (48)"},{"location":"function-library/prob/#uniform-distribution-3","text":"Short Description Function Probability density function prob.dist.uniformPDF Cumulative distribution function prob.dist.uniformCDF Quantile function prob.dist.uniformQF","title":"Uniform Distribution (3)"},{"location":"function-library/prob/#exponential-distribution-3","text":"Short Description Function Probability density function prob.dist.exponentialPDF Cumulative distribution function prob.dist.exponentialCDF Quantile function prob.dist.exponentialQF","title":"Exponential Distribution (3)"},{"location":"function-library/prob/#gaussian-normal-distribution-3","text":"Short Description Function Probability density function prob.dist.gaussianLL Cumulative distribution function prob.dist.gaussianCDF Quantile function prob.dist.gaussianQF","title":"Gaussian (Normal) Distribution (3)"},{"location":"function-library/prob/#lognormal-distribution-3","text":"Short Description Function Probability density function prob.dist.lognormalPDF Cumulative distribution function prob.dist.lognormalCDF Quantile function prob.dist.lognormalQF","title":"Lognormal Distribution (3)"},{"location":"function-library/prob/#cauchy-distribution-3","text":"Short Description Function Probability density function prob.dist.cauchyPDF Cumulative distribution function prob.dist.cauchyCDF Quantile function prob.dist.cauchyQF","title":"Cauchy Distribution (3)"},{"location":"function-library/prob/#binomial-distribution-3","text":"Short Description Function Probability density function prob.dist.binomialPDF Cumulative distribution function prob.dist.binomialCDF Quantile function prob.dist.binomialQF","title":"Binomial Distribution (3)"},{"location":"function-library/prob/#negative-binomial-3","text":"Short Description Function Probability density function prob.dist.negativebinomialPDF Cumulative distribution function prob.dist.negativebinomialCDF Quantile function prob.dist.negativebinomialQF","title":"Negative Binomial (3)"},{"location":"function-library/prob/#poisson-distribution-3","text":"Short Description Function Probability density function prob.dist.poissonPDF Cumulative distribution function prob.dist.poissonCDF Quantile function prob.dist.poissonQF","title":"Poisson Distribution (3)"},{"location":"function-library/prob/#students-t-distribution-3","text":"Short Description Function Probability density function prob.dist.tPDF Cumulative distribution function prob.dist.tCDF Quantile function prob.dist.tQF","title":"Student's t Distribution (3)"},{"location":"function-library/prob/#f-distribution-3","text":"Short Description Function Probability density function prob.dist.fPDF Cumulative distribution function prob.dist.fCDF Quantile function prob.dist.fQF","title":"F Distribution (3)"},{"location":"function-library/prob/#chi-square-distribution-3","text":"Short Description Function Probability density function prob.dist.chi2PDF Cumulative distribution function prob.dist.chi2CDF Quantile function prob.dist.chi2QF","title":"Chi-square Distribution (3)"},{"location":"function-library/prob/#beta-distribution-3","text":"Short Description Function Probability density function prob.dist.betaPDF Cumulative distribution function prob.dist.betaCDF Quantile function prob.dist.betaQF","title":"Beta Distribution (3)"},{"location":"function-library/prob/#gamma-distribution-3","text":"Short Description Function Probability density function prob.dist.gammaPDF Cumulative distribution function prob.dist.gammaCDF Quantile function prob.dist.gammaQF","title":"Gamma Distribution (3)"},{"location":"function-library/prob/#geometric-distribution-3","text":"Short Description Function Probability density function prob.dist.geometricPDF Cumulative distribution function prob.dist.geometricCDF Quantile function prob.dist.geometricQF","title":"Geometric Distribution (3)"},{"location":"function-library/prob/#hypergeometric-distribution-3","text":"Short Description Function Probability density function prob.dist.hypergeometricPDF Cumulative distribution function prob.dist.hypergeometricCDF Quantile function prob.dist.hypergeometricQF","title":"Hypergeometric Distribution (3)"},{"location":"function-library/prob/#weibull-distribution-3","text":"Short Description Function Probability density function prob.dist.weibullPDF Cumulative distribution function prob.dist.weibullCDF Quantile function prob.dist.weibullQF","title":"Weibull Distribution (3)"},{"location":"function-library/random-number/","text":"Uniform Random Deviates of Basic Types (6) \u00b6 Short Description Function Random integer rand.int Random integer rand.long Random integer rand.float Random integer rand.double Random string rand.string Random bytes rand.bytes Common Statistical Distributions (1) \u00b6 Short Description Function Gaussian deviates rand.gaussian Common Utility Types (1) \u00b6 Short Description Function Type-4 UUID rand.uuid4 Selecting Arbitrary Objects from a Bag (4) \u00b6 Short Description Function Random object from a bag rand.choice Random set of objects with replacement rand.choices Random set of objects without replacement rand.sample Random objects with a specified probability distribution rand.histogram","title":"Random Number Library (12)"},{"location":"function-library/random-number/#uniform-random-deviates-of-basic-types-6","text":"Short Description Function Random integer rand.int Random integer rand.long Random integer rand.float Random integer rand.double Random string rand.string Random bytes rand.bytes","title":"Uniform Random Deviates of Basic Types (6)"},{"location":"function-library/random-number/#common-statistical-distributions-1","text":"Short Description Function Gaussian deviates rand.gaussian","title":"Common Statistical Distributions (1)"},{"location":"function-library/random-number/#common-utility-types-1","text":"Short Description Function Type-4 UUID rand.uuid4","title":"Common Utility Types (1)"},{"location":"function-library/random-number/#selecting-arbitrary-objects-from-a-bag-4","text":"Short Description Function Random object from a bag rand.choice Random set of objects with replacement rand.choices Random set of objects without replacement rand.sample Random objects with a specified probability distribution rand.histogram","title":"Selecting Arbitrary Objects from a Bag (4)"},{"location":"function-library/regex/","text":"Basic Identification of Pattern (2) \u00b6 Short Description Function Check for existence of a pattern re.contains Count occurrences of a pattern re.count Get Matched Patterns (2) \u00b6 Short Description Function Find the first instance of a pattern re.findfirst Find all instances of a pattern re.findall Get Matched Groups (2) \u00b6 Short Description Function Get first set of matching groups re.groups Get all sets of matching groups re.groupsall Get Matched Patterns and Groups (2) \u00b6 Short Description Function Find the first instance of a pattern, with groups re.findgroupsfirst Find all instances of a pattern, with groups re.findgroupsall Get Index Position of Match (3) \u00b6 Short Description Function Find the first index where a pattern appears re.index Find the last index where a pattern appears re.rindex Find all indexes that match a pattern re.indexall Replacement (3) \u00b6 Short Description Function Replace the first instance of a pattern re.replacefirst Replace the last instance of a pattern re.replacelast Replace all instances of a pattern re.replaceall Splitting (1) \u00b6 Short Description Function Split a string by a pattern re.split","title":"Regular Expressions and Text Pre-processing (15)"},{"location":"function-library/regex/#basic-identification-of-pattern-2","text":"Short Description Function Check for existence of a pattern re.contains Count occurrences of a pattern re.count","title":"Basic Identification of Pattern (2)"},{"location":"function-library/regex/#get-matched-patterns-2","text":"Short Description Function Find the first instance of a pattern re.findfirst Find all instances of a pattern re.findall","title":"Get Matched Patterns (2)"},{"location":"function-library/regex/#get-matched-groups-2","text":"Short Description Function Get first set of matching groups re.groups Get all sets of matching groups re.groupsall","title":"Get Matched Groups (2)"},{"location":"function-library/regex/#get-matched-patterns-and-groups-2","text":"Short Description Function Find the first instance of a pattern, with groups re.findgroupsfirst Find all instances of a pattern, with groups re.findgroupsall","title":"Get Matched Patterns and Groups (2)"},{"location":"function-library/regex/#get-index-position-of-match-3","text":"Short Description Function Find the first index where a pattern appears re.index Find the last index where a pattern appears re.rindex Find all indexes that match a pattern re.indexall","title":"Get Index Position of Match (3)"},{"location":"function-library/regex/#replacement-3","text":"Short Description Function Replace the first instance of a pattern re.replacefirst Replace the last instance of a pattern re.replacelast Replace all instances of a pattern re.replaceall","title":"Replacement (3)"},{"location":"function-library/regex/#splitting-1","text":"Short Description Function Split a string by a pattern re.split","title":"Splitting (1)"},{"location":"function-library/string-manipulation/","text":"Basic Access (3) \u00b6 Name Function Length s.len Extract substring s.substr Modify substring s.substrto Search and Replace (6) \u00b6 Name Function Contains s.contains Count instances s.count Find first index s.index Find last index s.rindex Check start s.startswith Check end s.endswith Conversions to or from Other Types (5) \u00b6 Name Function Join an array of strings s.join Split into an array of strings s.split Format an integer as a string s.int Format a positive integer as hexidecimal s.hex Format any number as a string s.number Conversions to or from Other Strings (11) \u00b6 Name Function Concatenate two strings s.concat Repeat pattern s.repeat Lowercase s.lower Uppercase s.upper Left-strip s.lstrip Right-strip s.rstrip Strip both ends s.strip Replace all matches s.replaceall Replace first match s.replacefirst Replace last match s.replacelast Translate characters s.translate","title":"String Manipulation Library (25)"},{"location":"function-library/string-manipulation/#basic-access-3","text":"Name Function Length s.len Extract substring s.substr Modify substring s.substrto","title":"Basic Access (3)"},{"location":"function-library/string-manipulation/#search-and-replace-6","text":"Name Function Contains s.contains Count instances s.count Find first index s.index Find last index s.rindex Check start s.startswith Check end s.endswith","title":"Search and Replace (6)"},{"location":"function-library/string-manipulation/#conversions-to-or-from-other-types-5","text":"Name Function Join an array of strings s.join Split into an array of strings s.split Format an integer as a string s.int Format a positive integer as hexidecimal s.hex Format any number as a string s.number","title":"Conversions to or from Other Types (5)"},{"location":"function-library/string-manipulation/#conversions-to-or-from-other-strings-11","text":"Name Function Concatenate two strings s.concat Repeat pattern s.repeat Lowercase s.lower Uppercase s.upper Left-strip s.lstrip Right-strip s.rstrip Strip both ends s.strip Replace all matches s.replaceall Replace first match s.replacefirst Replace last match s.replacelast Translate characters s.translate","title":"Conversions to or from Other Strings (11)"},{"location":"pfa/","text":"TL;DR The Portable Format for Analytics (PFA) is a specification for scoring/inference engines: event-based processors that perform predictive or analytic calculations. It is a model interchange format which helps smoothen the transition from statistical model development to large-scale and/or online production. You can run your analytic anywhere using PFA (Portable Format for Analytics) as: It encapsulates a unit of data processing called a scoring engine. It provides a common interface to safely deploy analytic workflows across environments, from embedded systems to distributed data centers. It is an emerging standard for statistical models and data transformation engines. PFA combines the ease of portability across systems with algorithmic flexibility: models, pre-processing, and post-processing are all functions that can be arbitrarily composed, chained, or built into complex workflows. PFA may be as simple as a raw data transformation or as sophisticated as a suite of concurrent data mining models, all described as a JSON or YAML configuration file. What is PFA for? \u00b6 Hardening a Data Analysis \u00b6 Data analysis is not software development: a different set of best practices apply. For a large software project, one should start by designing a maintainable architecture, but for data analysis, one should start by examining the dataset in as many ways as possible. Sometimes, a simple observation in this exploratory phase dramatically changes one\u2019s analysis strategy. The worlds of data analysis and software development clash when a poorly structured analytic procedure must be scaled up to a large production workflow. The \u201ctry anything, get feedback quickly\u201d mindset that was an asset in the development phase leads to failures in production. As data analyses mature, they must be hardened\u2014 they must have fewer dependencies, a more maintainable structure, and they must be robust against errors. The Portable Format for Analytics (PFA) is a common language to help smooth the transition from development to production. PFA-enabled analysis tools produce their results as JSON documents with a structure defined by the PFA specification. For instance, suppose a machine learning algorithm produces a classifier that we wish to apply to a large cluster-bound dataset. If it produces that classifier in PFA format, a PFA-enabled host running on the cluster can execute it in a safe, controlled way. Developer tools that speak PFA can deploy their scoring engines (e.g. classifiers, predictors, smoothers, filters) on production environments that understand PFA. The only connection between the two worlds is the PFA document, a human-readable text file. In fact, this text file could have contributions from several statistical packages, or it could be modified by JSON-manipulating tools or by hand before it is delivered. By contrast, scoring engines in custom formats present the system maintainers with three options: try to install the data analyst\u2019s tool across the production environment, including all of its dependencies, port the algorithm and spend weeks chasing small (but compounding) numerical errors, and dumb-down the analytic. None of these are good options. Separation of Concerns \u00b6 Analysis code only needs to be hardened if it will be executed often or at large scale. A one-time study on an analyst\u2019s laptop does not need to adhere to software design principles. But in this era of Big Data, many analyses are crossing the threshold from laptops to server farms, and so deployment issues are becoming more common than ever. Tools such as Hadoop and Storm provide automated data pipelines, separating the data flow from the functions that are performed on data (mappers and reducers in Hadoop, spouts and bolts in Storm). Ordinarily, these functions are written in code that has access to the pipeline internals, the host operating system, the remote filesystem, the network, etc. However, all they should do is math. PFA completes the abstraction by encapsulating these functions as PFA documents. From the point of view of the pipeline system, the documents are configuration files that may be loaded or replaced independently of the pipeline code. This separation of concerns allows the data analysis to evolve independently of the pipeline. Since scoring engines written in PFA are not capable of accessing or manipulating their environment, they cannot jeopardize the production system. Data analysts can focus on the mathematical correctness of their algorithms and security reviews are only needed when the pipeline itself changes. This decoupling is important because statistical models usually change more quickly than pipeline frameworks. Model details are often tweaked in response to discoveries about the data and models frequently need to be refreshed with new training samples. Flexibility and Safety \u00b6 Traditionally, scoring engines have been deployed in one of two ways: as a table of model parameters or as custom code. A table of parameters needs to be interpreted before it can classify or predict anything, so it implicitly comes with a fixed executable, usually the statistical package that produced it. The problem with a table of parameters is that it is inflexible: its associated executable can only perform the operation it was designed to do. The problem with custom code is that it is too powerful, as explained in the previous section. The Predictive Model Markup Language (PMML) was an attempt to bridge this gap by standardizing several of the most common kinds of scoring engines. Like PFA, PMML documents are intermediate text files (XML) produced by data analysis tools and consumed by an executable in the production environment. New functionality has been added to PMML over the past 17 years, but it is still based on tables of model parameters. Even a modest extension of a scoring engine requires a new version of PMML to be adopted, which can take years. PFA serves this purpose with far more generality. Unlike PMML, PFA has control structures to direct program flow, a true type system for both model parameters and data, and its statistical functions are much more finely grained and can accept callbacks to modify their behavior. The author of a PFA document can construct new types of models from building blocks without waiting for the new model to be explicitly added to the specification. PFA is more flexible than PMML, but safer than custom code. In the language of optimizations, it is the most flexible way to describe a scoring engine subject to the constraint that it won\u2019t break the data pipeline. Overview of PFA capabilities \u00b6 The following contribute to PFA's flexibility : It has control structures, such as conditionals, loops, and user-defined functions (like a typical programming language). It is entirely expressed within JSON, and can therefore be easily generated and manipulated by other programs. This is important because PFA documents are usually generated from training data by a statistical package or a machine learning algorithm. Its library of functions is finely grained: multi-step processes are defined by chaining multiple functions. A user with a new type of model in mind can mix and match these library functions as needed. Many library functions accept callbacks to further modify their behavior. Scoring engines can share data or update external variables, such as entries in a database. The following contribute to PFA's safety : It has strict numerical compatibility: the same PFA document and the same input results in the same output, regardless of platform. The specification only defines functions that transform data. All inputs and outputs are controlled by the host system. It has a type system that can be statically checked. Specifically, PFA types are Avro types (Avro is a data serialization format used to move data in several popular pipeline frameworks). This system has a type-safe null and PFA only performs type-safe casting, which ensure that missing data never cause run-time errors. The callbacks that generalize PFA\u2019s statistical models are not first-class functions. This means that the set of functions that a PFA document might call can be predicted before it runs. A PFA host may choose to only allow certain functions. The semantics of shared data guarantee that data are never corrupted by concurrent access and scoring engines do not enter deadlock. The host can also statically determine which shared variables may be modified by a scoring engine, rather than at run-time. To learn more, read the tutorials (which have interactive examples, so that you can see PFA in action) or the complete reference, which are linked in the sidebar or at the top of this page. Source Data Mining Group Website","title":"Overview"},{"location":"pfa/#what-is-pfa-for","text":"","title":"What is PFA for?"},{"location":"pfa/#hardening-a-data-analysis","text":"Data analysis is not software development: a different set of best practices apply. For a large software project, one should start by designing a maintainable architecture, but for data analysis, one should start by examining the dataset in as many ways as possible. Sometimes, a simple observation in this exploratory phase dramatically changes one\u2019s analysis strategy. The worlds of data analysis and software development clash when a poorly structured analytic procedure must be scaled up to a large production workflow. The \u201ctry anything, get feedback quickly\u201d mindset that was an asset in the development phase leads to failures in production. As data analyses mature, they must be hardened\u2014 they must have fewer dependencies, a more maintainable structure, and they must be robust against errors. The Portable Format for Analytics (PFA) is a common language to help smooth the transition from development to production. PFA-enabled analysis tools produce their results as JSON documents with a structure defined by the PFA specification. For instance, suppose a machine learning algorithm produces a classifier that we wish to apply to a large cluster-bound dataset. If it produces that classifier in PFA format, a PFA-enabled host running on the cluster can execute it in a safe, controlled way. Developer tools that speak PFA can deploy their scoring engines (e.g. classifiers, predictors, smoothers, filters) on production environments that understand PFA. The only connection between the two worlds is the PFA document, a human-readable text file. In fact, this text file could have contributions from several statistical packages, or it could be modified by JSON-manipulating tools or by hand before it is delivered. By contrast, scoring engines in custom formats present the system maintainers with three options: try to install the data analyst\u2019s tool across the production environment, including all of its dependencies, port the algorithm and spend weeks chasing small (but compounding) numerical errors, and dumb-down the analytic. None of these are good options.","title":"Hardening a Data Analysis"},{"location":"pfa/#separation-of-concerns","text":"Analysis code only needs to be hardened if it will be executed often or at large scale. A one-time study on an analyst\u2019s laptop does not need to adhere to software design principles. But in this era of Big Data, many analyses are crossing the threshold from laptops to server farms, and so deployment issues are becoming more common than ever. Tools such as Hadoop and Storm provide automated data pipelines, separating the data flow from the functions that are performed on data (mappers and reducers in Hadoop, spouts and bolts in Storm). Ordinarily, these functions are written in code that has access to the pipeline internals, the host operating system, the remote filesystem, the network, etc. However, all they should do is math. PFA completes the abstraction by encapsulating these functions as PFA documents. From the point of view of the pipeline system, the documents are configuration files that may be loaded or replaced independently of the pipeline code. This separation of concerns allows the data analysis to evolve independently of the pipeline. Since scoring engines written in PFA are not capable of accessing or manipulating their environment, they cannot jeopardize the production system. Data analysts can focus on the mathematical correctness of their algorithms and security reviews are only needed when the pipeline itself changes. This decoupling is important because statistical models usually change more quickly than pipeline frameworks. Model details are often tweaked in response to discoveries about the data and models frequently need to be refreshed with new training samples.","title":"Separation of Concerns"},{"location":"pfa/#flexibility-and-safety","text":"Traditionally, scoring engines have been deployed in one of two ways: as a table of model parameters or as custom code. A table of parameters needs to be interpreted before it can classify or predict anything, so it implicitly comes with a fixed executable, usually the statistical package that produced it. The problem with a table of parameters is that it is inflexible: its associated executable can only perform the operation it was designed to do. The problem with custom code is that it is too powerful, as explained in the previous section. The Predictive Model Markup Language (PMML) was an attempt to bridge this gap by standardizing several of the most common kinds of scoring engines. Like PFA, PMML documents are intermediate text files (XML) produced by data analysis tools and consumed by an executable in the production environment. New functionality has been added to PMML over the past 17 years, but it is still based on tables of model parameters. Even a modest extension of a scoring engine requires a new version of PMML to be adopted, which can take years. PFA serves this purpose with far more generality. Unlike PMML, PFA has control structures to direct program flow, a true type system for both model parameters and data, and its statistical functions are much more finely grained and can accept callbacks to modify their behavior. The author of a PFA document can construct new types of models from building blocks without waiting for the new model to be explicitly added to the specification. PFA is more flexible than PMML, but safer than custom code. In the language of optimizations, it is the most flexible way to describe a scoring engine subject to the constraint that it won\u2019t break the data pipeline.","title":"Flexibility and Safety"},{"location":"pfa/#overview-of-pfa-capabilities","text":"The following contribute to PFA's flexibility : It has control structures, such as conditionals, loops, and user-defined functions (like a typical programming language). It is entirely expressed within JSON, and can therefore be easily generated and manipulated by other programs. This is important because PFA documents are usually generated from training data by a statistical package or a machine learning algorithm. Its library of functions is finely grained: multi-step processes are defined by chaining multiple functions. A user with a new type of model in mind can mix and match these library functions as needed. Many library functions accept callbacks to further modify their behavior. Scoring engines can share data or update external variables, such as entries in a database. The following contribute to PFA's safety : It has strict numerical compatibility: the same PFA document and the same input results in the same output, regardless of platform. The specification only defines functions that transform data. All inputs and outputs are controlled by the host system. It has a type system that can be statically checked. Specifically, PFA types are Avro types (Avro is a data serialization format used to move data in several popular pipeline frameworks). This system has a type-safe null and PFA only performs type-safe casting, which ensure that missing data never cause run-time errors. The callbacks that generalize PFA\u2019s statistical models are not first-class functions. This means that the set of functions that a PFA document might call can be predicted before it runs. A PFA host may choose to only allow certain functions. The semantics of shared data guarantee that data are never corrupted by concurrent access and scoring engines do not enter deadlock. The host can also statically determine which shared variables may be modified by a scoring engine, rather than at run-time. To learn more, read the tutorials (which have interactive examples, so that you can see PFA in action) or the complete reference, which are linked in the sidebar or at the top of this page. Source Data Mining Group Website","title":"Overview of PFA capabilities"},{"location":"pfa/cell-pool-structure/","text":"Cells and pools are both persistent storage, but cells are global variables that cannot be created or destroyed at runtime (only reassigned) and pools are like environments in R: collections of key-value pairs that can be created and destroyed at runtime, and the granularity of concurrent access is at the level of a single pool item. Cells and pools are both specified as JSON objects with the same fields, though init is required for cells and not for pools. Name Default Constraints Description type required Avro type The type of the value in the cell or the type of a single pool item. init required for cells, {} for pools JSON matching type or string If source is embedded, the contents are the initial value of the cell or pool. Otherwise, the contents are a string URL pointing to a resource containing the initial value. shared false boolean If true, all scoring engines derived from this PFA file share a common, consistent value in the cell or pool. rollback false boolean If true, the value in the cell or pool reverts to the value it had at the beginning of an action when an action raises an exception. Incompatible with shared. source \"embedded\" \"embedded\" , \"json\" , or \"avro\" If \"embedded\", the initial value is located within this PFA file (in init). Otherwise, init is a URL pointing to the data (including \"file://\" prefix for local files) with \"json\" or \"avro\" format. Example 1 \u00b6 The following is repeated from example 2 above: a global variable that stores an array of strings. The initial value is [] , but it could also be [\"one\", \"two\", \"three\"] . 1 2 \"cells\" : { \"accumulate\" : { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"init\" : []}} Example 2 \u00b6 Pool types are implicitly maps\u2014 the following maps a counter name to an integer. Counters can be created or destroyed at runtime. 1 \"pools\" : { \"counters\" : { \"type\" : \"int\" , \"shared\" : \"true\" }} Source Data Mining Group Website","title":"Cell and pool structure"},{"location":"pfa/cell-pool-structure/#example-1","text":"The following is repeated from example 2 above: a global variable that stores an array of strings. The initial value is [] , but it could also be [\"one\", \"two\", \"three\"] . 1 2 \"cells\" : { \"accumulate\" : { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"init\" : []}}","title":"Example 1"},{"location":"pfa/cell-pool-structure/#example-2","text":"Pool types are implicitly maps\u2014 the following maps a counter name to an integer. Counters can be created or destroyed at runtime. 1 \"pools\" : { \"counters\" : { \"type\" : \"int\" , \"shared\" : \"true\" }} Source Data Mining Group Website","title":"Example 2"},{"location":"pfa/document-structure/","text":"A PFA document is a JSON document with additional constraints. The JSON content describes algorithms, data types, model parameters, and other aspects of the scoring engine. Some structures have no effect on the scoring procedure and are only intended for archival purposes. The outermost structure of a PFA document is a JSON object, a collection of key-value pairs surrounded by curly brackets. We refer to these as the top-level fields: the field name (key) determines the allowed content (value). Some of those contents are recursively defined, so a PFA document may have arbitrary depth. The following are all of the allowed top-level fields. Name Default Constraints Description input required Avro type Input data type. Input data that do not conform to this schema should be rejected before sending it to PFA. output required Avro type Output data type. A valid PFA file will always produce data of this type (or an exception). begin [] expressions Algorithm to be executed before evaluating any data. See tutorial. action required expressions Algorithm to be executed for each input datum. See tutorial. end [] expressions Algorithm to be executed after evaluating all data (if such a time exists). See tutorial. fcns JSON object of functions Named user-defined functions that can be called in any expression (including other functions). cells JSON object of cells Persistent storage containing model parameters, intermediate results, etc. See tutorial. pools JSON object of pools Like cells, but items can be created and destroyed at runtime and concurrent access extends only to a pool item, not the entire pool. See tutorial. method \"map\" \"map\", \"emit\", or \"fold\" How results from the scoring engine will be served to the environment. See tutorial. zero required when method is \"fold\" JSON matching type output The starting value for a \"fold\" tally. See tutorial. merge required when method is \"fold\" expressions Algorithm to combine two partial tallies. randseed optional integer Global seed used to generate all random numbers. Multiple scoring engines derived from the same PFA file have different seeds generated from the global one. name none name An optional name for the scoring engine. version optional integer Sequential version number for the model. doc optional string Documentation string for archival purposes. metadata JSON object of strings Computer-readable documentation for archival purposes. options JSON object; value types depend on option name Initialization or runtime options to customize implementation (e.g. optimization switches). May be overridden or ignored by PFA consumer. Example 1 \u00b6 The smallest possible PFA document (by number of bytes) is 1 2 3 4 5 { \"input\" : \"int\" , \"output\" : \"int\" , \"action\" : \"input\" } It returns the integer you provide it. Example 2 \u00b6 The following example uses every kind of top-level field except pools, zero, and merge (which are similar to other fields and/or are only applicable to \u201cfold\u201d engines). 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 { \"input\" : \"string\" , \"output\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"cells\" : { \"accumulate\" : { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"init\" : [] } }, \"method\" : \"map\" , \"begin\" : { \"log\" : { \"rand.gaussian\" : [ 0.0 , 1.0 ]} }, \"action\" : { \"cell\" : \"accumulate\" , \"to\" : { \"fcn\" : \"u.addone\" , \"fill\" : { \"newitem\" : \"input\" }} }, \"end\" : { \"log\" : { \"rand.choice\" : { \"cell\" : \"accumulate\" }} }, \"fcns\" : { \"addone\" : { \"params\" : [ { \"old\" : { \"type\" : \"array\" , \"items\" : \"string\" }}, { \"newitem\" : \"string\" } ], \"ret\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"do\" : { \"a.append\" : [ \"old\" , \"newitem\" ]} } }, \"randseed\" : 12345 , \"name\" : \"ExampleScoringEngine\" , \"version\" : 1 , \"doc\" : \"Doesn't do much.\" , \"metadata\" : { \"does\" : \"notmuch\" }, \"options\" : { \"timeout\" : 1000 } } Source Data Mining Group Website","title":"Format of a PFA document"},{"location":"pfa/document-structure/#example-1","text":"The smallest possible PFA document (by number of bytes) is 1 2 3 4 5 { \"input\" : \"int\" , \"output\" : \"int\" , \"action\" : \"input\" } It returns the integer you provide it.","title":"Example 1"},{"location":"pfa/document-structure/#example-2","text":"The following example uses every kind of top-level field except pools, zero, and merge (which are similar to other fields and/or are only applicable to \u201cfold\u201d engines). 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 { \"input\" : \"string\" , \"output\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"cells\" : { \"accumulate\" : { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"init\" : [] } }, \"method\" : \"map\" , \"begin\" : { \"log\" : { \"rand.gaussian\" : [ 0.0 , 1.0 ]} }, \"action\" : { \"cell\" : \"accumulate\" , \"to\" : { \"fcn\" : \"u.addone\" , \"fill\" : { \"newitem\" : \"input\" }} }, \"end\" : { \"log\" : { \"rand.choice\" : { \"cell\" : \"accumulate\" }} }, \"fcns\" : { \"addone\" : { \"params\" : [ { \"old\" : { \"type\" : \"array\" , \"items\" : \"string\" }}, { \"newitem\" : \"string\" } ], \"ret\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"do\" : { \"a.append\" : [ \"old\" , \"newitem\" ]} } }, \"randseed\" : 12345 , \"name\" : \"ExampleScoringEngine\" , \"version\" : 1 , \"doc\" : \"Doesn't do much.\" , \"metadata\" : { \"does\" : \"notmuch\" }, \"options\" : { \"timeout\" : 1000 } } Source Data Mining Group Website","title":"Example 2"},{"location":"pfa/expressions/","text":"Expressions are the closest constructs PFA has to \"code\". They are evaluated in the context of predefined variables and most return a value. There are four fundamental types of expressions: literal values (constants) symbol references (variables) special forms (language constructs like if and while ) function calls (including operators like + and - ) Every top-level field that can take a single expression can take a JSON array of expressions\u2014 the return value is the last expression in the array. Example Expressions All of the following expressions return the number 3. 1 3 1 { \"+\" : [ 2 , 1 ]} 1 { \"+\" : [{ \"+\" : [ 1 , 1 ]}, 1 ]} 1 2 3 4 [{ \"let\" : { \"x\" : 0 }}, { \"set\" : { \"x\" : { \"+\" : [ \"x\" , 1 ]}}}, { \"set\" : { \"x\" : { \"+\" : [ \"x\" , 1 ]}}}, { \"x\" : { \"+\" : [ \"x\" , 1 ]}}] Literal values \u00b6 The following are all possible forms of literal values: JSON form Examples Description null null Only value of type \u201cnull\u201d. boolean true , false Only values of type \u201cboolean\u201d. integer 3 , -3 Easy way to express integers. floating-point number 3.0 , -3.14 , 1e8 Easy way to express double-precision numbers. bracketed string [\"hello\"] Easy way to express a string, but it can only be used in contexts where a JSON array of expressions is illegal (otherwise, hello would be interpreted as a variable name in a single-expression array). singleton JSON object {\"int\": 3} Explicit declaration of type. {\"long\": 3} {\"float\": 3} {\"double\": 3} {\"string\": \"hello\"} More explicit than [\"hello\"] and therefore less prone to error. {\"base64\": \"aGVsbG8=\"} Base-64 may be a more convenient way to express binary sequences. type-value special form {\"type\": \"int\", \"value\": 3} Any Avro type can be used in the \"type\" field; works for arrays, maps, records, unions, etc. The type-value special form may be used as an alternative to base-64 for binary sequences, since the JSON value of a bytes type is a raw string: {\"type\": \"bytes\", \"value\": \"hello\"} versus {\"base64\": \"aGVsbG8=\"} Symbol references \u00b6 A JSON string in a context where an expression is expected is always interpreted as a symbol reference. Example \u00b6 In the following, \"input\" is a variable and \"hello\" is a string. {\"s.concat\": [\"input\", {\"string\": \"hello\"}]} or {\"s.concat\": [\"input\", [\"hello\"]]} Special forms \u00b6 Special forms are JSON objects with specified structure. Each special form is unique: see the special forms page for details. Function calls \u00b6 Function calls have the following forms for zero arguments, one argument, and more than one arguments. {\"function.name\": []} or {\"function.name\": \"argument\"} or {\"function.name\": [\"arg1\", \"arg2\", \"arg3\"]} Library functions are built into PFA and user-defined functions are declared in the fcns section of a PFA document. See the function library for a list of all predefined functions. In the fcns section, user-defined functions must be declared with names that have no dots ( . ), but when they are called, they are always prepended by u. to avoid collisions with library functions. Example \u00b6 A function declared as 1 2 3 4 5 6 7 8 9 10 \"fcns\" : { \"addone\" : { \"params\" : [ { \"old\" : { \"type\" : \"array\" , \"items\" : \"string\" }}, { \"newitem\" : \"string\" } ], \"ret\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"do\" : { \"a.append\" : [ \"old\" , \"newitem\" ]} } } would be accessed as {\"u.addone\": [\"oldarray\", \"newitem\"]} Source Data Mining Group Website","title":"Expressions"},{"location":"pfa/expressions/#literal-values","text":"The following are all possible forms of literal values: JSON form Examples Description null null Only value of type \u201cnull\u201d. boolean true , false Only values of type \u201cboolean\u201d. integer 3 , -3 Easy way to express integers. floating-point number 3.0 , -3.14 , 1e8 Easy way to express double-precision numbers. bracketed string [\"hello\"] Easy way to express a string, but it can only be used in contexts where a JSON array of expressions is illegal (otherwise, hello would be interpreted as a variable name in a single-expression array). singleton JSON object {\"int\": 3} Explicit declaration of type. {\"long\": 3} {\"float\": 3} {\"double\": 3} {\"string\": \"hello\"} More explicit than [\"hello\"] and therefore less prone to error. {\"base64\": \"aGVsbG8=\"} Base-64 may be a more convenient way to express binary sequences. type-value special form {\"type\": \"int\", \"value\": 3} Any Avro type can be used in the \"type\" field; works for arrays, maps, records, unions, etc. The type-value special form may be used as an alternative to base-64 for binary sequences, since the JSON value of a bytes type is a raw string: {\"type\": \"bytes\", \"value\": \"hello\"} versus {\"base64\": \"aGVsbG8=\"}","title":"Literal values"},{"location":"pfa/expressions/#symbol-references","text":"A JSON string in a context where an expression is expected is always interpreted as a symbol reference.","title":"Symbol references"},{"location":"pfa/expressions/#example","text":"In the following, \"input\" is a variable and \"hello\" is a string. {\"s.concat\": [\"input\", {\"string\": \"hello\"}]} or {\"s.concat\": [\"input\", [\"hello\"]]}","title":"Example"},{"location":"pfa/expressions/#special-forms","text":"Special forms are JSON objects with specified structure. Each special form is unique: see the special forms page for details.","title":"Special forms"},{"location":"pfa/expressions/#function-calls","text":"Function calls have the following forms for zero arguments, one argument, and more than one arguments. {\"function.name\": []} or {\"function.name\": \"argument\"} or {\"function.name\": [\"arg1\", \"arg2\", \"arg3\"]} Library functions are built into PFA and user-defined functions are declared in the fcns section of a PFA document. See the function library for a list of all predefined functions. In the fcns section, user-defined functions must be declared with names that have no dots ( . ), but when they are called, they are always prepended by u. to avoid collisions with library functions.","title":"Function calls"},{"location":"pfa/expressions/#example_1","text":"A function declared as 1 2 3 4 5 6 7 8 9 10 \"fcns\" : { \"addone\" : { \"params\" : [ { \"old\" : { \"type\" : \"array\" , \"items\" : \"string\" }}, { \"newitem\" : \"string\" } ], \"ret\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"do\" : { \"a.append\" : [ \"old\" , \"newitem\" ]} } } would be accessed as {\"u.addone\": [\"oldarray\", \"newitem\"]} Source Data Mining Group Website","title":"Example"},{"location":"pfa/locator-marks/","text":"Any JSON object in a PFA document may include \"@\" as a string-valued field. This string is used to provide a line number from the original source file so that errors can be traced back to their source. Consumers may read the PFA file progressively (interpreting it while reading it), so the \"@\" field is only useful if it comes first in the JSON object. Example \u00b6 A function call with locator marks. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"@\" : \"PrettyPFA line 1\" , \"a.append\" : [ { \"@\" : \"PrettyPFA line 2\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [] }, { \"@\" : \"PrettyPFA line 3\" , \"string\" : \"mytext\" } ] } Source Data Mining Group Website","title":"Locator marks"},{"location":"pfa/locator-marks/#example","text":"A function call with locator marks. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"@\" : \"PrettyPFA line 1\" , \"a.append\" : [ { \"@\" : \"PrettyPFA line 2\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [] }, { \"@\" : \"PrettyPFA line 3\" , \"string\" : \"mytext\" } ] } Source Data Mining Group Website","title":"Example"},{"location":"pfa/names/","text":"Following Avro convention, names of PFA identifiers start with [A-Za-z_] subsequently contain only [A-Za-z0-9_] Source Data Mining Group Website","title":"Names"},{"location":"pfa/what-is-pfa/","text":"PFA is not: PFA is: A data pipeline framework, like Hadoop or Spark. A specification for data analytics, the math that gets computed in Hadoop or Spark (or other frameworks). A math library, like Apache Commons Math or Numpy. A specification for expressing mathematical algorithms, which an implementation like Commons Math or Numpy can perform in response to a PFA-formatted request. A graphical math formatting language, like LaTeX or MathML. PFA is unconcerned with presenting math visually, only computing it. A general-purpose programming language, like Java or Python. A file format for expressing algorithms that might have been written in Java or Python and then converted to PFA. Whereas human-oriented languages like Java or Python have a complex syntax and provide almost total control over a computer, including access to operating system calls, the file system, network ports, etc., PFA's syntax is a subset of JSON and it only provides the ability to do math. The external system must feed data into PFA and interpret the results that come out. PFA provides separation between control system code (written in a general-purpose programming language) and mathematical algorithms, so that the mathematical algorithms can be tested and versioned more rapidly than the whole system. Virtual bytecode, like LLVM or JVM executables. While PFA is intended as an intermediate format for moving executable algorithms from one language or environment to another, it operates at a much higher level than bytecode. The names in JSON are human-readable and describe operations such as finding nearest clusters, walking through decision trees, and manipulating matrices. A data mining/machine learning toolkit, like R, Scikit-Learn, MLlib, Mahout, Breeze... Although PFA can be used to build models from training data (\"fit\" in R), its primary purpose is to apply fitted models (\"predict\" in R) in a formal or large-scale production. Typically, one would use a data mining/machine learning toolkit to train a model, then convert it to PFA to get it into production. The production environment is usually more restricted than the development environment, since it is capable of performing business actions and must therefore be secure. Some of these models might update internal state while performing their calculations, which is not completely distinct from training, so PFA has this ability and defines rules for distributed model updates. PMML, the Predictive Model Markup Language PFA's purpose is similar to PMML's, namely to provide an interchange format for data mining models (and other mathematical algorithms), but there are several structural differences. PMML is XML and PFA is JSON. PMML defines several high-level model types , each with a suite of common options, whereas PFA defines hundreds of data mining primitives that can be combined in arbitrarily complex ways. PFA has a well-defined type system , including arrays, maps, records, and tagged unions, whereas PMML operates on a flat table of numeric and string primitives. Source Hadrian Wiki","title":"What is PFA?"},{"location":"pfa/why-do-we-need-pfa/","text":"Suppose you're a data scientist, working on a difficult analysis. You've been struggling with conventional data mining algorithms for weeks and suddenly have a breakthrough using Professor Hess's Gradient-Boosted Deep Learning Monte Carlo Adaptive Regularization Toolkit (GraBooDeLearnMicArt). Your amazingly accurate model could do a lot of good for your company, but its servers only run Java, and GraBooDeLearnMicArt is an R package. You try to get your company to install an R-Java bridge, but they won't because they say it's a security hazard. They also say that GraBooDeLearnMicArt has seemingly unnecessary dependencies. The prospect of reimplementing it in Java is grim. However, GraBooDeLearnMicArt's \"predict\" method isn't too complicated, only a mild variation on matrix multiplication and decision trees. You work with a Java developer to reimplement \"predict,\" but after it's working, you realize you forgot a pre-processing step and have to change the code. A few weeks later, you decide to smooth the outputs. Of course, you'll be refreshing the models every month. The Java developer stops answering your calls. Suppose you're a data engineer, trying to keep a thousand-node cluster healthy. Data scientists are constantly asking you why their jobs won't run, why they don't have permission to install random packages, when they can update their recommendation engines, etc. The code running on this cluster affects real things: monetary transactions, customer interactions, third-party corporate clients, perhaps even industrial machinery. It has to work. Suddenly, somebody wants to install a hundred dependencies across the whole cluster to run some academic software with a long name. It side-steps Java's security model with compiled C code. Even trusting that the professor who wrote it is not deliberately malicious, it introduces the possibility of C array overflows that could be exploited through the web portal, potentially letting a hacker bring the whole system down, or worse. You say no. In a hurried attempt to port the code, mistakes are made and the analyst is always wanting to change things. Even if you asked them to write it themselves, they would still have to pass code reviews and coordinate with the version schedule, like any other software developer. Here's how PFA helps. Suppose that the backend team installs a PFA implementation, such as Hadrian (Java). They wire this into the data pipeline as a black box: it makes predictions, recommendations, or actions based on some calculation in PFA. The data science team installs PFA development kits, such as Titus (Python) or Aurelius (R). They produce models using whatever tools they want and use the PFA kit to convert these trained models into PFA. If they're lucky, the PFA kit knows about their tool and already has a conversion function. If not, they write the conversion themselves and add it to the library. The PFA is a JSON file with a lot of model parameters and a little code. The code cannot break out of its sandbox because the necessary functions aren't even a part of the language. The data science team sends this to engineering in a formal way (e.g. database) and the PFA scoring engine can be plugged into the black box immediately. It won't cause any other system to fail to compile, run properly, or open security holes. Before trusting the new model to perform actions, some review is necessary. However, that review can focus exclusively on its mathematical properties. Does it optimize sales? Does it improve manufacturing efficiency? These things could even be demonstrated with a champion-challenger system that applies the new PFA to live data in the real production system. Control code and mathematical analyses are now decoupled. They can progress according to their own schedules. Source Hadrian Wiki","title":"Why do we need it?"},{"location":"special-forms/","text":"PFA has four types of expressions : literal values, symbol references, function calls, and special forms. Special forms could be thought of as function calls with irregular constraints on their arguments and return values. The analogy in ordinary programming languages would be keywords like if and while . Special forms are all represented by JSON objects with one or more key-value pairs. Other than that, they are all unique. Source Data Mining Group Website","title":"Overview"},{"location":"special-forms/arrays-maps-records/","text":"Retrieving nested values (attr) \u00b6 Arrays, maps, and records of arbitrary depth have a unified dereferencing special form. It can extract substructures of arbitrary depth in one pass, so that the equivalent of x.y[2].z[\"hello\"][4] is a one form, not five. Its structure is: {\"attr\": EXPRESSION, \"path\": [INDEX1, INDEX2, ...]} where EXPRESSION is an expression and the INDEX are one or more expressions. At each level, if the substructure is an array, the corresponding INDEX must resolve to \"int\" type, if it is a map, the INDEX must resolve to \"string\" type, and if it is a record, the INDEX must be a literal string. Arrays are zero-indexed, so 0 is the first element. Variables that contain dots are a shortcut for record dereference. That is, a string with a form like: \"FIRST.SECOND.THIRD\" gets expanded as {\"attr\": \"FIRST\", \"path\": [{\"string\": \"SECOND\"}, {\"string\": \"THIRD\"}]} Example \u00b6 The x.y[2].z[\"hello\"][4] example would look like the following in PFA: 1 2 3 4 5 6 7 { \"attr\" : \"x\" , \"path\" : [ { \"string\" : \"y\" }, 2 , { \"string\" : \"z\" }, { \"s.lower\" : \"HELLO\" }, { \"+\" : [ 2 , 2 ]} ]} First, x (a record) is dereferenced to extract field y (an array), which is dereferenced to extract item 2 (a record), which is dereferenced to extract field z (a map), which is dereferenced to extract key \"hello\" (an array), which is dereferenced to extract item 4 . The same could be done in stages: 1 2 3 4 5 6 7 8 9 10 { \"attr\" : { \"attr\" : { \"attr\" : { \"attr\" : { \"attr\" : \"x\" , \"path\" : [{ \"string\" : \"y\" }]}, \"path\" : [ 2 ]}, \"path\" : [{ \"string\" : \"z\" }]}, \"path\" : [{ \"s.lower\" : \"HELLO\" }]}, \"path\" : [{ \"+\" : [ 2 , 2 ]}]} The dot shortcut can only be used to simplify the innermost {\"attr\": \"x\", \"path\": [{\"string\": \"y\"}]} to \"x.y\" Creating a copy with different nested values (attr-to) \u00b6 A similar structure can be used to \"modify\" substructure. By \"modify', we mean create a copy with that substructure altered. {\"attr\": EXPRESSION, \"path\": [INDEX1, INDEX2, ...], \"to\": VALUE-OR-FUNCTION} where EXPRESSION is an expression and the INDEX are one or more expressions. As above, the types of the INDEX must match the corresponding substructures. The VALUE-OR-FUNCTION could be an expression with the right type to replace the substructure or it could be a function from that type to that type. If a function, the original value is passed to the function and the result of the function is taken to be the replacement. Example \u00b6 Both of the following update a counter, but the first accesses it twice. 1 2 3 4 5 6 7 { \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ], \"to\" : { \"+\" : [{ \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ]}, 1 ]}} { \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ], \"to\" : { \"params\" : [{ \"old\" : \"int\" }], \"ret\" : \"int\" , \"do\" : { \"+\" : [ \"old\" , 1 ]}}} Source Data Mining Group Website","title":"Extracting from and updating arrays, maps, and records"},{"location":"special-forms/arrays-maps-records/#retrieving-nested-values-attr","text":"Arrays, maps, and records of arbitrary depth have a unified dereferencing special form. It can extract substructures of arbitrary depth in one pass, so that the equivalent of x.y[2].z[\"hello\"][4] is a one form, not five. Its structure is: {\"attr\": EXPRESSION, \"path\": [INDEX1, INDEX2, ...]} where EXPRESSION is an expression and the INDEX are one or more expressions. At each level, if the substructure is an array, the corresponding INDEX must resolve to \"int\" type, if it is a map, the INDEX must resolve to \"string\" type, and if it is a record, the INDEX must be a literal string. Arrays are zero-indexed, so 0 is the first element. Variables that contain dots are a shortcut for record dereference. That is, a string with a form like: \"FIRST.SECOND.THIRD\" gets expanded as {\"attr\": \"FIRST\", \"path\": [{\"string\": \"SECOND\"}, {\"string\": \"THIRD\"}]}","title":"Retrieving nested values (attr)"},{"location":"special-forms/arrays-maps-records/#example","text":"The x.y[2].z[\"hello\"][4] example would look like the following in PFA: 1 2 3 4 5 6 7 { \"attr\" : \"x\" , \"path\" : [ { \"string\" : \"y\" }, 2 , { \"string\" : \"z\" }, { \"s.lower\" : \"HELLO\" }, { \"+\" : [ 2 , 2 ]} ]} First, x (a record) is dereferenced to extract field y (an array), which is dereferenced to extract item 2 (a record), which is dereferenced to extract field z (a map), which is dereferenced to extract key \"hello\" (an array), which is dereferenced to extract item 4 . The same could be done in stages: 1 2 3 4 5 6 7 8 9 10 { \"attr\" : { \"attr\" : { \"attr\" : { \"attr\" : { \"attr\" : \"x\" , \"path\" : [{ \"string\" : \"y\" }]}, \"path\" : [ 2 ]}, \"path\" : [{ \"string\" : \"z\" }]}, \"path\" : [{ \"s.lower\" : \"HELLO\" }]}, \"path\" : [{ \"+\" : [ 2 , 2 ]}]} The dot shortcut can only be used to simplify the innermost {\"attr\": \"x\", \"path\": [{\"string\": \"y\"}]} to \"x.y\"","title":"Example"},{"location":"special-forms/arrays-maps-records/#creating-a-copy-with-different-nested-values-attr-to","text":"A similar structure can be used to \"modify\" substructure. By \"modify', we mean create a copy with that substructure altered. {\"attr\": EXPRESSION, \"path\": [INDEX1, INDEX2, ...], \"to\": VALUE-OR-FUNCTION} where EXPRESSION is an expression and the INDEX are one or more expressions. As above, the types of the INDEX must match the corresponding substructures. The VALUE-OR-FUNCTION could be an expression with the right type to replace the substructure or it could be a function from that type to that type. If a function, the original value is passed to the function and the result of the function is taken to be the replacement.","title":"Creating a copy with different nested values (attr-to)"},{"location":"special-forms/arrays-maps-records/#example_1","text":"Both of the following update a counter, but the first accesses it twice. 1 2 3 4 5 6 7 { \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ], \"to\" : { \"+\" : [{ \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ]}, 1 ]}} { \"attr\" : \"counters\" , \"path\" : [ \"whichCounter\" ], \"to\" : { \"params\" : [{ \"old\" : \"int\" }], \"ret\" : \"int\" , \"do\" : { \"+\" : [ \"old\" , 1 ]}}} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/call-functions/","text":"Ordinary function call \u00b6 The majority of functionality in PFA is provided through functions with regular parameter lists, signatures that can be described in terms of Avro types, wildcards, and function references. An ordinary function call has the following structure: {FUNCTION-NAME: [EXPR1, EXPR2, ...]} where FUNCTION-NAME is the name of the function and EXPR are zero or more expressions. The number of expressions and their types are determined by the function's signature. User-defined functions always start with \"u.\" (even though they are declared in the \"fcns\" section without the \"u.\" ). Ordinary function calls are expressions and always return an Avro-typed value, even if that value is null . Example \u00b6 The following illustrate zero-argument, one-argument, and multi-argument function calls. {\"m.pi\": []} {\"m.exp\": \"x\"} {\"m.exp\": [\"x\"]} {\"m.special.nChooseK\": [\"n\", \"k\"]} Call a user-defined function that is specified at runtime \u00b6 Ordinary function calls fix the choice of function while a scoring engine is being built\u2014 there is no ability to change it at runtime. This is good because a PFA file can be statically analyzed to determine which functions can be accessed from a given scope (used to exclude the possibility of deadlock in concurrent transactions, for instance), but there are cases when you want this flexibility. For instance, when you describe a ruleset as a data structure, you might want to associate actions with each rule in the data structure (e.g. in a cell's \"init\" ) rather than in the code (e.g. in an if-then block in the code). The actions are defined as named functions in the \"fcns\" section, but we need to pick the function to run at runtime. The following structure provides that ability: {\"call\": ENUM-EXPRESSION, \"args\": [EXPR1, EXPR2, ...]} The ENUM-EXPRESSION is an expression that evaluates to an enumeration type whose symbols are all names of user-defined functions (without the \"u.\" prefix). The EXPR expressions are all supplied arguments. The set of user-defined functions that could be called must all have signatures that accept the arguments: they must be drop-in replacements for one another. When the static analysis encounters this structure, it reports that any of the user-defined functions in the set could be called. Example \u00b6 Here is a PFA document that shows a complete example of a model that performs different actions based on the closest cluster. The important point is that the choice of action is bundled in the model parameters. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 { \"input\" : { \"type\" : \"array\" , \"items\" : \"double\" }, \"output\" : \"double\" , \"cells\" : { \"clusters\" : { \"type\" : { \"type\" : \"array\" , \"items\" : { \"type\" : \"record\" , \"name\" : \"Rule\" , \"fields\" : [ { \"name\" : \"center\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"double\" }}, { \"name\" : \"act\" , \"type\" : { \"type\" : \"enum\" , \"name\" : \"Action\" , \"symbols\" : [ \"add\" , \"sub\" , \"mul\" , \"div\" ]}}, { \"name\" : \"param\" , \"type\" : \"double\" } ]}}, \"init\" : [ { \"center\" : [ 0 , 0 , 0 ], \"act\" : \"add\" , \"param\" : 1.0 }, { \"center\" : [ 1 , 0 , 0 ], \"act\" : \"add\" , \"param\" : 2.0 }, { \"center\" : [ 0 , 1 , 0 ], \"act\" : \"sub\" , \"param\" : 3.0 }, { \"center\" : [ 0 , 0 , 1 ], \"act\" : \"sub\" , \"param\" : 4.0 }, { \"center\" : [ 1 , 1 , 0 ], \"act\" : \"mul\" , \"param\" : 5.0 }, { \"center\" : [ 1 , 0 , 1 ], \"act\" : \"mul\" , \"param\" : 6.0 }, { \"center\" : [ 0 , 1 , 1 ], \"act\" : \"div\" , \"param\" : 7.0 }, { \"center\" : [ 1 , 1 , 1 ], \"act\" : \"div\" , \"param\" : 8.0 } ]}}, \"action\" : [ { \"let\" : { \"x\" : { \"attr\" : \"input\" , \"path\" : [ 0 ]}, \"c\" : { \"model.cluster.closest\" : [ \"input\" , { \"cell\" : \"clusters\" }]}}}, { \"call\" : \"c.act\" , \"args\" : [ \"x\" , \"c.param\" ]} ], \"fcns\" : { \"add\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"+\" : [ \"x\" , \"y\" ]}}, \"sub\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"-\" : [ \"x\" , \"y\" ]}}, \"mul\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"*\" : [ \"x\" , \"y\" ]}}, \"div\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"/\" : [ \"x\" , \"y\" ]}}} } Source Data Mining Group Website","title":"Forms that call functions"},{"location":"special-forms/call-functions/#ordinary-function-call","text":"The majority of functionality in PFA is provided through functions with regular parameter lists, signatures that can be described in terms of Avro types, wildcards, and function references. An ordinary function call has the following structure: {FUNCTION-NAME: [EXPR1, EXPR2, ...]} where FUNCTION-NAME is the name of the function and EXPR are zero or more expressions. The number of expressions and their types are determined by the function's signature. User-defined functions always start with \"u.\" (even though they are declared in the \"fcns\" section without the \"u.\" ). Ordinary function calls are expressions and always return an Avro-typed value, even if that value is null .","title":"Ordinary function call"},{"location":"special-forms/call-functions/#example","text":"The following illustrate zero-argument, one-argument, and multi-argument function calls. {\"m.pi\": []} {\"m.exp\": \"x\"} {\"m.exp\": [\"x\"]} {\"m.special.nChooseK\": [\"n\", \"k\"]}","title":"Example"},{"location":"special-forms/call-functions/#call-a-user-defined-function-that-is-specified-at-runtime","text":"Ordinary function calls fix the choice of function while a scoring engine is being built\u2014 there is no ability to change it at runtime. This is good because a PFA file can be statically analyzed to determine which functions can be accessed from a given scope (used to exclude the possibility of deadlock in concurrent transactions, for instance), but there are cases when you want this flexibility. For instance, when you describe a ruleset as a data structure, you might want to associate actions with each rule in the data structure (e.g. in a cell's \"init\" ) rather than in the code (e.g. in an if-then block in the code). The actions are defined as named functions in the \"fcns\" section, but we need to pick the function to run at runtime. The following structure provides that ability: {\"call\": ENUM-EXPRESSION, \"args\": [EXPR1, EXPR2, ...]} The ENUM-EXPRESSION is an expression that evaluates to an enumeration type whose symbols are all names of user-defined functions (without the \"u.\" prefix). The EXPR expressions are all supplied arguments. The set of user-defined functions that could be called must all have signatures that accept the arguments: they must be drop-in replacements for one another. When the static analysis encounters this structure, it reports that any of the user-defined functions in the set could be called.","title":"Call a user-defined function that is specified at runtime"},{"location":"special-forms/call-functions/#example_1","text":"Here is a PFA document that shows a complete example of a model that performs different actions based on the closest cluster. The important point is that the choice of action is bundled in the model parameters. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 { \"input\" : { \"type\" : \"array\" , \"items\" : \"double\" }, \"output\" : \"double\" , \"cells\" : { \"clusters\" : { \"type\" : { \"type\" : \"array\" , \"items\" : { \"type\" : \"record\" , \"name\" : \"Rule\" , \"fields\" : [ { \"name\" : \"center\" , \"type\" : { \"type\" : \"array\" , \"items\" : \"double\" }}, { \"name\" : \"act\" , \"type\" : { \"type\" : \"enum\" , \"name\" : \"Action\" , \"symbols\" : [ \"add\" , \"sub\" , \"mul\" , \"div\" ]}}, { \"name\" : \"param\" , \"type\" : \"double\" } ]}}, \"init\" : [ { \"center\" : [ 0 , 0 , 0 ], \"act\" : \"add\" , \"param\" : 1.0 }, { \"center\" : [ 1 , 0 , 0 ], \"act\" : \"add\" , \"param\" : 2.0 }, { \"center\" : [ 0 , 1 , 0 ], \"act\" : \"sub\" , \"param\" : 3.0 }, { \"center\" : [ 0 , 0 , 1 ], \"act\" : \"sub\" , \"param\" : 4.0 }, { \"center\" : [ 1 , 1 , 0 ], \"act\" : \"mul\" , \"param\" : 5.0 }, { \"center\" : [ 1 , 0 , 1 ], \"act\" : \"mul\" , \"param\" : 6.0 }, { \"center\" : [ 0 , 1 , 1 ], \"act\" : \"div\" , \"param\" : 7.0 }, { \"center\" : [ 1 , 1 , 1 ], \"act\" : \"div\" , \"param\" : 8.0 } ]}}, \"action\" : [ { \"let\" : { \"x\" : { \"attr\" : \"input\" , \"path\" : [ 0 ]}, \"c\" : { \"model.cluster.closest\" : [ \"input\" , { \"cell\" : \"clusters\" }]}}}, { \"call\" : \"c.act\" , \"args\" : [ \"x\" , \"c.param\" ]} ], \"fcns\" : { \"add\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"+\" : [ \"x\" , \"y\" ]}}, \"sub\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"-\" : [ \"x\" , \"y\" ]}}, \"mul\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"*\" : [ \"x\" , \"y\" ]}}, \"div\" : { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"/\" : [ \"x\" , \"y\" ]}}} } Source Data Mining Group Website","title":"Example"},{"location":"special-forms/cells-pools/","text":"The \"cell\", \"cell-to\", \"pool\", and \"pool-to\" special forms have nearly the same structure as \"attr\" and \"attr-to\", but they operate on global data (cells and pools). All access to global data must go through these special forms; there are no others. The path extraction and function updates have more relevance for global data, which may be remote and shared. If the data structure is large and remote, specifying the full path to the substructure of interest reduces the necessary network bandwidth, since only the substructure needs to be returned, not the whole second level of the object. If the data structure is shared, the update function defines a transaction in which one scoring engine gets an exclusive lock on the object, which is necessary for correct concurrency. Retrieving cell values (cell) \u00b6 Cells may be accessed with one of the following structures: {\"cell\": NAME} or {\"cell\": NAME, \"path\": [INDEX1, INDEX2, ...]} where NAME is a string, the name of the cell (not an expression). The INDEX are expressions that follow the same rules as for \u201cattr\u201d. Example \u00b6 Model parameters are often stored in cells. {\"model.cluster.closest\": [\"input\", {\"cell\": \"clusters\"}]} Changing cell values (cell-to) \u00b6 Cells may be updated with one of the following structures: {\"cell\": NAME, \"to\": VALUE-OR-FUNCTION} or {\"cell\": NAME, \"path\": [INDEX1, INDEX2, ...], \"to\": VALUE-OR-FUNCTION} where NAME is a string (as above) and VALUE-OR-FUNCTION is either a new value or an update function (as above). Unlike \"attr-to\", \"cell-to\" changes the value of the cell. Subsequent requests for the cell will see the new value. The return value of this form is the new cell value, which can be used to avoid a second request. Example \u00b6 Both of the following are intended to update a counter, but the first can lead to data corruption if the cell is shared. Another scoring engine that shares the cell might update the counter value before this one is finished. 1 { \"cell\" : \"counter\" , \"to\" : { \"+\" : [{ \"cell\" : \"counter\" }, 1 ]}} 1 2 3 4 { \"cell\" : \"counter\" , \"to\" : { \"params\" : [{ \"old\" : \"int\" }], \"ret\" : \"int\" , \"do\" : { \"+\" : [ \"old\" , 1 ]}}} Retrieving pool values (pool) \u00b6 Pools may be accessed with the following structure: {\"pool\": NAME, \"path\": [INDEX1, INDEX2, ...]} where NAME is a string, the name of the pool (not an expression). The INDEX are expressions that follow the same rules as for \"attr\". Example \u00b6 Segmented model parameters are often stored in pools. 1 2 3 4 { \"model.cluster.closest\" : [ \"input.vector\" , { \"pool\" : \"segmentsOfClusters\" , \"path\" : [ \"input.segment\" ]}]} Changing pool values (pool-to) \u00b6 Pool items may be updated with the following structure: 1 2 { \"pool\" : NAME , \"path\" : [ INDEX 1 , INDEX 2 , ... ], \"to\" : VALUE-OR-FUNCTION , \"init\" : VALUE } where NAME is a string (as above) and VALUE-OR-FUNCTION is either a new value or an update function (as above). The initialization VALUE is an expression, which is used if a particular pool item does not yet exist. Unlike \"attr-to\", \"pool-to\" changes the value of the pool item. Subsequent requests for that pool item will see the new value. The return value of this form is the new pool item (not the whole pool). Example \u00b6 The following updates a segmented exponentially weighted moving average (EWMA) or creates a new segment if one does not exist. 1 2 3 4 5 6 7 8 9 10 { \"pool\" : \"segmentedEWMAs\" , \"path\" : [ \"input.segment\" ], \"to\" : { \"params\" : [{ \"old\" : \"EWMARecord\" }], \"ret\" : \"EWMARecord\" , \"do\" : { \"stat.sample.updateEWMA\" : [ \"input.value\" , 0.1 , \"old\" ]}}, \"init\" : { \"type\" : \"EWMARecord\" , \"new\" : { \"mean\" : \"input.value\" }} } Removing pool values (pool-del) \u00b6 Pool items may be deleted with the following structure: {\"pool\": NAME, \"del\": EXPRESSION} where NAME is a string (as above) and EXPRESSION evaluates to the name of the pool item to delete. Its return type is \"null\" . Example \u00b6 The following deletes a segment from a segmented model. {\"pool\": \"segments\", \"del\": \"input.segmentToDelete\"} Source Data Mining Group Website","title":"Extracting from and updating cells and pools"},{"location":"special-forms/cells-pools/#retrieving-cell-values-cell","text":"Cells may be accessed with one of the following structures: {\"cell\": NAME} or {\"cell\": NAME, \"path\": [INDEX1, INDEX2, ...]} where NAME is a string, the name of the cell (not an expression). The INDEX are expressions that follow the same rules as for \u201cattr\u201d.","title":"Retrieving cell values (cell)"},{"location":"special-forms/cells-pools/#example","text":"Model parameters are often stored in cells. {\"model.cluster.closest\": [\"input\", {\"cell\": \"clusters\"}]}","title":"Example"},{"location":"special-forms/cells-pools/#changing-cell-values-cell-to","text":"Cells may be updated with one of the following structures: {\"cell\": NAME, \"to\": VALUE-OR-FUNCTION} or {\"cell\": NAME, \"path\": [INDEX1, INDEX2, ...], \"to\": VALUE-OR-FUNCTION} where NAME is a string (as above) and VALUE-OR-FUNCTION is either a new value or an update function (as above). Unlike \"attr-to\", \"cell-to\" changes the value of the cell. Subsequent requests for the cell will see the new value. The return value of this form is the new cell value, which can be used to avoid a second request.","title":"Changing cell values (cell-to)"},{"location":"special-forms/cells-pools/#example_1","text":"Both of the following are intended to update a counter, but the first can lead to data corruption if the cell is shared. Another scoring engine that shares the cell might update the counter value before this one is finished. 1 { \"cell\" : \"counter\" , \"to\" : { \"+\" : [{ \"cell\" : \"counter\" }, 1 ]}} 1 2 3 4 { \"cell\" : \"counter\" , \"to\" : { \"params\" : [{ \"old\" : \"int\" }], \"ret\" : \"int\" , \"do\" : { \"+\" : [ \"old\" , 1 ]}}}","title":"Example"},{"location":"special-forms/cells-pools/#retrieving-pool-values-pool","text":"Pools may be accessed with the following structure: {\"pool\": NAME, \"path\": [INDEX1, INDEX2, ...]} where NAME is a string, the name of the pool (not an expression). The INDEX are expressions that follow the same rules as for \"attr\".","title":"Retrieving pool values (pool)"},{"location":"special-forms/cells-pools/#example_2","text":"Segmented model parameters are often stored in pools. 1 2 3 4 { \"model.cluster.closest\" : [ \"input.vector\" , { \"pool\" : \"segmentsOfClusters\" , \"path\" : [ \"input.segment\" ]}]}","title":"Example"},{"location":"special-forms/cells-pools/#changing-pool-values-pool-to","text":"Pool items may be updated with the following structure: 1 2 { \"pool\" : NAME , \"path\" : [ INDEX 1 , INDEX 2 , ... ], \"to\" : VALUE-OR-FUNCTION , \"init\" : VALUE } where NAME is a string (as above) and VALUE-OR-FUNCTION is either a new value or an update function (as above). The initialization VALUE is an expression, which is used if a particular pool item does not yet exist. Unlike \"attr-to\", \"pool-to\" changes the value of the pool item. Subsequent requests for that pool item will see the new value. The return value of this form is the new pool item (not the whole pool).","title":"Changing pool values (pool-to)"},{"location":"special-forms/cells-pools/#example_3","text":"The following updates a segmented exponentially weighted moving average (EWMA) or creates a new segment if one does not exist. 1 2 3 4 5 6 7 8 9 10 { \"pool\" : \"segmentedEWMAs\" , \"path\" : [ \"input.segment\" ], \"to\" : { \"params\" : [{ \"old\" : \"EWMARecord\" }], \"ret\" : \"EWMARecord\" , \"do\" : { \"stat.sample.updateEWMA\" : [ \"input.value\" , 0.1 , \"old\" ]}}, \"init\" : { \"type\" : \"EWMARecord\" , \"new\" : { \"mean\" : \"input.value\" }} }","title":"Example"},{"location":"special-forms/cells-pools/#removing-pool-values-pool-del","text":"Pool items may be deleted with the following structure: {\"pool\": NAME, \"del\": EXPRESSION} where NAME is a string (as above) and EXPRESSION evaluates to the name of the pool item to delete. Its return type is \"null\" .","title":"Removing pool values (pool-del)"},{"location":"special-forms/cells-pools/#example_4","text":"The following deletes a segment from a segmented model. {\"pool\": \"segments\", \"del\": \"input.segmentToDelete\"} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/complex-objects/","text":"Simple values, like numbers and booleans, can be inserted directly into PFA as JSON numbers and booleans. Strings require annotation to be distinguished from variable names. Complex objects, such as arrays, maps, records, enumeration symbols, etc., additionally require a type specification. Even an empty array has an \"items\" data type to specify what could be inserted into the array. PFA has a general mechanism for making any type of object from embedded JSON whose value is known at \"compile-time\" (when the scoring engine is constructed). However, that does not allow you to create arrays, maps, or records from variables, so a second special form exists for that case. When constructing an array, map, or record whose value can be specified at compile-time, the embedded JSON method is preferable because more optimizations are possible (such as constructing exactly one copy of the object and referencing it). Common examples of this are empty arrays, empty maps, and initial value records. Creating compile-time constants from embedded JSON (type-value) \u00b6 To make any type of object from embedded JSON, use the following structure: {\"type\": TYPE, \"value\": JSON-VALUE} where TYPE is an Avro type and JSON-VALUE is a JSON representation of the object. This JSON-VALUE is not an expression, so variables and function calls can never appear in it. Example \u00b6 The following example illustrates the difference between this form and the \"new\" special form (below). 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [ \"one\" , \"two\" , \"three\" ]} creates an array of strings whose value is [\"one\", \"two\", \"three\"] . 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"new\" : [ \"one\" , \"two\" , \"three\" ]} creates an array of strings containing the contents of the variables one , two , and three . If one is \"1\" , two is \"2\" , and three is \"3\" , the result would be [\"1\", \"2\", \"3\"] . Creating arrays, maps, and records from runtime data (new) \u00b6 The \"new\" special form creates arrays, maps, and records, taking expressions, rather than embedded JSON values. The array form has the following structure: {\"type\": ARRAY-TYPE, \"new\": [EXPR1, EXPR2, ...]} where ARRAY-TYPE is an array Avro type and the EXPR are zero or more expressions whose types can be accepted by the array's \"items\" type. The map and record forms have the following structure: {\"type\": TYPE, \"new\": {KEY1: EXPR1, KEY2: EXPR2, ...}} where TYPE is a map or record Avro type, the KEY strings are keys for maps and field names for records, and the EXPR are expressions. For a record, all the fields of the record must be present. The types of the EXPR must be accepted by the map's \"values\" or the record\u2019s field types. Example \u00b6 This creates a record out of three expressions. 1 2 3 4 5 6 7 8 9 10 11 12 { \"type\" : { \"type\" : \"record\" , \"name\" : \"ExampleRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" } ]}, \"new\" : { \"one\" : 1 , \"two\" : { \"+\" : [ 2 , 0.2 ]}, \"three\" : { \"a.lower\" : \"THREE\" } }} Source Data Mining Group Website","title":"Creating complex objects"},{"location":"special-forms/complex-objects/#creating-compile-time-constants-from-embedded-json-type-value","text":"To make any type of object from embedded JSON, use the following structure: {\"type\": TYPE, \"value\": JSON-VALUE} where TYPE is an Avro type and JSON-VALUE is a JSON representation of the object. This JSON-VALUE is not an expression, so variables and function calls can never appear in it.","title":"Creating compile-time constants from embedded JSON (type-value)"},{"location":"special-forms/complex-objects/#example","text":"The following example illustrates the difference between this form and the \"new\" special form (below). 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"value\" : [ \"one\" , \"two\" , \"three\" ]} creates an array of strings whose value is [\"one\", \"two\", \"three\"] . 1 2 { \"type\" : { \"type\" : \"array\" , \"items\" : \"string\" }, \"new\" : [ \"one\" , \"two\" , \"three\" ]} creates an array of strings containing the contents of the variables one , two , and three . If one is \"1\" , two is \"2\" , and three is \"3\" , the result would be [\"1\", \"2\", \"3\"] .","title":"Example"},{"location":"special-forms/complex-objects/#creating-arrays-maps-and-records-from-runtime-data-new","text":"The \"new\" special form creates arrays, maps, and records, taking expressions, rather than embedded JSON values. The array form has the following structure: {\"type\": ARRAY-TYPE, \"new\": [EXPR1, EXPR2, ...]} where ARRAY-TYPE is an array Avro type and the EXPR are zero or more expressions whose types can be accepted by the array's \"items\" type. The map and record forms have the following structure: {\"type\": TYPE, \"new\": {KEY1: EXPR1, KEY2: EXPR2, ...}} where TYPE is a map or record Avro type, the KEY strings are keys for maps and field names for records, and the EXPR are expressions. For a record, all the fields of the record must be present. The types of the EXPR must be accepted by the map's \"values\" or the record\u2019s field types.","title":"Creating arrays, maps, and records from runtime data (new)"},{"location":"special-forms/complex-objects/#example_1","text":"This creates a record out of three expressions. 1 2 3 4 5 6 7 8 9 10 11 12 { \"type\" : { \"type\" : \"record\" , \"name\" : \"ExampleRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" } ]}, \"new\" : { \"one\" : 1 , \"two\" : { \"+\" : [ 2 , 0.2 ]}, \"three\" : { \"a.lower\" : \"THREE\" } }} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/control-structures/","text":"Mini-program (do) \u00b6 The \"do\" special form is for limiting scope in mini-programs. It is often used by automated code builders. The structure is: {\"do\": [EXPR1, EXPR2, ...]} where EXPR may be any expression and the return value is the value of the last expression. Example \u00b6 The intermediate variables in these blocks do not conflict. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"do\" : [ { \"do\" : [ { \"let\" : { \"x\" : 1 }}, { \"+\" : [ \"x\" , 1 ]}, ], { \"do\" : [ { \"let\" : { \"x\" : 2 }}, { \"+\" : [ \"x\" , 1 ]}, ], { \"do\" : [ { \"let\" : { \"x\" : 3 }}, { \"+\" : [ \"x\" , 1 ]}, ] } Conditional (if) \u00b6 PFA\u2019s \"if\" statement has two forms: 1 { \"if\" : CONDITION , \"then\" : EXPRESSION-OR-EXPRESSIONS } and 1 2 { \"if\" : CONDITION , \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where CONDITION is an expression whose type resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The return value of the first form is null , so it acts as a statement: its influence comes from changing variables inside the \"then\" clause. The return value of the second form is either the last expression in the \"then\" clause or the last expression in the \"else\" clause, so it can be used as an inline expression. It can influence the program through its return value, rather than changing variables. The return type is the narrowest possible supertype of the \"then\" clause and the \"else\" clause. Example \u00b6 Both of the following set y to \"yes\" if x is greater than 0 and \"no\" otherwise, but the first uses \"if\" as a statement, while the second uses it as an expression. 1 2 3 4 5 6 7 8 9 10 11 { \"do\" : [ { \"let\" : { \"y\" : \"no\" }}, { \"if\" : { \">\" : [ \"x\" , 0 ]}, \"then\" : { \"set\" : { \"y\" : \"yes\" }}} ]} { \"let\" : { \"y\" : { \"if\" : { \">\" : [ \"x\" , 0 ]}, \"then\" : \"yes\" , \"else\" : \"no\" } }} Conditional with many cases (cond) \u00b6 Long \"else if\" chains could be constructed by nesting the simple \"if\" form above, but for flatter PFA files, an explicit chain is provided. Its structure is: 1 { \"cond\" : [ IF-THEN -1 , IF-THEN -2 , ... ]} or 1 2 { \"cond\" : [ IF-THEN -1 , IF-THEN -2 , ... ], \"else\" : EXPRESSION-OR-EXPRESSIONS } where the IF-THEN are \"if\" forms with no \"else\" clause and the EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. Just like the simple \"if\" form, \"cond\" without \"else\" returns null and \"cond\" with \"else\" returns the smallest possible supertype of the \"then\" clauses and the \"else\" clause. Example \u00b6 The following turns small numbers into English words. 1 2 3 4 5 6 7 8 9 10 11 12 { \"cond\" : [ { \"if\" : { \"==\" : [ \"x\" , 1 ]}, \"then\" : { \"string\" : \"one\" }}, { \"if\" : { \"==\" : [ \"x\" , 2 ]}, \"then\" : { \"string\" : \"two\" }}, { \"if\" : { \"==\" : [ \"x\" , 3 ]}, \"then\" : { \"string\" : \"three\" }}, { \"if\" : { \"==\" : [ \"x\" , 4 ]}, \"then\" : { \"string\" : \"four\" }}, { \"if\" : { \"==\" : [ \"x\" , 5 ]}, \"then\" : { \"string\" : \"five\" }}, { \"if\" : { \"==\" : [ \"x\" , 6 ]}, \"then\" : { \"string\" : \"six\" }}, { \"if\" : { \"==\" : [ \"x\" , 7 ]}, \"then\" : { \"string\" : \"seven\" }}, { \"if\" : { \"==\" : [ \"x\" , 8 ]}, \"then\" : { \"string\" : \"eight\" }}, { \"if\" : { \"==\" : [ \"x\" , 9 ]}, \"then\" : { \"string\" : \"nine\" }}, { \"if\" : { \"==\" : [ \"x\" , 10 ]}, \"then\" : { \"string\" : \"ten\" }}], \"else\" : { \"string\" : \"unknown\" }} (For large look-up tables, it\u2019s better to fill a cell with a map because data can be arbitrarily large, while code is limited on some systems.) Source Data Mining Group Website","title":"Branching control structures"},{"location":"special-forms/control-structures/#mini-program-do","text":"The \"do\" special form is for limiting scope in mini-programs. It is often used by automated code builders. The structure is: {\"do\": [EXPR1, EXPR2, ...]} where EXPR may be any expression and the return value is the value of the last expression.","title":"Mini-program (do)"},{"location":"special-forms/control-structures/#example","text":"The intermediate variables in these blocks do not conflict. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 { \"do\" : [ { \"do\" : [ { \"let\" : { \"x\" : 1 }}, { \"+\" : [ \"x\" , 1 ]}, ], { \"do\" : [ { \"let\" : { \"x\" : 2 }}, { \"+\" : [ \"x\" , 1 ]}, ], { \"do\" : [ { \"let\" : { \"x\" : 3 }}, { \"+\" : [ \"x\" , 1 ]}, ] }","title":"Example"},{"location":"special-forms/control-structures/#conditional-if","text":"PFA\u2019s \"if\" statement has two forms: 1 { \"if\" : CONDITION , \"then\" : EXPRESSION-OR-EXPRESSIONS } and 1 2 { \"if\" : CONDITION , \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where CONDITION is an expression whose type resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The return value of the first form is null , so it acts as a statement: its influence comes from changing variables inside the \"then\" clause. The return value of the second form is either the last expression in the \"then\" clause or the last expression in the \"else\" clause, so it can be used as an inline expression. It can influence the program through its return value, rather than changing variables. The return type is the narrowest possible supertype of the \"then\" clause and the \"else\" clause.","title":"Conditional (if)"},{"location":"special-forms/control-structures/#example_1","text":"Both of the following set y to \"yes\" if x is greater than 0 and \"no\" otherwise, but the first uses \"if\" as a statement, while the second uses it as an expression. 1 2 3 4 5 6 7 8 9 10 11 { \"do\" : [ { \"let\" : { \"y\" : \"no\" }}, { \"if\" : { \">\" : [ \"x\" , 0 ]}, \"then\" : { \"set\" : { \"y\" : \"yes\" }}} ]} { \"let\" : { \"y\" : { \"if\" : { \">\" : [ \"x\" , 0 ]}, \"then\" : \"yes\" , \"else\" : \"no\" } }}","title":"Example"},{"location":"special-forms/control-structures/#conditional-with-many-cases-cond","text":"Long \"else if\" chains could be constructed by nesting the simple \"if\" form above, but for flatter PFA files, an explicit chain is provided. Its structure is: 1 { \"cond\" : [ IF-THEN -1 , IF-THEN -2 , ... ]} or 1 2 { \"cond\" : [ IF-THEN -1 , IF-THEN -2 , ... ], \"else\" : EXPRESSION-OR-EXPRESSIONS } where the IF-THEN are \"if\" forms with no \"else\" clause and the EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. Just like the simple \"if\" form, \"cond\" without \"else\" returns null and \"cond\" with \"else\" returns the smallest possible supertype of the \"then\" clauses and the \"else\" clause.","title":"Conditional with many cases (cond)"},{"location":"special-forms/control-structures/#example_2","text":"The following turns small numbers into English words. 1 2 3 4 5 6 7 8 9 10 11 12 { \"cond\" : [ { \"if\" : { \"==\" : [ \"x\" , 1 ]}, \"then\" : { \"string\" : \"one\" }}, { \"if\" : { \"==\" : [ \"x\" , 2 ]}, \"then\" : { \"string\" : \"two\" }}, { \"if\" : { \"==\" : [ \"x\" , 3 ]}, \"then\" : { \"string\" : \"three\" }}, { \"if\" : { \"==\" : [ \"x\" , 4 ]}, \"then\" : { \"string\" : \"four\" }}, { \"if\" : { \"==\" : [ \"x\" , 5 ]}, \"then\" : { \"string\" : \"five\" }}, { \"if\" : { \"==\" : [ \"x\" , 6 ]}, \"then\" : { \"string\" : \"six\" }}, { \"if\" : { \"==\" : [ \"x\" , 7 ]}, \"then\" : { \"string\" : \"seven\" }}, { \"if\" : { \"==\" : [ \"x\" , 8 ]}, \"then\" : { \"string\" : \"eight\" }}, { \"if\" : { \"==\" : [ \"x\" , 9 ]}, \"then\" : { \"string\" : \"nine\" }}, { \"if\" : { \"==\" : [ \"x\" , 10 ]}, \"then\" : { \"string\" : \"ten\" }}], \"else\" : { \"string\" : \"unknown\" }} (For large look-up tables, it\u2019s better to fill a cell with a map because data can be arbitrarily large, while code is limited on some systems.) Source Data Mining Group Website","title":"Example"},{"location":"special-forms/function-references/","text":"Function definition (fcndef) \u00b6 Functions may be defined and given names in the \"fcns\" top-level field and they may be defined without names within the argument list of some library functions and special forms. Technically, a function definition is not an expression because it does not return an Avro-typed value. A function cannot be defined and assigned to a variable, but it can be defined and passed to a generic algorithm that takes a callback. The structure of a function definition is 1 2 3 { \"params\" : [{ ARG1: TYPE1 }, { ARG2: TYPE2 }, ... ], \"ret\" : RETURN-TYPE , \"do\" : EXPRESSION-OR-EXPRESSIONS } The \"params\" can have any number of parameters, including zero. Each ARG is a string defining a variable that can be used in the \"do\" expressions. The RETURN-TYPE must be an Avro type, though \"null\" can be used if the function doesn\u2019t return anything useful. EXPRESSION-OR-EXPRESSIONS may be a single expression or a JSON array of them. Example \u00b6 The following computes an absolute difference: 1 2 3 { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"m.abs\" : { \"-\" : [ \"x\" , \"y\" ]}}} which could be passed as an argument to the a.zipmap function, for instance. When used to create anonymous functions, those functions can access but not modify variables in the containing scope ( captured by value ). Function reference (fcnref) \u00b6 Named user-defined functions and library functions can be referenced in the argument list of some library functions and special forms. Technically, a function reference is not an expression because it does not return an Avro-typed value. A function cannot be assigned to a variable, but it can be passed to a generic algorithm that takes a callback. The structure of a function reference is {\"fcn\": FUNCTION-NAME} where FUNCTION-NAME is a string naming the function. User-defined functions always start with \"u.\" (even though they are declared in the \"fcns\" section without the \"u.\" ). Library functions can only be referenced if they have exactly one signature and no wildcards. For instance, s.len can be referenced because its only signature takes one \"string\" argument, but a.len cannot because its signature takes an array of any A (array of strings, array of integers, array of records, etc.). A function reference must resolve the function\u2019s signature to a fixed sequence of Avro types. Example \u00b6 The following references \"s.len\" , which returns the length of a string. {\"fcn\": \"s.len\"} Below is an example of wrapping \"a.len\" with a user-defined function so that it returns the length of an array of numbers. 1 2 3 { \"params\" : [ \"x\" : { \"type\" : \"array\" , \"items\" : \"double\" }] \"ret\" : \"int\" , \"do\" : { \"a.len\" : \"x\" }} The wrapped form can be used anywhere that a direct function reference can be used. Function reference with partial application (fcnref-fill) \u00b6 Function references can also reduce the number of arguments in the function by partially applying some of the arguments. The structure of a partially applied function reference is {\"fcn\": FUNCTION-NAME, \"fill\": {ARG1: EXPR1, ARG2: EXPR2, ...}} where FUNCTION-NAME is a string naming the function and the ARG keys are a subset of the function's parameter names. The expressions EXPR provide values. Example \u00b6 To turn the two-argument m.special.nChooseK function into a one-argument function reference that computes 100 choose k , we can reference it like this: {\"fcn\": \"m.special.nChooseK\", \"fill\": {\"n\": 100}} Source Data Mining Group Website","title":"Special forms that provide function references (not expressions)"},{"location":"special-forms/function-references/#function-definition-fcndef","text":"Functions may be defined and given names in the \"fcns\" top-level field and they may be defined without names within the argument list of some library functions and special forms. Technically, a function definition is not an expression because it does not return an Avro-typed value. A function cannot be defined and assigned to a variable, but it can be defined and passed to a generic algorithm that takes a callback. The structure of a function definition is 1 2 3 { \"params\" : [{ ARG1: TYPE1 }, { ARG2: TYPE2 }, ... ], \"ret\" : RETURN-TYPE , \"do\" : EXPRESSION-OR-EXPRESSIONS } The \"params\" can have any number of parameters, including zero. Each ARG is a string defining a variable that can be used in the \"do\" expressions. The RETURN-TYPE must be an Avro type, though \"null\" can be used if the function doesn\u2019t return anything useful. EXPRESSION-OR-EXPRESSIONS may be a single expression or a JSON array of them.","title":"Function definition (fcndef)"},{"location":"special-forms/function-references/#example","text":"The following computes an absolute difference: 1 2 3 { \"params\" : [{ \"x\" : \"double\" }, { \"y\" : \"double\" }], \"ret\" : \"double\" , \"do\" : { \"m.abs\" : { \"-\" : [ \"x\" , \"y\" ]}}} which could be passed as an argument to the a.zipmap function, for instance. When used to create anonymous functions, those functions can access but not modify variables in the containing scope ( captured by value ).","title":"Example"},{"location":"special-forms/function-references/#function-reference-fcnref","text":"Named user-defined functions and library functions can be referenced in the argument list of some library functions and special forms. Technically, a function reference is not an expression because it does not return an Avro-typed value. A function cannot be assigned to a variable, but it can be passed to a generic algorithm that takes a callback. The structure of a function reference is {\"fcn\": FUNCTION-NAME} where FUNCTION-NAME is a string naming the function. User-defined functions always start with \"u.\" (even though they are declared in the \"fcns\" section without the \"u.\" ). Library functions can only be referenced if they have exactly one signature and no wildcards. For instance, s.len can be referenced because its only signature takes one \"string\" argument, but a.len cannot because its signature takes an array of any A (array of strings, array of integers, array of records, etc.). A function reference must resolve the function\u2019s signature to a fixed sequence of Avro types.","title":"Function reference (fcnref)"},{"location":"special-forms/function-references/#example_1","text":"The following references \"s.len\" , which returns the length of a string. {\"fcn\": \"s.len\"} Below is an example of wrapping \"a.len\" with a user-defined function so that it returns the length of an array of numbers. 1 2 3 { \"params\" : [ \"x\" : { \"type\" : \"array\" , \"items\" : \"double\" }] \"ret\" : \"int\" , \"do\" : { \"a.len\" : \"x\" }} The wrapped form can be used anywhere that a direct function reference can be used.","title":"Example"},{"location":"special-forms/function-references/#function-reference-with-partial-application-fcnref-fill","text":"Function references can also reduce the number of arguments in the function by partially applying some of the arguments. The structure of a partially applied function reference is {\"fcn\": FUNCTION-NAME, \"fill\": {ARG1: EXPR1, ARG2: EXPR2, ...}} where FUNCTION-NAME is a string naming the function and the ARG keys are a subset of the function's parameter names. The expressions EXPR provide values.","title":"Function reference with partial application (fcnref-fill)"},{"location":"special-forms/function-references/#example_2","text":"To turn the two-argument m.special.nChooseK function into a one-argument function reference that computes 100 choose k , we can reference it like this: {\"fcn\": \"m.special.nChooseK\", \"fill\": {\"n\": 100}} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/loops/","text":"Generic pre-test loop (while) \u00b6 PFA has an ordinary \"while\" loop, which has the usual danger of not terminating. (The timeout option can prevent that, however.) Its structure is: {\"while\": CONDITION, \"do\": EXPRESSION-OR-EXPRESSIONS} where CONDITION is an expression that resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. PFA has no \"break\", \"continue\", or \"return\" statement, so a while loop is often not the best way to do things. Example \u00b6 An infinite loop. {\"while\": true, \"do\": {\"log\": {\"string\": \"Can't stop!\"}}} Generic post-test loop (do-until) \u00b6 The \"while\" loop tests its condition before executing its \"do\" expressions, and sometimes it\u2019s necessary to test the condition afterward (especially because there is no \u201cbreak\u201d statement). Its structure is: {\"do\": EXPRESSION-OR-EXPRESSIONS, \"until\": CONDITION} where CONDITION is an expression that resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. Example \u00b6 An iterative procedure that has a non-trivial stop condition. 1 2 3 4 5 6 7 { \"do\" : [ { \"set\" : { \"state\" : { \"u.doOneIteration\" : \"state\" }}}, { \"let\" : { \"cond1\" : { \"u.checkCondition1\" : \"state\" }, \"cond2\" : { \"u.checkCondition2\" : \"state\" }}}, ], \"until\" : { \"&&\" : [ \"cond1\" , \"cond2\" ]}} Iteration with dummy variables (for) \u00b6 PFA's \"for\" loop takes a \"let\" -like structure for its initializer and a \"set\" -like structure for its updator, but is otherwise like a for loop in C. Its structure is: 1 2 3 4 { \"for\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"while\" : CONDITION , \"step\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"do\" : EXPRESSION-OR-EXPRESSIONS } where the VAR are variable names and the EXPR are their initial or updated values. The initial values set the type and the updated values have to conform to that type. The CONDITION is an expression that resolves to \"boolean\" , and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. Example \u00b6 A for loop that applies a procedure to numbers from 1 to 10 (inclusive). 1 2 3 4 5 { \"for\" : { \"i\" : 1 }, \"while\" : { \"<=\" : [ \"i\" , 10 ]}, \"step\" : { \"i\" : { \"+\" : [ \"i\" , 1 ]}}, \"do\" : { \"u.procedure\" : \"i\" }} Iteration over arrays (foreach) \u00b6 PFA has a \"foreach\" loop for iteration over arrays. This version should be familiar to users of Python or R. Its structure is: 1 { \"foreach\" : VAR , \"in\" : ARRAY , \"do\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 { \"foreach\" : VAR , \"in\" : ARRAY , \"do\" : EXPRESSION-OR-EXPRESSIONS , \"seq\" : TRUE-OR-FALSE } where VAR is a new variable name, ARRAY is an expression that resolves to an array type, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The \"seq\" parameter, if provided must be a JSON true or false (default of true). If true , it indicates that the loop must be processed sequentially. If false , the PFA implementation may parallelize the loop. The consequence for the PFA author is that variables defined outside the \"foreach\" can only be changed if elements are processed sequentially. If you get an error saying that a variable cannot be modified inside the scope of a \"foreach\" loop, make sure the \"seq\" parameter is true (although the cause could be another sealed scope between the \"foreach\" and the variable, such as an inline function declaration.) Example \u00b6 Apply a procedure to each element of an array. 1 2 { \"foreach\" : \"x\" , \"in\" : \"input.myArray\" , \"do\" : { \"u.procedure\" : \"x\" }} Allow the PFA consumer to perform the steps in parallel, which makes it impossible to modify any variables defined outside the \"foreach\" . 1 2 3 { \"foreach\" : \"x\" , \"in\" : \"input.myArray\" , \"do\" : { \"u.procedure\" : \"x\" }, \"seq\" : false } Iteration over maps (forkey-forval) \u00b6 PFA's \"forkey-forval\" is an extension of the \"foreach\" idea to iterating over the key-value pairs of a map. Its structure is: 1 2 { \"forkey\" : VAR 1 , \"forval\" : VAR 2 , \"in\" : MAP , \"do\" : EXPRESSION-OR-EXPRESSIONS } where VAR1 is the name of a new variable for each key of the map, VAR2 is the name of a new variable for each value of the map, MAP is an expression that resolves to a map type, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The order of a loop over a map is never guaranteed. Example \u00b6 Apply a procedure to each key, value pair of a map. 1 2 { \"forkey\" : \"k\" , \"forval\" : \"v\" , \"in\" : \"input.myMap\" , \"do\" : { \"u.procedure\" : [ \"k\" , \"v\" ]} Source Data Mining Group Website","title":"Loops"},{"location":"special-forms/loops/#generic-pre-test-loop-while","text":"PFA has an ordinary \"while\" loop, which has the usual danger of not terminating. (The timeout option can prevent that, however.) Its structure is: {\"while\": CONDITION, \"do\": EXPRESSION-OR-EXPRESSIONS} where CONDITION is an expression that resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. PFA has no \"break\", \"continue\", or \"return\" statement, so a while loop is often not the best way to do things.","title":"Generic pre-test loop (while)"},{"location":"special-forms/loops/#example","text":"An infinite loop. {\"while\": true, \"do\": {\"log\": {\"string\": \"Can't stop!\"}}}","title":"Example"},{"location":"special-forms/loops/#generic-post-test-loop-do-until","text":"The \"while\" loop tests its condition before executing its \"do\" expressions, and sometimes it\u2019s necessary to test the condition afterward (especially because there is no \u201cbreak\u201d statement). Its structure is: {\"do\": EXPRESSION-OR-EXPRESSIONS, \"until\": CONDITION} where CONDITION is an expression that resolves to \"boolean\" and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions.","title":"Generic post-test loop (do-until)"},{"location":"special-forms/loops/#example_1","text":"An iterative procedure that has a non-trivial stop condition. 1 2 3 4 5 6 7 { \"do\" : [ { \"set\" : { \"state\" : { \"u.doOneIteration\" : \"state\" }}}, { \"let\" : { \"cond1\" : { \"u.checkCondition1\" : \"state\" }, \"cond2\" : { \"u.checkCondition2\" : \"state\" }}}, ], \"until\" : { \"&&\" : [ \"cond1\" , \"cond2\" ]}}","title":"Example"},{"location":"special-forms/loops/#iteration-with-dummy-variables-for","text":"PFA's \"for\" loop takes a \"let\" -like structure for its initializer and a \"set\" -like structure for its updator, but is otherwise like a for loop in C. Its structure is: 1 2 3 4 { \"for\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"while\" : CONDITION , \"step\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"do\" : EXPRESSION-OR-EXPRESSIONS } where the VAR are variable names and the EXPR are their initial or updated values. The initial values set the type and the updated values have to conform to that type. The CONDITION is an expression that resolves to \"boolean\" , and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions.","title":"Iteration with dummy variables (for)"},{"location":"special-forms/loops/#example_2","text":"A for loop that applies a procedure to numbers from 1 to 10 (inclusive). 1 2 3 4 5 { \"for\" : { \"i\" : 1 }, \"while\" : { \"<=\" : [ \"i\" , 10 ]}, \"step\" : { \"i\" : { \"+\" : [ \"i\" , 1 ]}}, \"do\" : { \"u.procedure\" : \"i\" }}","title":"Example"},{"location":"special-forms/loops/#iteration-over-arrays-foreach","text":"PFA has a \"foreach\" loop for iteration over arrays. This version should be familiar to users of Python or R. Its structure is: 1 { \"foreach\" : VAR , \"in\" : ARRAY , \"do\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 { \"foreach\" : VAR , \"in\" : ARRAY , \"do\" : EXPRESSION-OR-EXPRESSIONS , \"seq\" : TRUE-OR-FALSE } where VAR is a new variable name, ARRAY is an expression that resolves to an array type, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The \"seq\" parameter, if provided must be a JSON true or false (default of true). If true , it indicates that the loop must be processed sequentially. If false , the PFA implementation may parallelize the loop. The consequence for the PFA author is that variables defined outside the \"foreach\" can only be changed if elements are processed sequentially. If you get an error saying that a variable cannot be modified inside the scope of a \"foreach\" loop, make sure the \"seq\" parameter is true (although the cause could be another sealed scope between the \"foreach\" and the variable, such as an inline function declaration.)","title":"Iteration over arrays (foreach)"},{"location":"special-forms/loops/#example_3","text":"Apply a procedure to each element of an array. 1 2 { \"foreach\" : \"x\" , \"in\" : \"input.myArray\" , \"do\" : { \"u.procedure\" : \"x\" }} Allow the PFA consumer to perform the steps in parallel, which makes it impossible to modify any variables defined outside the \"foreach\" . 1 2 3 { \"foreach\" : \"x\" , \"in\" : \"input.myArray\" , \"do\" : { \"u.procedure\" : \"x\" }, \"seq\" : false }","title":"Example"},{"location":"special-forms/loops/#iteration-over-maps-forkey-forval","text":"PFA's \"forkey-forval\" is an extension of the \"foreach\" idea to iterating over the key-value pairs of a map. Its structure is: 1 2 { \"forkey\" : VAR 1 , \"forval\" : VAR 2 , \"in\" : MAP , \"do\" : EXPRESSION-OR-EXPRESSIONS } where VAR1 is the name of a new variable for each key of the map, VAR2 is the name of a new variable for each value of the map, MAP is an expression that resolves to a map type, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. The order of a loop over a map is never guaranteed.","title":"Iteration over maps (forkey-forval)"},{"location":"special-forms/loops/#example_4","text":"Apply a procedure to each key, value pair of a map. 1 2 { \"forkey\" : \"k\" , \"forval\" : \"v\" , \"in\" : \"input.myMap\" , \"do\" : { \"u.procedure\" : [ \"k\" , \"v\" ]} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/misc/","text":"Inline documentation (doc) \u00b6 Since JSON has no comments, PFA provides an inert special form for comments. It takes a string and always returns null . {\"doc\": STRING} where STRING is any string. Example \u00b6 A simple example. {\"doc\": \"This is like those REM strings from BASIC.\"} User-defined exceptions (error) \u00b6 The following special form raises an exception. It has no return type. {\"error\": STRING} Example \u00b6 When combined with other types as a narrowest possible supertype, the \"error\" form is ignored. The following has type \"int\" . 1 2 3 { \"if\" : \"condition\" , \"then\" : 3 , \"else\" : { \"error\" : \"no good\" }} It can be used to let special forms return a non-null value without constructing unwanted unions. Turning exceptions into missing values (try) \u00b6 PFA has a \"try\" special form, but unlike most languages, it does not have a \"catch\" case. In PFA, \"try\" is used to turn exceptions into missing values ( null ). Its structure is {\"try\": EXPRESSION-OR-EXPRESSION} or {\"try\": EXPRESSION-OR-EXPRESSION, \"filter\": ARRAY-OF-STRINGS} The EXPRESSION-OR-EXPRESSIONS is a single expression or a JSON array of expressions, and ARRAY-OF-STRINGS is a JSON array of simple strings (not expressions). If provided, the \"filter\" selects a subset of exception strings to catch. The return type is a union of the expression's type and \"null\" . This makes it applicable for any impute function. Example \u00b6 The following gets the first element from an array or null if the array is empty. {\"try\": {\"a.head\": \"input\"}} If the \"input\" array had type {\"type\": \"array\", \"items\": \"int\"} , then the type of the above expression is [\"null\", \"int\"] . A traditional try-catch block can be formed by combining \"try\" with \"ifnotnull\": 1 2 3 { \"ifnotnull\" : { \"x\" : { \"try\" : { \"u.attempt\" : []}}}, \"then\" : { \"u.workWithResult\" : \"x\" }, \"else\" : { \"u.dealWithException\" : []}} Log messages (log) \u00b6 A PFA scoring engine is connected to an input source, and output sink, and optionally a log file. The nature of this log file is outside the scope of PFA, but if it exists, the following special form writes text to it. {\"log\": EXPRESSION-OR-EXPRESSIONS} or {\"log\": EXPRESSION-OR-EXPRESSIONS, \"namespace\": NAME} where EXPRESSION-OR-EXPRESSIONS is a single expression or a JSON array of expressions, and NAME is a string (not an expression). The output of each call to \"log\" is a line of text, space-delimited JSON representations of the provided expressions. The \"namespace\" is optional; the external system may use it to send logs to different files, prefix the line of text with a marker, or ignore it. The return value of \"log\" is null . Example \u00b6 The following writes the values of two variables, a number, and string to the logfile. {\"log\": [\"x\", \"y\", 3.14, {\"string\": \"literal string\"}]} Source Data Mining Group Website","title":"Miscellaneous special forms"},{"location":"special-forms/misc/#inline-documentation-doc","text":"Since JSON has no comments, PFA provides an inert special form for comments. It takes a string and always returns null . {\"doc\": STRING} where STRING is any string.","title":"Inline documentation (doc)"},{"location":"special-forms/misc/#example","text":"A simple example. {\"doc\": \"This is like those REM strings from BASIC.\"}","title":"Example"},{"location":"special-forms/misc/#user-defined-exceptions-error","text":"The following special form raises an exception. It has no return type. {\"error\": STRING}","title":"User-defined exceptions (error)"},{"location":"special-forms/misc/#example_1","text":"When combined with other types as a narrowest possible supertype, the \"error\" form is ignored. The following has type \"int\" . 1 2 3 { \"if\" : \"condition\" , \"then\" : 3 , \"else\" : { \"error\" : \"no good\" }} It can be used to let special forms return a non-null value without constructing unwanted unions.","title":"Example"},{"location":"special-forms/misc/#turning-exceptions-into-missing-values-try","text":"PFA has a \"try\" special form, but unlike most languages, it does not have a \"catch\" case. In PFA, \"try\" is used to turn exceptions into missing values ( null ). Its structure is {\"try\": EXPRESSION-OR-EXPRESSION} or {\"try\": EXPRESSION-OR-EXPRESSION, \"filter\": ARRAY-OF-STRINGS} The EXPRESSION-OR-EXPRESSIONS is a single expression or a JSON array of expressions, and ARRAY-OF-STRINGS is a JSON array of simple strings (not expressions). If provided, the \"filter\" selects a subset of exception strings to catch. The return type is a union of the expression's type and \"null\" . This makes it applicable for any impute function.","title":"Turning exceptions into missing values (try)"},{"location":"special-forms/misc/#example_2","text":"The following gets the first element from an array or null if the array is empty. {\"try\": {\"a.head\": \"input\"}} If the \"input\" array had type {\"type\": \"array\", \"items\": \"int\"} , then the type of the above expression is [\"null\", \"int\"] . A traditional try-catch block can be formed by combining \"try\" with \"ifnotnull\": 1 2 3 { \"ifnotnull\" : { \"x\" : { \"try\" : { \"u.attempt\" : []}}}, \"then\" : { \"u.workWithResult\" : \"x\" }, \"else\" : { \"u.dealWithException\" : []}}","title":"Example"},{"location":"special-forms/misc/#log-messages-log","text":"A PFA scoring engine is connected to an input source, and output sink, and optionally a log file. The nature of this log file is outside the scope of PFA, but if it exists, the following special form writes text to it. {\"log\": EXPRESSION-OR-EXPRESSIONS} or {\"log\": EXPRESSION-OR-EXPRESSIONS, \"namespace\": NAME} where EXPRESSION-OR-EXPRESSIONS is a single expression or a JSON array of expressions, and NAME is a string (not an expression). The output of each call to \"log\" is a line of text, space-delimited JSON representations of the provided expressions. The \"namespace\" is optional; the external system may use it to send logs to different files, prefix the line of text with a marker, or ignore it. The return value of \"log\" is null .","title":"Log messages (log)"},{"location":"special-forms/misc/#example_3","text":"The following writes the values of two variables, a number, and string to the logfile. {\"log\": [\"x\", \"y\", 3.14, {\"string\": \"literal string\"}]} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/symbol-assignment/","text":"PFA has lexical, expression-level scope. You can create variables and access them in any contained expression, including inline functions. You can only modify them at the same level of scope or inside expressions that do not seal their scope from above, such as inline functions (this allows callbacks to be distributed or run in parallel). All PFA values are immutable: you cannot change an element of an array in-place; you must replace the array. PFA variables are mutable: you can replace the value stored in a variable as long as it has the same type. Pure immutability for PFA values allows them to share structure and have non-blocking read access during shared data updates. Mutability of variable storage allows for straightforward implementation of iterative algorithms. Creating variables (let) \u00b6 Variables are created with \"let\" , which has the following structure: {\"let\": {VAR1: EXPR1, VAR2: EXPR2, ...}} where the VAR are new variable names and the EXPR are their initial values. The initial values set the type. More than one variable can be created at a time, but none of the variables are in scope inside the \"let\" block. In principle, they could be computed in parallel. Variables can only be created once and variables in deeper scopes cannot shadow other variables of the same name. Example \u00b6 The following creates a union of \"null\" and \"double\" with an initial value of null. {\"let\": {\"x\": {\"type\": [\"null\", \"double\"], \"value\": null}}} x can be set to a number later. Changing variable bindings (set) \u00b6 Variables are changed with \"set\" , which has the following structure: {\"set\": {VAR1: EXPR1, VAR2: EXPR2, ...}} where the VAR are existing variable names and the EXPR are their new values. The variables must accept the types of the EXPR . More than one variable can be changed at a time, but none of the changes are bound to the variables inside the \"set\" block (which makes swaps possible; see example). Taking advantage of immutability, these updates could be computed in parallel. Example \u00b6 The following swaps the values in a and b. {\"set\": {\"a\": \"b\", \"b\": \"a\"}} Source Data Mining Group Website","title":"Symbol assignment and reassignment"},{"location":"special-forms/symbol-assignment/#creating-variables-let","text":"Variables are created with \"let\" , which has the following structure: {\"let\": {VAR1: EXPR1, VAR2: EXPR2, ...}} where the VAR are new variable names and the EXPR are their initial values. The initial values set the type. More than one variable can be created at a time, but none of the variables are in scope inside the \"let\" block. In principle, they could be computed in parallel. Variables can only be created once and variables in deeper scopes cannot shadow other variables of the same name.","title":"Creating variables (let)"},{"location":"special-forms/symbol-assignment/#example","text":"The following creates a union of \"null\" and \"double\" with an initial value of null. {\"let\": {\"x\": {\"type\": [\"null\", \"double\"], \"value\": null}}} x can be set to a number later.","title":"Example"},{"location":"special-forms/symbol-assignment/#changing-variable-bindings-set","text":"Variables are changed with \"set\" , which has the following structure: {\"set\": {VAR1: EXPR1, VAR2: EXPR2, ...}} where the VAR are existing variable names and the EXPR are their new values. The variables must accept the types of the EXPR . More than one variable can be changed at a time, but none of the changes are bound to the variables inside the \"set\" block (which makes swaps possible; see example). Taking advantage of immutability, these updates could be computed in parallel.","title":"Changing variable bindings (set)"},{"location":"special-forms/symbol-assignment/#example_1","text":"The following swaps the values in a and b. {\"set\": {\"a\": \"b\", \"b\": \"a\"}} Source Data Mining Group Website","title":"Example"},{"location":"special-forms/type-safe-casting/","text":"Narrowing a type (cast-cases) \u00b6 If an expression has a type with subtypes, such as a union, you sometimes need to cast it as one of those subtypes. In most languages, like C and Java, casting bypasses type-safety. Incorrect casts either lead to wrong results or raise exceptions. Some languages, like PFA, provide type-safe casts, which require the author to provide a contingency for every possible subtype. The structure for a type-safe cast in PFA is: 1 2 3 4 5 6 7 8 9 { \"cast\" : EXPRESSION , \"cases\" : [ { \"as\" : TYPE 1 , \"named\" : VAR 1 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, { \"as\" : TYPE 2 , \"named\" : VAR 2 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, ... ]} or 1 2 3 4 5 6 7 8 9 { \"cast\" : EXPRESSION , \"cases\" : [ { \"as\" : TYPE 1 , \"named\" : VAR 1 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, { \"as\" : TYPE 2 , \"named\" : VAR 2 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, ... ], \"partial\" : TRUE-OR-FALSE } where EXPRESSION is an expression, the TYPE are subtypes of the EXPRESSION type, the VAR are new variable names, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. If the type of EXPRESSION is TYPE1 , then the first \"do\" block is evaluated with VAR1 defined as a variable with TYPE1 . If, instead, it is TYPE2 , then the second \"do\" block is evaluated. If \"partial\" is not provided or \"partial\" is false , then the TYPE subtypes must cover all possibilities and the \"cast\" form returns the last expression of whichever block is evaluated. (The return type is the narrowest possible supertype of the \"do\" blocks.) If \"partial\" is true , then the TYPE subtypes do not have to cover all possibilities and the \"cast\" form returns null . Example \u00b6 Given a variable x that could be \"double\" , \"string\" , or \"null\" , the following expression returns the name of the type. 1 2 3 4 { \"cast\" : \"x\" , \"cases\" : [ { \"as\" : \"double\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"double\" }}, { \"as\" : \"string\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"string\" }}, { \"as\" : \"null\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"null\" }}]} The following writes a log message for the first two cases, including the value of the variable. 1 2 3 4 5 6 { \"cast\" : \"x\" , \"cases\" : [ { \"double\" , \"named\" : \"y\" : \"do\" : { \"log\" : [ \"y\" , { \"string\" : \"double\" }]}}, { \"string\" , \"named\" : \"y\" : \"do\" : { \"log\" : [ \"y\" , { \"string\" : \"string\" }]}}], \"partial\" : true } Widening a type (upcast) \u00b6 The \"cast-cases\" form (above) is used for the usual case of casting a supertype to its subtypes. The other direction is rarely needed and always safe. Its structure is simple: {\"upcast\": EXPRESSION, \"as\": TYPE} where EXPRESSION is an expression and TYPE is a supertype of the EXPRESSION type. Example \u00b6 Casting an integer as a double. {\"upcast\": 3, \"as\": \"double\"} Checking for missing values (ifnotnull) \u00b6 Checking for null is a special case of narrowing a type, so the \"cast-cases\" form could be used to handle it. However, PFA uses null to represent missing values, so it is a frequent special case and \"cast-cases\" is cumbersome. Moreover, \"cast-cases\" can only cast one expression at a time, and we frequently need to check for null in several expressions. The \"ifnotnull\" special form handles this case, and its structure is: 1 2 { \"ifnotnull\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"then\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 3 { \"ifnotnull\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where the VAR are new variable names that are in the scope of the \"then\" clause, the EXPR are single expressions or JSON arrays of expressions to check. If all of them are not null , the \"then\" clause is evaluated. If any one is null and an \"else\" clause is provided, it is evaluated. If an \"else\" clause is provided, the return value is the last expression of \"then\" or \"else\" . Its type is the narrowest possible supertype of both clauses. If an \"else\" is not provided, the return value is null . Example \u00b6 The following performs a procedure if all variables are present, and returns a substitute otherwise. 1 2 3 { \"ifnotnull\" : { \"x\" : \"input.x\" , \"y\" : \"input.y\" , \"z\" : \"input.z\" }, \"then\" : { \"u.procedure\" : [ \"x\" , \"y\" , \"z\" ]}, \"else\" : 0 } Extracting values from binary (unpack) \u00b6 Sometimes, it is necessary to extract data from a serialized \"bytes\" object. This is done with a special form, rather than a library function, because the return type depends on the interpretation of the \"bytes\" object. It has the following structure. 1 2 3 { \"unpack\" : BYTES , \"format\" : [{ VAR1: FORMAT1 }, { VAR1: FORMAT1 }, ... ], \"then\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 3 4 { \"unpack\" : BYTES , \"format\" : [{ VAR1: FORMAT1 }, { VAR1: FORMAT1 }, ... ], \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where BYTES is an expression that resolves to \"bytes\" type, the VAR are new variable names that are in the scope of the \"then\" clause, the FORMAT are format strings (described below), and the \"then\" and optional \"else\" clauses are single expresions or JSON arrays of expressions. If the \"bytes\" content conforms to the format, the \"then\" clause is evaluated. If not, and if an \"else\" clause is provided, the \"else\" clause is evaluated. With an \"else\" clause, the result is the last expression in either \"then\" or \"else\" whose type is the narrowest possible supertype of the two. Without an \"else\" , the return value is null . The format strings have the following values. Format Result PFA type pad skips one byte \"null\" boolean one byte as true if nonzero \"boolean\" int8 one byte as signed integer \"int\" int16 two bytes as signed integer \"int\" int32 four bytes as signed integer \"int\" int64 eight bytes as signed integer \"long\" float32 four bytes as a floating-point number \"float\" float64 eight bytes as a floating-point number \"double\" raw ## extract a fixed number of bytes \"bytes\" null terminated extract bytes until terminated by zero (excluding terminus) \"bytes\" length prefixed interpret first byte as a size, then extract that many bytes (excluding size byte) \"bytes\" The int8 , int16 , int32 , and int64 formats can also be preceded by unsigned to interpret the bytes as an unsigned integer. The int16 , int32 , int64 , float32 , and float64 formats can be preceded by little to interpret the bytes as little-endian. (The unsigned modifier comes first.) Example \u00b6 Extract three fields and use them to fill a record, with a default if the bytes are corrupted. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 { \"unpack\" : \"input\" , \"format\" : [ { \"x\" : \"int32\" }, { \"y\" : \"float64\" }, { \"z\" : \"null terminated\" }], \"then\" : { \"type\" : { \"type\" : \"record\" , \"name\" : \"MyRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" }]}, \"new\" : { \"one\" : \"x\" , \"two\" : \"y\" , \"three\" : { \"bytes.decodeUtf8\" : \"z\" }} }, \"else\" : { \"type\" : \"MyRecord\" , \"new\" : { \"one\" : 0 , \"two\" : 0.0 , \"three\" : \"\" }}} Encoding values in binary (pack) \u00b6 The opposite of the above is \"pack\", which serializes variables as a \"bytes\" object. Its structure is: {\"pack\": [{FORMAT1: EXPR1}, {FORMAT2: EXPR2}, ...]} where FORMAT are format strings (described below), and EXPR are expressions. The return type of this form is a \"bytes\" object. The format strings are the same as the \"unpack\" case, with one additional format. Format Result PFA type raw any number of bytes \"bytes\" Example \u00b6 This serializes three variables. 1 2 3 { \"pack\" : [{ \"int32\" : \"input.x\" }, { \"float64\" : \"input.y\" }, { \"null terminated\" : \"input.z\" }]} Source Data Mining Group Website","title":"Type-safe casting"},{"location":"special-forms/type-safe-casting/#narrowing-a-type-cast-cases","text":"If an expression has a type with subtypes, such as a union, you sometimes need to cast it as one of those subtypes. In most languages, like C and Java, casting bypasses type-safety. Incorrect casts either lead to wrong results or raise exceptions. Some languages, like PFA, provide type-safe casts, which require the author to provide a contingency for every possible subtype. The structure for a type-safe cast in PFA is: 1 2 3 4 5 6 7 8 9 { \"cast\" : EXPRESSION , \"cases\" : [ { \"as\" : TYPE 1 , \"named\" : VAR 1 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, { \"as\" : TYPE 2 , \"named\" : VAR 2 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, ... ]} or 1 2 3 4 5 6 7 8 9 { \"cast\" : EXPRESSION , \"cases\" : [ { \"as\" : TYPE 1 , \"named\" : VAR 1 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, { \"as\" : TYPE 2 , \"named\" : VAR 2 , \"do\" : EXPRESSION-OR-EXPRESSIONS }, ... ], \"partial\" : TRUE-OR-FALSE } where EXPRESSION is an expression, the TYPE are subtypes of the EXPRESSION type, the VAR are new variable names, and EXPRESSION-OR-EXPRESSIONS is either a single expression or a JSON array of expressions. If the type of EXPRESSION is TYPE1 , then the first \"do\" block is evaluated with VAR1 defined as a variable with TYPE1 . If, instead, it is TYPE2 , then the second \"do\" block is evaluated. If \"partial\" is not provided or \"partial\" is false , then the TYPE subtypes must cover all possibilities and the \"cast\" form returns the last expression of whichever block is evaluated. (The return type is the narrowest possible supertype of the \"do\" blocks.) If \"partial\" is true , then the TYPE subtypes do not have to cover all possibilities and the \"cast\" form returns null .","title":"Narrowing a type (cast-cases)"},{"location":"special-forms/type-safe-casting/#example","text":"Given a variable x that could be \"double\" , \"string\" , or \"null\" , the following expression returns the name of the type. 1 2 3 4 { \"cast\" : \"x\" , \"cases\" : [ { \"as\" : \"double\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"double\" }}, { \"as\" : \"string\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"string\" }}, { \"as\" : \"null\" , \"named\" : \"y\" , \"do\" : { \"string\" : \"null\" }}]} The following writes a log message for the first two cases, including the value of the variable. 1 2 3 4 5 6 { \"cast\" : \"x\" , \"cases\" : [ { \"double\" , \"named\" : \"y\" : \"do\" : { \"log\" : [ \"y\" , { \"string\" : \"double\" }]}}, { \"string\" , \"named\" : \"y\" : \"do\" : { \"log\" : [ \"y\" , { \"string\" : \"string\" }]}}], \"partial\" : true }","title":"Example"},{"location":"special-forms/type-safe-casting/#widening-a-type-upcast","text":"The \"cast-cases\" form (above) is used for the usual case of casting a supertype to its subtypes. The other direction is rarely needed and always safe. Its structure is simple: {\"upcast\": EXPRESSION, \"as\": TYPE} where EXPRESSION is an expression and TYPE is a supertype of the EXPRESSION type.","title":"Widening a type (upcast)"},{"location":"special-forms/type-safe-casting/#example_1","text":"Casting an integer as a double. {\"upcast\": 3, \"as\": \"double\"}","title":"Example"},{"location":"special-forms/type-safe-casting/#checking-for-missing-values-ifnotnull","text":"Checking for null is a special case of narrowing a type, so the \"cast-cases\" form could be used to handle it. However, PFA uses null to represent missing values, so it is a frequent special case and \"cast-cases\" is cumbersome. Moreover, \"cast-cases\" can only cast one expression at a time, and we frequently need to check for null in several expressions. The \"ifnotnull\" special form handles this case, and its structure is: 1 2 { \"ifnotnull\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"then\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 3 { \"ifnotnull\" : { VAR1: EXPR1, VAR2: EXPR2, ... }, \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where the VAR are new variable names that are in the scope of the \"then\" clause, the EXPR are single expressions or JSON arrays of expressions to check. If all of them are not null , the \"then\" clause is evaluated. If any one is null and an \"else\" clause is provided, it is evaluated. If an \"else\" clause is provided, the return value is the last expression of \"then\" or \"else\" . Its type is the narrowest possible supertype of both clauses. If an \"else\" is not provided, the return value is null .","title":"Checking for missing values (ifnotnull)"},{"location":"special-forms/type-safe-casting/#example_2","text":"The following performs a procedure if all variables are present, and returns a substitute otherwise. 1 2 3 { \"ifnotnull\" : { \"x\" : \"input.x\" , \"y\" : \"input.y\" , \"z\" : \"input.z\" }, \"then\" : { \"u.procedure\" : [ \"x\" , \"y\" , \"z\" ]}, \"else\" : 0 }","title":"Example"},{"location":"special-forms/type-safe-casting/#extracting-values-from-binary-unpack","text":"Sometimes, it is necessary to extract data from a serialized \"bytes\" object. This is done with a special form, rather than a library function, because the return type depends on the interpretation of the \"bytes\" object. It has the following structure. 1 2 3 { \"unpack\" : BYTES , \"format\" : [{ VAR1: FORMAT1 }, { VAR1: FORMAT1 }, ... ], \"then\" : EXPRESSION-OR-EXPRESSIONS } or 1 2 3 4 { \"unpack\" : BYTES , \"format\" : [{ VAR1: FORMAT1 }, { VAR1: FORMAT1 }, ... ], \"then\" : EXPRESSION-OR-EXPRESSIONS , \"else\" : EXPRESSION-OR-EXPRESSIONS } where BYTES is an expression that resolves to \"bytes\" type, the VAR are new variable names that are in the scope of the \"then\" clause, the FORMAT are format strings (described below), and the \"then\" and optional \"else\" clauses are single expresions or JSON arrays of expressions. If the \"bytes\" content conforms to the format, the \"then\" clause is evaluated. If not, and if an \"else\" clause is provided, the \"else\" clause is evaluated. With an \"else\" clause, the result is the last expression in either \"then\" or \"else\" whose type is the narrowest possible supertype of the two. Without an \"else\" , the return value is null . The format strings have the following values. Format Result PFA type pad skips one byte \"null\" boolean one byte as true if nonzero \"boolean\" int8 one byte as signed integer \"int\" int16 two bytes as signed integer \"int\" int32 four bytes as signed integer \"int\" int64 eight bytes as signed integer \"long\" float32 four bytes as a floating-point number \"float\" float64 eight bytes as a floating-point number \"double\" raw ## extract a fixed number of bytes \"bytes\" null terminated extract bytes until terminated by zero (excluding terminus) \"bytes\" length prefixed interpret first byte as a size, then extract that many bytes (excluding size byte) \"bytes\" The int8 , int16 , int32 , and int64 formats can also be preceded by unsigned to interpret the bytes as an unsigned integer. The int16 , int32 , int64 , float32 , and float64 formats can be preceded by little to interpret the bytes as little-endian. (The unsigned modifier comes first.)","title":"Extracting values from binary (unpack)"},{"location":"special-forms/type-safe-casting/#example_3","text":"Extract three fields and use them to fill a record, with a default if the bytes are corrupted. 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 { \"unpack\" : \"input\" , \"format\" : [ { \"x\" : \"int32\" }, { \"y\" : \"float64\" }, { \"z\" : \"null terminated\" }], \"then\" : { \"type\" : { \"type\" : \"record\" , \"name\" : \"MyRecord\" , \"fields\" : [ { \"name\" : \"one\" , \"type\" : \"int\" }, { \"name\" : \"two\" , \"type\" : \"double\" }, { \"name\" : \"three\" , \"type\" : \"string\" }]}, \"new\" : { \"one\" : \"x\" , \"two\" : \"y\" , \"three\" : { \"bytes.decodeUtf8\" : \"z\" }} }, \"else\" : { \"type\" : \"MyRecord\" , \"new\" : { \"one\" : 0 , \"two\" : 0.0 , \"three\" : \"\" }}}","title":"Example"},{"location":"special-forms/type-safe-casting/#encoding-values-in-binary-pack","text":"The opposite of the above is \"pack\", which serializes variables as a \"bytes\" object. Its structure is: {\"pack\": [{FORMAT1: EXPR1}, {FORMAT2: EXPR2}, ...]} where FORMAT are format strings (described below), and EXPR are expressions. The return type of this form is a \"bytes\" object. The format strings are the same as the \"unpack\" case, with one additional format. Format Result PFA type raw any number of bytes \"bytes\"","title":"Encoding values in binary (pack)"},{"location":"special-forms/type-safe-casting/#example_4","text":"This serializes three variables. 1 2 3 { \"pack\" : [{ \"int32\" : \"input.x\" }, { \"float64\" : \"input.y\" }, { \"null terminated\" : \"input.z\" }]} Source Data Mining Group Website","title":"Example"},{"location":"tutorials/elementary-example/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); The below example has three parts: an input type schema, an output type schema, and a list of expressions to compute, returning the last one (or in this case, the only one). These are the only required top-level fields. In [1]: from titus.genpy import PFAEngine Simple PFA Document from YAML string \u00b6 In [2]: pfaYAMLDocument = \"\"\" input: double output: double action: - {+: [input, 100]}\"\"\" The action routine is called once for every input datum, and a symbol(variable) named input references that datum. The above action calls the + function and passes input and 100 as arguments: {\"+\": [\"input\", 100]} . Much like Lisp, PFA has no infix operators \u2014 everything is laid out as a syntax tree in Polish notation. You can write the PFA document in JSON or YAML or PrettyPFA. Initializing the Scoring Engine \u00b6 In [3]: engine , = PFAEngine . fromYaml ( pfaYAMLDocument ) Viewing Engine Configuration \u00b6 In [4]: engine . config Out[4]: EngineConfig(name=Engine_1, method=map, inputPlaceholder=\"double\", outputPlaceholder=\"double\", begin=[], action=[Call('+', [Ref('input'), LiteralInt(100)])], end=[], fcns={}, zero=None, merge=None, cells={}, pools={}, randseed=None, doc=None, version=None, metadata={}, options={}) Simple PFA Document from JSON \u00b6 The PFA Document can also be provided as a stringified JSON. In [5]: pfaJSONDocument = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"action\": [ {\"+\": [\"input\", 100]} ] } \"\"\" engine2 , = PFAEngine . fromJson ( pfaJSONDocument ) In [6]: engine2 . config Out[6]: EngineConfig(name=Engine_2, method=map, inputPlaceholder=\"double\", outputPlaceholder=\"double\", begin=[], action=[Call('+', [Ref('input'), LiteralInt(100)])], end=[], fcns={}, zero=None, merge=None, cells={}, pools={}, randseed=None, doc=None, version=None, metadata={}, options={}) Scoring Engine in Action \u00b6 In [7]: l = [ 1.0 , 2.0 , 3.0 , 4.0 , 5.0 ] for n in l : print ( n , engine . action ( n ), engine2 . action ( n )) 1.0 101.0 101.0 2.0 102.0 102.0 3.0 103.0 103.0 4.0 104.0 104.0 5.0 105.0 105.0","title":"Elementary Example"},{"location":"tutorials/elementary-example/#simple-pfa-document-from-yaml-string","text":"In [2]: pfaYAMLDocument = \"\"\" input: double output: double action: - {+: [input, 100]}\"\"\" The action routine is called once for every input datum, and a symbol(variable) named input references that datum. The above action calls the + function and passes input and 100 as arguments: {\"+\": [\"input\", 100]} . Much like Lisp, PFA has no infix operators \u2014 everything is laid out as a syntax tree in Polish notation. You can write the PFA document in JSON or YAML or PrettyPFA.","title":"Simple PFA Document from YAML string"},{"location":"tutorials/elementary-example/#initializing-the-scoring-engine","text":"In [3]: engine , = PFAEngine . fromYaml ( pfaYAMLDocument )","title":"Initializing the Scoring Engine"},{"location":"tutorials/elementary-example/#viewing-engine-configuration","text":"In [4]: engine . config Out[4]: EngineConfig(name=Engine_1, method=map, inputPlaceholder=\"double\", outputPlaceholder=\"double\", begin=[], action=[Call('+', [Ref('input'), LiteralInt(100)])], end=[], fcns={}, zero=None, merge=None, cells={}, pools={}, randseed=None, doc=None, version=None, metadata={}, options={})","title":"Viewing Engine Configuration"},{"location":"tutorials/elementary-example/#simple-pfa-document-from-json","text":"The PFA Document can also be provided as a stringified JSON. In [5]: pfaJSONDocument = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"action\": [ {\"+\": [\"input\", 100]} ] } \"\"\" engine2 , = PFAEngine . fromJson ( pfaJSONDocument ) In [6]: engine2 . config Out[6]: EngineConfig(name=Engine_2, method=map, inputPlaceholder=\"double\", outputPlaceholder=\"double\", begin=[], action=[Call('+', [Ref('input'), LiteralInt(100)])], end=[], fcns={}, zero=None, merge=None, cells={}, pools={}, randseed=None, doc=None, version=None, metadata={}, options={})","title":"Simple PFA Document from JSON"},{"location":"tutorials/elementary-example/#scoring-engine-in-action","text":"In [7]: l = [ 1.0 , 2.0 , 3.0 , 4.0 , 5.0 ] for n in l : print ( n , engine . action ( n ), engine2 . action ( n )) 1.0 101.0 101.0 2.0 102.0 102.0 3.0 103.0 103.0 4.0 104.0 104.0 5.0 105.0 105.0","title":"Scoring Engine in Action"},{"location":"tutorials/exoplanets/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); This engine finds the coldest planet orbiting each star in the exoplanets dataset, with contingencies for missing data. The data are 1783 extrasolar planets, downloaded in April 2014 from exoplanet.eu . The dataset has a two-level taxonomy: it is a collection of stars and each star has one or more planets. All of the numerical data for stars and planets are nullable (missing data is common in planet-hunting). A few fields are strings (names and spectral type), one is an enumerated category (detection type), and one is an array of strings (molecules discovered in the planet\u2019s atmosphere). In [1]: from avro.datafile import DataFileReader from avro.io import DatumReader import pandas as pd from titus import prettypfa In [2]: exoplanetsIter = DataFileReader ( open ( \"../../assets/exoplanets.avro\" , \"rb\" ), DatumReader ()) exoplanets = list ( exoplanetsIter ) print ( len ( exoplanets )) 1103 Pandas Analysis \u00b6 In [3]: df = pd . DataFrame ( exoplanets ) df = df [[ \"name\" , \"planets\" , \"radius\" , \"temp\" ]] df . head () Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name planets radius temp 0 Kepler-207 [{'name': 'Kepler-207 b', 'detection': 'transi... 1.59 5920.0 1 HD 89307 [{'name': 'HD 89307 b', 'detection': 'radial_v... 1.05 5950.0 2 Kepler-197 [{'name': 'Kepler-197 b', 'detection': 'transi... 1.12 6004.0 3 Kepler-380 [{'name': 'Kepler-380 b', 'detection': 'transi... 1.22 6045.0 4 HD 11964 [{'name': 'HD 11964 b', 'detection': 'radial_v... 2.18 5248.0 In [4]: exoplanets [ 0 ] Out[4]: {'name': 'Kepler-207', 'ra': 290.0305176, 'dec': 42.16605, 'mag': None, 'dist': None, 'mass': None, 'radius': 1.59, 'age': None, 'temp': 5920.0, 'type': '', 'planets': [{'name': 'Kepler-207 b', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.14, 'period': 1.611865, 'max_distance': 0.029, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}, {'name': 'Kepler-207 c', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.134, 'period': 3.071571, 'max_distance': 0.044, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}, {'name': 'Kepler-207 d', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.295, 'period': 5.868075, 'max_distance': 0.068, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}]} In [5]: res = [] for row in exoplanets : planets = row [ \"planets\" ] min_t = None coldest_planet = None for planet in planets : p_t = planet [ \"temperature\" ] if p_t is None : if row [ \"radius\" ] is None or planet [ \"max_distance\" ] is None or row [ \"temp\" ] is None : continue star_t = row [ \"temp\" ] star_r = row [ \"radius\" ] * 695800.0 p_t = star_t / (( planet [ \"max_distance\" ] * 149600000.0 ) / star_r ) ** 2.0 if min_t is None : min_t = p_t coldest_planet = planet [ \"name\" ] elif p_t < min_t : min_t = p_t coldest_planet = planet [ \"name\" ] if coldest_planet is not None and min_t is not None : res . append ([ coldest_planet , min_t ]) pd . DataFrame ( res , columns = [ \"name\" , \"temp\" ])[[ \"temp\" ]] . describe () Out[5]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } temp count 848.000000 mean 49.717466 std 157.097385 min 0.000001 25% 0.726941 50% 5.008571 75% 35.665890 max 2750.000000 In [6]: pd . DataFrame ( res , columns = [ \"name\" , \"temp\" ]) . sort_values ( by = [ \"temp\" ]) Out[6]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name temp 79 1RXS1609 b 0.000001 639 2M 2206-20 b 0.000031 540 2M 2140+16 b 0.000040 72 2M 0746+20 b 0.000045 15 Fomalhaut b 0.000048 ... ... ... 197 HAT-P-12 b 1000.000000 674 HD 95086 b 1000.000000 732 2M 0122-2439 b 1380.000000 209 kappa And b 1900.000000 12 Kepler-13 b 2750.000000 848 rows \u00d7 2 columns PrettyPFA Example \u00b6 In [7]: pfadoc = ''' types: Planet = record( name: string, // Name of the planet detection: // Discovery technique enum([astrometry, imaging, microlensing, pulsar, radial_velocity, transit, ttv, OTHER]), discovered: string, // Year of discovery updated: string, // Date of last update mass: union(double, null), // Mass over Jupiter's mass radius: union(double, null), // Radius over Jupiter's period: union(double, null), // Planet year (Earth days) max_distance: union(double, null), // Distance from star (AU) eccentricity: union(double, null), // (0 = circle, 1 = escapes) temperature: union(double, null), // Temperature (Kelvin) temp_measured: union(boolean, null), // True if the measured molecules: array(string) // Molecules observed ); Star = record( name: string, // Name of the star ra: union(double, null), // Right ascension (degrees) dec: union(double, null), // Declination (degrees) mag: union(double, null), // Magnitude (unitless) dist: union(double, null), // Distance away (parsecs) mass: union(double, null), // Mass over Sun's mass radius: union(double, null), // Radius over Sun's radius age: union(double, null), // Age (billions of years) temp: union(double, null), // Temperature (Kelvin) type: union(string, null), // Spectral type planets: array(Planet) // Orbiting planets ); PlanetWithTemp = record(planet: string, temp: double) input: Star output: PlanetWithTemp method: emit action: var star = input; // name the input for convenience // build up a list of planets with temperature estimates var pt = json(array(PlanetWithTemp), []); foreach (planet: star.planets, seq: true) { var temp = ifnotnull(t: planet.temperature) // if a planet's temperature is already defined, use it t else { // otherwise, estimate it from the star ifnotnull(t: star.temp, r: star.radius, d: planet.max_distance) { var r_in_km = r * 695800.0; var d_in_km = d * 149600000.0; t / (d_in_km/r_in_km)**2 } else // third case: not enough data to make any estimate null }; // if the above resulted in an estimate, add it to the list ifnotnull(t: temp) { pt = a.append(pt, new(PlanetWithTemp, planet: planet.name, temp: t)) } }; // if the list is not empty... if (a.len(pt) > 0) { // find the coldest planet var coldest = a.minLT(pt, fcn(x: PlanetWithTemp, y: PlanetWithTemp -> boolean) { x.temp < y.temp }); // and emit it as the result of this scoring engine emit(coldest) } ''' In [8]: engine , = prettypfa . engine ( pfadoc ) In [9]: engine . config . method Out[9]: 'emit' In [10]: res = [] def emit ( x ): res . append ( x ) engine . emit = emit In [11]: for star in exoplanets : engine . action ( star ) In [12]: pd . DataFrame ( res )[[ \"temp\" ]] . describe () Out[12]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } temp count 848.000000 mean 49.717466 std 157.097385 min 0.000001 25% 0.726941 50% 5.008571 75% 35.665890 max 2750.000000 Persisting Results in Cells \u00b6 In [13]: engine , = prettypfa . engine ( ''' types: Planet = record( name: string, // Name of the planet detection: // Discovery technique enum([astrometry, imaging, microlensing, pulsar, radial_velocity, transit, ttv, OTHER]), discovered: string, // Year of discovery updated: string, // Date of last update mass: union(double, null), // Mass over Jupiter's mass radius: union(double, null), // Radius over Jupiter's period: union(double, null), // Planet year (Earth days) max_distance: union(double, null), // Distance from star (AU) eccentricity: union(double, null), // (0 = circle, 1 = escapes) temperature: union(double, null), // Temperature (Kelvin) temp_measured: union(boolean, null), // True if the measured molecules: array(string) // Molecules observed ); Star = record( name: string, // Name of the star ra: union(double, null), // Right ascension (degrees) dec: union(double, null), // Declination (degrees) mag: union(double, null), // Magnitude (unitless) dist: union(double, null), // Distance away (parsecs) mass: union(double, null), // Mass over Sun's mass radius: union(double, null), // Radius over Sun's radius age: union(double, null), // Age (billions of years) temp: union(double, null), // Temperature (Kelvin) type: union(string, null), // Spectral type planets: array(Planet) // Orbiting planets ); PlanetWithTemp = record(planet: Planet, temp: double) input: Star output: string cells: // someNumber(double) = 3.14; coldestPlanet(record(temp: union(double, null), name: string)) = { temp: null, name: \"\" }; // somethingElse(type: PreviouslyDeclaredType, // shared: true) = []; // someCell(int) = 12 //pools: // somePool(int) = {one: 12, two: 12, three: 12} method: emit end: emit(coldestPlanet.name) action: var star = input; // name the input for convenience // build up a list of planets with temperature estimates var pt = json(array(PlanetWithTemp), []); foreach (planet: star.planets, seq: true) { var temp = ifnotnull(t: planet.temperature) // if a planet's temperature is already defined, use it t else { // otherwise, estimate it from the star ifnotnull(t: star.temp, r: star.radius, d: planet.max_distance) { var r_in_km = r * 695800.0; var d_in_km = d * 149600000.0; t / (d_in_km/r_in_km)**2 } else // third case: not enough data to make any estimate null }; // if the above resulted in an estimate, add it to the list ifnotnull(t: temp) { pt = a.append(pt, new(PlanetWithTemp, planet: planet, temp: t)) } }; // if the list is not empty... if (a.len(pt) > 0) { // find the coldest planet var coldest = a.minLT(pt, fcn(x: PlanetWithTemp, y: PlanetWithTemp -> boolean) { x.temp < y.temp }); if(coldestPlanet.temp == null){ coldestPlanet.temp = coldest.temp; coldestPlanet.name = coldest.planet.name }; if(coldest.temp <= coldestPlanet.temp){ coldestPlanet.temp = coldest.temp; coldestPlanet.name = coldest.planet.name; emit(coldestPlanet.name) } }; ''' ) In [14]: res = [] def emit ( x ): res . append ( x ) engine . emit = emit for star in exoplanets : engine . action ( star ) In [15]: res Out[15]: ['Kepler-207 d', 'HD 89307 b', 'Fomalhaut b', '2M 0746+20 b', '1RXS1609 b'] In [16]: engine . end () In [17]: res Out[17]: ['Kepler-207 d', 'HD 89307 b', 'Fomalhaut b', '2M 0746+20 b', '1RXS1609 b', '1RXS1609 b']","title":"Exoplanets Example"},{"location":"tutorials/exoplanets/#pandas-analysis","text":"In [3]: df = pd . DataFrame ( exoplanets ) df = df [[ \"name\" , \"planets\" , \"radius\" , \"temp\" ]] df . head () Out[3]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name planets radius temp 0 Kepler-207 [{'name': 'Kepler-207 b', 'detection': 'transi... 1.59 5920.0 1 HD 89307 [{'name': 'HD 89307 b', 'detection': 'radial_v... 1.05 5950.0 2 Kepler-197 [{'name': 'Kepler-197 b', 'detection': 'transi... 1.12 6004.0 3 Kepler-380 [{'name': 'Kepler-380 b', 'detection': 'transi... 1.22 6045.0 4 HD 11964 [{'name': 'HD 11964 b', 'detection': 'radial_v... 2.18 5248.0 In [4]: exoplanets [ 0 ] Out[4]: {'name': 'Kepler-207', 'ra': 290.0305176, 'dec': 42.16605, 'mag': None, 'dist': None, 'mass': None, 'radius': 1.59, 'age': None, 'temp': 5920.0, 'type': '', 'planets': [{'name': 'Kepler-207 b', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.14, 'period': 1.611865, 'max_distance': 0.029, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}, {'name': 'Kepler-207 c', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.134, 'period': 3.071571, 'max_distance': 0.044, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}, {'name': 'Kepler-207 d', 'detection': 'transit', 'discovered': '2014', 'updated': '2014-03-06', 'mass': None, 'radius': 0.295, 'period': 5.868075, 'max_distance': 0.068, 'eccentricity': None, 'temperature': None, 'temp_measured': True, 'molecules': []}]} In [5]: res = [] for row in exoplanets : planets = row [ \"planets\" ] min_t = None coldest_planet = None for planet in planets : p_t = planet [ \"temperature\" ] if p_t is None : if row [ \"radius\" ] is None or planet [ \"max_distance\" ] is None or row [ \"temp\" ] is None : continue star_t = row [ \"temp\" ] star_r = row [ \"radius\" ] * 695800.0 p_t = star_t / (( planet [ \"max_distance\" ] * 149600000.0 ) / star_r ) ** 2.0 if min_t is None : min_t = p_t coldest_planet = planet [ \"name\" ] elif p_t < min_t : min_t = p_t coldest_planet = planet [ \"name\" ] if coldest_planet is not None and min_t is not None : res . append ([ coldest_planet , min_t ]) pd . DataFrame ( res , columns = [ \"name\" , \"temp\" ])[[ \"temp\" ]] . describe () Out[5]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } temp count 848.000000 mean 49.717466 std 157.097385 min 0.000001 25% 0.726941 50% 5.008571 75% 35.665890 max 2750.000000 In [6]: pd . DataFrame ( res , columns = [ \"name\" , \"temp\" ]) . sort_values ( by = [ \"temp\" ]) Out[6]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } name temp 79 1RXS1609 b 0.000001 639 2M 2206-20 b 0.000031 540 2M 2140+16 b 0.000040 72 2M 0746+20 b 0.000045 15 Fomalhaut b 0.000048 ... ... ... 197 HAT-P-12 b 1000.000000 674 HD 95086 b 1000.000000 732 2M 0122-2439 b 1380.000000 209 kappa And b 1900.000000 12 Kepler-13 b 2750.000000 848 rows \u00d7 2 columns","title":"Pandas Analysis"},{"location":"tutorials/exoplanets/#prettypfa-example","text":"In [7]: pfadoc = ''' types: Planet = record( name: string, // Name of the planet detection: // Discovery technique enum([astrometry, imaging, microlensing, pulsar, radial_velocity, transit, ttv, OTHER]), discovered: string, // Year of discovery updated: string, // Date of last update mass: union(double, null), // Mass over Jupiter's mass radius: union(double, null), // Radius over Jupiter's period: union(double, null), // Planet year (Earth days) max_distance: union(double, null), // Distance from star (AU) eccentricity: union(double, null), // (0 = circle, 1 = escapes) temperature: union(double, null), // Temperature (Kelvin) temp_measured: union(boolean, null), // True if the measured molecules: array(string) // Molecules observed ); Star = record( name: string, // Name of the star ra: union(double, null), // Right ascension (degrees) dec: union(double, null), // Declination (degrees) mag: union(double, null), // Magnitude (unitless) dist: union(double, null), // Distance away (parsecs) mass: union(double, null), // Mass over Sun's mass radius: union(double, null), // Radius over Sun's radius age: union(double, null), // Age (billions of years) temp: union(double, null), // Temperature (Kelvin) type: union(string, null), // Spectral type planets: array(Planet) // Orbiting planets ); PlanetWithTemp = record(planet: string, temp: double) input: Star output: PlanetWithTemp method: emit action: var star = input; // name the input for convenience // build up a list of planets with temperature estimates var pt = json(array(PlanetWithTemp), []); foreach (planet: star.planets, seq: true) { var temp = ifnotnull(t: planet.temperature) // if a planet's temperature is already defined, use it t else { // otherwise, estimate it from the star ifnotnull(t: star.temp, r: star.radius, d: planet.max_distance) { var r_in_km = r * 695800.0; var d_in_km = d * 149600000.0; t / (d_in_km/r_in_km)**2 } else // third case: not enough data to make any estimate null }; // if the above resulted in an estimate, add it to the list ifnotnull(t: temp) { pt = a.append(pt, new(PlanetWithTemp, planet: planet.name, temp: t)) } }; // if the list is not empty... if (a.len(pt) > 0) { // find the coldest planet var coldest = a.minLT(pt, fcn(x: PlanetWithTemp, y: PlanetWithTemp -> boolean) { x.temp < y.temp }); // and emit it as the result of this scoring engine emit(coldest) } ''' In [8]: engine , = prettypfa . engine ( pfadoc ) In [9]: engine . config . method Out[9]: 'emit' In [10]: res = [] def emit ( x ): res . append ( x ) engine . emit = emit In [11]: for star in exoplanets : engine . action ( star ) In [12]: pd . DataFrame ( res )[[ \"temp\" ]] . describe () Out[12]: .dataframe tbody tr th:only-of-type { vertical-align: middle; } .dataframe tbody tr th { vertical-align: top; } .dataframe thead th { text-align: right; } temp count 848.000000 mean 49.717466 std 157.097385 min 0.000001 25% 0.726941 50% 5.008571 75% 35.665890 max 2750.000000","title":"PrettyPFA Example"},{"location":"tutorials/exoplanets/#persisting-results-in-cells","text":"In [13]: engine , = prettypfa . engine ( ''' types: Planet = record( name: string, // Name of the planet detection: // Discovery technique enum([astrometry, imaging, microlensing, pulsar, radial_velocity, transit, ttv, OTHER]), discovered: string, // Year of discovery updated: string, // Date of last update mass: union(double, null), // Mass over Jupiter's mass radius: union(double, null), // Radius over Jupiter's period: union(double, null), // Planet year (Earth days) max_distance: union(double, null), // Distance from star (AU) eccentricity: union(double, null), // (0 = circle, 1 = escapes) temperature: union(double, null), // Temperature (Kelvin) temp_measured: union(boolean, null), // True if the measured molecules: array(string) // Molecules observed ); Star = record( name: string, // Name of the star ra: union(double, null), // Right ascension (degrees) dec: union(double, null), // Declination (degrees) mag: union(double, null), // Magnitude (unitless) dist: union(double, null), // Distance away (parsecs) mass: union(double, null), // Mass over Sun's mass radius: union(double, null), // Radius over Sun's radius age: union(double, null), // Age (billions of years) temp: union(double, null), // Temperature (Kelvin) type: union(string, null), // Spectral type planets: array(Planet) // Orbiting planets ); PlanetWithTemp = record(planet: Planet, temp: double) input: Star output: string cells: // someNumber(double) = 3.14; coldestPlanet(record(temp: union(double, null), name: string)) = { temp: null, name: \"\" }; // somethingElse(type: PreviouslyDeclaredType, // shared: true) = []; // someCell(int) = 12 //pools: // somePool(int) = {one: 12, two: 12, three: 12} method: emit end: emit(coldestPlanet.name) action: var star = input; // name the input for convenience // build up a list of planets with temperature estimates var pt = json(array(PlanetWithTemp), []); foreach (planet: star.planets, seq: true) { var temp = ifnotnull(t: planet.temperature) // if a planet's temperature is already defined, use it t else { // otherwise, estimate it from the star ifnotnull(t: star.temp, r: star.radius, d: planet.max_distance) { var r_in_km = r * 695800.0; var d_in_km = d * 149600000.0; t / (d_in_km/r_in_km)**2 } else // third case: not enough data to make any estimate null }; // if the above resulted in an estimate, add it to the list ifnotnull(t: temp) { pt = a.append(pt, new(PlanetWithTemp, planet: planet, temp: t)) } }; // if the list is not empty... if (a.len(pt) > 0) { // find the coldest planet var coldest = a.minLT(pt, fcn(x: PlanetWithTemp, y: PlanetWithTemp -> boolean) { x.temp < y.temp }); if(coldestPlanet.temp == null){ coldestPlanet.temp = coldest.temp; coldestPlanet.name = coldest.planet.name }; if(coldest.temp <= coldestPlanet.temp){ coldestPlanet.temp = coldest.temp; coldestPlanet.name = coldest.planet.name; emit(coldestPlanet.name) } }; ''' ) In [14]: res = [] def emit ( x ): res . append ( x ) engine . emit = emit for star in exoplanets : engine . action ( star ) In [15]: res Out[15]: ['Kepler-207 d', 'HD 89307 b', 'Fomalhaut b', '2M 0746+20 b', '1RXS1609 b'] In [16]: engine . end () In [17]: res Out[17]: ['Kepler-207 d', 'HD 89307 b', 'Fomalhaut b', '2M 0746+20 b', '1RXS1609 b', '1RXS1609 b']","title":"Persisting Results in Cells"},{"location":"tutorials/persistent-storage/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); A PFA scoring engine has four types of persistent storage: cells (private) cells (shared) pools (private) pools (shared) These storage areas are like local symbols in that they store Avro-typed data, but they are unlike local symbols in that they have global scope and are remembered between action invocations, and between the begin and end. Cells vs Pools both persistent storage and can be shared cells are global variables that cannot be created or destroyed at runtime (only reassigned) pools are like environments in R: collections of key-value pairs that can be created and destroyed at runtime, and the granularity of concurrent access is at the level of a single pool item. Cells and pools are both specified as JSON objects with the same fields, though init is required for cells and not for pools. In [1]: from titus.genpy import PFAEngine pfa = \"\"\" input: string output: string cells: longest: {type: string, init: \"\"} action: - if: \">\": - {s.len: input} - {s.len: {cell: longest}} then: - {cell: longest, to: input} - input else: - {cell: longest} \"\"\" engine , = PFAEngine . fromYaml ( pfa ) In [2]: engine . action ( \"abc\" ) Out[2]: 'abc' In [3]: engine . action ( \"abcdf\" ) Out[3]: 'abcdf' In [4]: engine . action ( \"abc\" ) Out[4]: 'abcdf' Notes Cells store individual, named values of a specific type. The scoring engine above reproduces the fold-method example by storing the tally in a cell of type string. It is somewhat more cumbersome to use a persistent cell rather than the fold method, but a few interacting cells can perform more complex tasks than the fold method alone. (Later example) Cells cannot be created or destroyed at runtime, and they must be initialized before the begin method. In the above case, the initial value is an empty string. Pools are persistent storage elements without this restriction. They can be used to gather data into tables.","title":"Persistent Storage - Cells and Pools"},{"location":"tutorials/pfa-document-structure/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); A PFA document is a JSON/YAML document with additional constraints. The JSON/YAML content describes algorithms, data types, model parameters, and other aspects of the scoring engine. Some structures have no effect on the scoring procedure and are only intended for archival purposes. Read the Full Specification here In [1]: from titus.genpy import PFAEngine input, output and action \u00b6 YAML In [2]: pfa_yml = \"\"\" input: int output: int action: input \"\"\" engine , = PFAEngine . fromYaml ( pfa_yml ) engine . action ( 1 ) Out[2]: 1 JSON In [3]: pfa_json = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"action\": \"input\" } \"\"\" engine , = PFAEngine . fromJson ( pfa_json ) engine . action ( 1 ) Out[3]: 1 method, zero and merge \u00b6 PFA supports 3 methods: map emit fold 1. Map \u00b6 Map method is simply a mathematical function: one input yields one output. YAML In [4]: pfa_yml = \"\"\" input: double output: double method: map action: - {m.sqrt: input}\"\"\" engine , = PFAEngine . fromYaml ( pfa_yml ) print ( engine . action ( 2.0 )) 1.4142135623730951 JSON In [5]: pfa_json = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"method\": \"map\", \"action\": [ {\"m.sqrt\": \"input\"} ] } \"\"\" engine , = PFAEngine . fromJson ( pfa_json ) print ( engine . action ( 2.0 )) 1.4142135623730951 2. Emit \u00b6 Of the three types of PFA scoring engine (map, emit, and fold), emit requires special attention in scoring. Map and fold engines yield results as the return value of the function (and fold do so cumulatively), but emit engines always return None. The only way to get results from them is by passing a callback function. YAML In [6]: engine , = PFAEngine . fromYaml ( ''' input: double output: double method: emit action: - if: ==: [{\"%\": [input, 2]}, 0] then: - emit: input - emit: {/: [input, 2]} ''' ) def newEmit ( x ): print ( \"output:\" , x ) engine . emit = newEmit for x in range ( 1 , 6 ): print ( \"input:\" , x ) engine . action ( x ) input: 1 input: 2 output: 2.0 output: 1.0 input: 3 input: 4 output: 4.0 output: 2.0 input: 5 JSON In [7]: engine , = PFAEngine . fromJson ( ''' { \"input\": \"double\", \"output\": \"double\", \"method\": \"emit\", \"action\": [{ \"if\": { \"==\": [{ \"%\": [\"input\", 2] }, 0] }, \"then\": [{ \"emit\": \"input\" }, { \"emit\": { \"/\": [\"input\", 2] } }] }] } ''' ) def newEmit ( x ): print ( \"output:\" , x ) engine . emit = newEmit for x in range ( 1 , 6 ): print ( \"input:\" , x ) engine . action ( x ) input: 1 input: 2 output: 2.0 output: 1.0 input: 3 input: 4 output: 4.0 output: 2.0 input: 5 3. Fold \u00b6 Fold method is for aggregation. Rather than waiting till the end of the (potentially infinite) dataset, folding engines return a partial result with each call. The previous partial result becomes available to the next action as a symbol tally. If you are only interested in the total, ignore all but the last output. In [8]: engine , = PFAEngine . fromYaml ( ''' input: double output: double method: fold zero: 0 action: - {\"-\": [input, tally]} merge: - {\"+\": [tallyOne, tallyTwo]} ''' ) print ( engine . action ( 1 )) # 1-0 -> tally is now 1 after execution print ( engine . action ( 2 )) # 2-1 print ( engine . action ( 3 )) # 3-1 print ( engine . action ( 4 )) # 4-2 print ( engine . action ( 5 )) # 5-2 1.0 1.0 2.0 2.0 3.0 In [9]: engine , = PFAEngine . fromYaml ( ''' input: int output: string method: fold zero: \"\" action: - {s.concat: [tally, {s.int: input}]} merge: - {s.concat: [tallyOne, tallyTwo]} ''' ) print ( engine . action ( 1 )) print ( engine . action ( 2 )) print ( engine . action ( 3 )) print ( engine . action ( 4 )) print ( engine . action ( 5 )) 1 12 123 1234 12345 The zero and merge sections are required for fold engines, and must not be present in map or emit engines. begin, end, fncs, ranseed \u00b6 In [10]: pfa = \"\"\" { \"input\": \"string\", \"output\": {\"type\": \"array\", \"items\": \"string\"}, \"cells\": { \"accumulate\": {\"type\": {\"type\": \"array\", \"items\": \"string\"}, \"init\": []}}, \"method\": \"map\", \"begin\": {\"log\": {\"rand.gaussian\": [0.0, 1.0]}}, \"action\": {\"cell\": \"accumulate\", \"to\": {\"fcn\": \"u.addone\", \"fill\": {\"newitem\": \"input\"}}}, \"end\": {\"log\": {\"rand.choice\": {\"cell\": \"accumulate\"}}}, \"fcns\": {\"addone\": {\"params\": [{\"old\": {\"type\": \"array\", \"items\": \"string\"}}, {\"newitem\": \"string\"}], \"ret\": {\"type\": \"array\", \"items\": \"string\"}, \"do\": {\"a.append\": [\"old\", \"newitem\"]}}}, \"randseed\": 12345, \"name\": \"ExampleScoringEngine\", \"version\": 1, \"doc\": \"Doesn't do much.\", \"metadata\": {\"does\": \"notmuch\"}, \"options\": {\"timeout\": 1000} } \"\"\" engine , = PFAEngine . fromJson ( pfa ) engine . action ( \"abc\" ) Out[10]: ['abc'] Fibonacci in PFA (Recursion) \u00b6 In [11]: pfa = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"method\": \"map\", \"action\": [{\"u.fib\": [\"input\"]}], \"fcns\": { \"fib\": { \"params\": [{\"n\": \"int\"}], \"ret\": \"int\", \"do\": { \"cond\":[ {\"if\": {\"==\": [\"n\", 0]}, \"then\": 0}, {\"if\": {\"==\": [\"n\", 1]}, \"then\": 1}], \"else\": {\"+\": [ {\"u.fib\": [{\"-\": [\"n\", 1]}]}, {\"u.fib\": [{\"-\": [\"n\", 2]}]} ]} } } } } \"\"\" engine , = PFAEngine . fromJson ( pfa ) In [12]: engine . action ( 12 ) Out[12]: 144 Fibonacci in PFA (Loops) \u00b6 In [13]: pfa = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"method\": \"map\", \"action\": [{\"u.fib\": [\"input\"]}], \"fcns\": { \"fib\": { \"params\": [{\"n\": \"int\"}], \"ret\": \"int\", \"do\": [ {\"let\": {\"now\": 0, \"next\": 1}}, {\"for\": {\"i\": \"n\"}, \"while\": {\">\": [\"i\", 1]}, \"step\": {\"i\": {\"-\": [\"i\", 1]}}, \"do\": [ {\"let\": {\"tmp\": {\"+\": [\"now\", \"next\"]}}}, {\"set\": {\"now\": \"next\", \"next\": \"tmp\"}} ] }, {\"if\": {\"==\": [\"n\", 0]}, \"then\": 0, \"else\": \"next\"} ] } } } \"\"\" engine , = PFAEngine . fromJson ( pfa ) In [14]: engine . action ( 12 ) Out[14]: 144 begin and end \u00b6 In some cases, you may want to perform special actions at the beginning and end of a data stream. PFA has begin and end routines for this purpose. The begin and end routines do not accept input and do not return output; they only manipulate persistent storage. In [15]: engine . begin () engine . end () Locator Marks & Names \u00b6 Any JSON object in a PFA document may include \"@\" as a string-valued field. This string is used to provide a line number from the original source file so that errors can be traced back to their source. Following Avro convention, names of PFA identifiers start with [A-Za-z_] & subsequently contain only [A-Za-z0-9_]","title":"PFA Document Structure"},{"location":"tutorials/pfa-document-structure/#input-output-and-action","text":"YAML In [2]: pfa_yml = \"\"\" input: int output: int action: input \"\"\" engine , = PFAEngine . fromYaml ( pfa_yml ) engine . action ( 1 ) Out[2]: 1 JSON In [3]: pfa_json = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"action\": \"input\" } \"\"\" engine , = PFAEngine . fromJson ( pfa_json ) engine . action ( 1 ) Out[3]: 1","title":"input, output and action"},{"location":"tutorials/pfa-document-structure/#method-zero-and-merge","text":"PFA supports 3 methods: map emit fold","title":"method, zero and merge"},{"location":"tutorials/pfa-document-structure/#1-map","text":"Map method is simply a mathematical function: one input yields one output. YAML In [4]: pfa_yml = \"\"\" input: double output: double method: map action: - {m.sqrt: input}\"\"\" engine , = PFAEngine . fromYaml ( pfa_yml ) print ( engine . action ( 2.0 )) 1.4142135623730951 JSON In [5]: pfa_json = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"method\": \"map\", \"action\": [ {\"m.sqrt\": \"input\"} ] } \"\"\" engine , = PFAEngine . fromJson ( pfa_json ) print ( engine . action ( 2.0 )) 1.4142135623730951","title":"1. Map"},{"location":"tutorials/pfa-document-structure/#2-emit","text":"Of the three types of PFA scoring engine (map, emit, and fold), emit requires special attention in scoring. Map and fold engines yield results as the return value of the function (and fold do so cumulatively), but emit engines always return None. The only way to get results from them is by passing a callback function. YAML In [6]: engine , = PFAEngine . fromYaml ( ''' input: double output: double method: emit action: - if: ==: [{\"%\": [input, 2]}, 0] then: - emit: input - emit: {/: [input, 2]} ''' ) def newEmit ( x ): print ( \"output:\" , x ) engine . emit = newEmit for x in range ( 1 , 6 ): print ( \"input:\" , x ) engine . action ( x ) input: 1 input: 2 output: 2.0 output: 1.0 input: 3 input: 4 output: 4.0 output: 2.0 input: 5 JSON In [7]: engine , = PFAEngine . fromJson ( ''' { \"input\": \"double\", \"output\": \"double\", \"method\": \"emit\", \"action\": [{ \"if\": { \"==\": [{ \"%\": [\"input\", 2] }, 0] }, \"then\": [{ \"emit\": \"input\" }, { \"emit\": { \"/\": [\"input\", 2] } }] }] } ''' ) def newEmit ( x ): print ( \"output:\" , x ) engine . emit = newEmit for x in range ( 1 , 6 ): print ( \"input:\" , x ) engine . action ( x ) input: 1 input: 2 output: 2.0 output: 1.0 input: 3 input: 4 output: 4.0 output: 2.0 input: 5","title":"2. Emit"},{"location":"tutorials/pfa-document-structure/#3-fold","text":"Fold method is for aggregation. Rather than waiting till the end of the (potentially infinite) dataset, folding engines return a partial result with each call. The previous partial result becomes available to the next action as a symbol tally. If you are only interested in the total, ignore all but the last output. In [8]: engine , = PFAEngine . fromYaml ( ''' input: double output: double method: fold zero: 0 action: - {\"-\": [input, tally]} merge: - {\"+\": [tallyOne, tallyTwo]} ''' ) print ( engine . action ( 1 )) # 1-0 -> tally is now 1 after execution print ( engine . action ( 2 )) # 2-1 print ( engine . action ( 3 )) # 3-1 print ( engine . action ( 4 )) # 4-2 print ( engine . action ( 5 )) # 5-2 1.0 1.0 2.0 2.0 3.0 In [9]: engine , = PFAEngine . fromYaml ( ''' input: int output: string method: fold zero: \"\" action: - {s.concat: [tally, {s.int: input}]} merge: - {s.concat: [tallyOne, tallyTwo]} ''' ) print ( engine . action ( 1 )) print ( engine . action ( 2 )) print ( engine . action ( 3 )) print ( engine . action ( 4 )) print ( engine . action ( 5 )) 1 12 123 1234 12345 The zero and merge sections are required for fold engines, and must not be present in map or emit engines.","title":"3. Fold"},{"location":"tutorials/pfa-document-structure/#begin-end-fncs-ranseed","text":"In [10]: pfa = \"\"\" { \"input\": \"string\", \"output\": {\"type\": \"array\", \"items\": \"string\"}, \"cells\": { \"accumulate\": {\"type\": {\"type\": \"array\", \"items\": \"string\"}, \"init\": []}}, \"method\": \"map\", \"begin\": {\"log\": {\"rand.gaussian\": [0.0, 1.0]}}, \"action\": {\"cell\": \"accumulate\", \"to\": {\"fcn\": \"u.addone\", \"fill\": {\"newitem\": \"input\"}}}, \"end\": {\"log\": {\"rand.choice\": {\"cell\": \"accumulate\"}}}, \"fcns\": {\"addone\": {\"params\": [{\"old\": {\"type\": \"array\", \"items\": \"string\"}}, {\"newitem\": \"string\"}], \"ret\": {\"type\": \"array\", \"items\": \"string\"}, \"do\": {\"a.append\": [\"old\", \"newitem\"]}}}, \"randseed\": 12345, \"name\": \"ExampleScoringEngine\", \"version\": 1, \"doc\": \"Doesn't do much.\", \"metadata\": {\"does\": \"notmuch\"}, \"options\": {\"timeout\": 1000} } \"\"\" engine , = PFAEngine . fromJson ( pfa ) engine . action ( \"abc\" ) Out[10]: ['abc']","title":"begin, end, fncs, ranseed"},{"location":"tutorials/pfa-document-structure/#fibonacci-in-pfa-recursion","text":"In [11]: pfa = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"method\": \"map\", \"action\": [{\"u.fib\": [\"input\"]}], \"fcns\": { \"fib\": { \"params\": [{\"n\": \"int\"}], \"ret\": \"int\", \"do\": { \"cond\":[ {\"if\": {\"==\": [\"n\", 0]}, \"then\": 0}, {\"if\": {\"==\": [\"n\", 1]}, \"then\": 1}], \"else\": {\"+\": [ {\"u.fib\": [{\"-\": [\"n\", 1]}]}, {\"u.fib\": [{\"-\": [\"n\", 2]}]} ]} } } } } \"\"\" engine , = PFAEngine . fromJson ( pfa ) In [12]: engine . action ( 12 ) Out[12]: 144","title":"Fibonacci in PFA (Recursion)"},{"location":"tutorials/pfa-document-structure/#fibonacci-in-pfa-loops","text":"In [13]: pfa = \"\"\" { \"input\": \"int\", \"output\": \"int\", \"method\": \"map\", \"action\": [{\"u.fib\": [\"input\"]}], \"fcns\": { \"fib\": { \"params\": [{\"n\": \"int\"}], \"ret\": \"int\", \"do\": [ {\"let\": {\"now\": 0, \"next\": 1}}, {\"for\": {\"i\": \"n\"}, \"while\": {\">\": [\"i\", 1]}, \"step\": {\"i\": {\"-\": [\"i\", 1]}}, \"do\": [ {\"let\": {\"tmp\": {\"+\": [\"now\", \"next\"]}}}, {\"set\": {\"now\": \"next\", \"next\": \"tmp\"}} ] }, {\"if\": {\"==\": [\"n\", 0]}, \"then\": 0, \"else\": \"next\"} ] } } } \"\"\" engine , = PFAEngine . fromJson ( pfa ) In [14]: engine . action ( 12 ) Out[14]: 144","title":"Fibonacci in PFA (Loops)"},{"location":"tutorials/pfa-document-structure/#begin-and-end","text":"In some cases, you may want to perform special actions at the beginning and end of a data stream. PFA has begin and end routines for this purpose. The begin and end routines do not accept input and do not return output; they only manipulate persistent storage. In [15]: engine . begin () engine . end ()","title":"begin and end"},{"location":"tutorials/pfa-document-structure/#locator-marks-names","text":"Any JSON object in a PFA document may include \"@\" as a string-valued field. This string is used to provide a line number from the original source file so that errors can be traced back to their source. Following Avro convention, names of PFA identifiers start with [A-Za-z_] & subsequently contain only [A-Za-z0-9_]","title":"Locator Marks &amp; Names"},{"location":"tutorials/prettypfa-examples/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); PFA was designed for data processing. PrettyPFA provides a C-like syntax for PFA, with slight difference in syntax from mainstream progrmming languages. A PrettyPFA document is split into sections, each of which has different rules. The syntax of these sections resembles PFA in YAML. Not everything is built algorithmically in PFA; some parts of a PFA document, such as pre- and post-processing, are usually written by hand. For these parts, there are compilers that turn human-readable code into PFA. Below are some examples of building models using PrettyPFA. Link to complete PrettyPFA reference - https://github.com/opendatagroup/hadrian/wiki/PrettyPFA-Reference In [1]: from titus.genpy import PFAEngine from titus import prettypfa Finding Square Root \u00b6 In [2]: pfaDocument = prettypfa . jsonNode ( \"\"\" name: SquareRoot input: double output: union(double, null) action: if (input >= 0.0) m.sqrt(input) else null \"\"\" ) engine , = PFAEngine . fromJson ( pfaDocument ) In [3]: engine . action ( 5 ) Out[3]: 2.23606797749979 Rule Based Classification \u00b6 JSON \u00b6 In [4]: pfaDocument = \"\"\" { \"input\": { \"type\": \"record\", \"name\": \"Iris\", \"fields\": [ {\"name\": \"sepal_length_cm\", \"type\": \"double\"}, {\"name\": \"sepal_width_cm\", \"type\": \"double\"}, {\"name\": \"petal_length_cm\", \"type\": \"double\"}, {\"name\": \"petal_width_cm\", \"type\": \"double\"}, {\"name\": \"class\", \"type\": \"string\"} ] }, \"output\": \"string\", \"action\": [{ \"if\": {\"<\": [\"input.petal_length_cm\", 2.5]}, \"then\": {\"string\": \"Iris-setosa\"}, \"else\":{ \"if\": {\"<\": [\"input.petal_length_cm\", 4.8]}, \"then\": {\"string\": \"Iris-versicolor\"}, \"else\":{ \"if\": {\"<\": [\"input.petal_width_cm\", 1.7]}, \"then\": {\"string\": \"Iris-versicolor\"}, \"else\": {\"string\": \"Iris-virginica\"} } } }] } \"\"\" engine , = PFAEngine . fromJson ( pfaDocument ) In [5]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[5]: 'Iris-setosa' In [6]: import csv dataset = csv . reader ( open ( \"../../assets/iris.csv\" )) fields = next ( dataset ) numCorrect = 0.0 numTotal = 0.0 for datum in dataset : asRecord = dict ( zip ( fields , datum )) if engine . action ( asRecord ) == asRecord [ \"class\" ]: numCorrect += 1.0 numTotal += 1.0 print ( \"accuracy\" , numCorrect / numTotal ) accuracy 0.9533333333333334 PrettyPFA (Conditional Statements) \u00b6 In [7]: pfaDocument = prettypfa . jsonNode ( ''' input: record(sepal_length_cm: double, sepal_width_cm: double, petal_length_cm: double, petal_width_cm: double) output: string action: if (input.petal_length_cm < 2.5) \"Iris-setosa\" else if (input.petal_length_cm < 4.8) \"Iris-versicolor\" else if (input.petal_width_cm < 1.7) \"Iris-versicolor\" else \"Iris-virginica\" ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [8]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[8]: 'Iris-setosa' PrettyPFA (Rule Based) \u00b6 In [9]: pfaDocument = prettypfa . jsonNode ( ''' input: record(sepal_length_cm: double, sepal_width_cm: double, petal_length_cm: double, petal_width_cm: double) output: string types: Rules = array(record(field: string, cut: double, result: string)) cells: rules(Rules) = [ {field: \"petal_length_cm\", cut: 2.5, result: \"Iris-setosa\"}, {field: \"petal_length_cm\", cut: 4.8, result: \"Iris-versicolor\"}, {field: \"petal_width_cm\", cut: 1.7, result: \"Iris-versicolor\"}, {field: \"none\", cut: -1, result: \"Iris-virginica\"} ] action: var result = \"\"; for (index = 0; result == \"\"; index = index + 1) { var rule = rules[index]; var fieldValue = if (rule.field == \"sepal_length_cm\") input.sepal_length_cm else if (rule.field == \"sepal_width_cm\") input.sepal_width_cm else if (rule.field == \"petal_length_cm\") input.petal_length_cm else if (rule.field == \"petal_width_cm\") input.petal_width_cm else -1.0; if (rule.field == \"none\" || fieldValue < rule.cut) result = rule.result; }; result ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [10]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[10]: 'Iris-setosa' Quadratic Formula \u00b6 In [11]: pfaDocument = prettypfa . json ( ''' input: record(a: double, b: double, c: double) output: union(null, record(Output, solution1: double, solution2: double)) action: var a = input.a, b = input.b, c = input.c; var discriminant = b**2 - 4*a*c; if (discriminant >= 0.0) { // if there are any real solutions, return them var x1 = -b + m.sqrt(discriminant)/(2*a); var x2 = -b - m.sqrt(discriminant)/(2*a); new(Output, solution1: x1, solution2: x2) } else // otherwise, return null (N/A) null ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [12]: print ( engine . action ({ \"a\" : 1 , \"b\" : 8 , \"c\" : 4 })) {'solution1': -4.535898384862246, 'solution2': -11.464101615137753} In [13]: print ( engine . action ({ \"a\" : 1 , \"b\" : 2 , \"c\" : 3 })) None Applying Function \u00b6 In [14]: pfa = prettypfa . json ( \"\"\" input: enum([linear, square, cube]) output: int action: apply(input, 2) fcns: linear = fcn(x: int -> int) x; square = fcn(x: int -> int) x**2; cube = fcn(x: int -> int) x**3; \"\"\" ) engine , = PFAEngine . fromJson ( pfa ) In [15]: engine . action ( \"cube\" ) Out[15]: 8","title":"PrettyPFA"},{"location":"tutorials/prettypfa-examples/#finding-square-root","text":"In [2]: pfaDocument = prettypfa . jsonNode ( \"\"\" name: SquareRoot input: double output: union(double, null) action: if (input >= 0.0) m.sqrt(input) else null \"\"\" ) engine , = PFAEngine . fromJson ( pfaDocument ) In [3]: engine . action ( 5 ) Out[3]: 2.23606797749979","title":"Finding Square Root"},{"location":"tutorials/prettypfa-examples/#rule-based-classification","text":"","title":"Rule Based Classification"},{"location":"tutorials/prettypfa-examples/#json","text":"In [4]: pfaDocument = \"\"\" { \"input\": { \"type\": \"record\", \"name\": \"Iris\", \"fields\": [ {\"name\": \"sepal_length_cm\", \"type\": \"double\"}, {\"name\": \"sepal_width_cm\", \"type\": \"double\"}, {\"name\": \"petal_length_cm\", \"type\": \"double\"}, {\"name\": \"petal_width_cm\", \"type\": \"double\"}, {\"name\": \"class\", \"type\": \"string\"} ] }, \"output\": \"string\", \"action\": [{ \"if\": {\"<\": [\"input.petal_length_cm\", 2.5]}, \"then\": {\"string\": \"Iris-setosa\"}, \"else\":{ \"if\": {\"<\": [\"input.petal_length_cm\", 4.8]}, \"then\": {\"string\": \"Iris-versicolor\"}, \"else\":{ \"if\": {\"<\": [\"input.petal_width_cm\", 1.7]}, \"then\": {\"string\": \"Iris-versicolor\"}, \"else\": {\"string\": \"Iris-virginica\"} } } }] } \"\"\" engine , = PFAEngine . fromJson ( pfaDocument ) In [5]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[5]: 'Iris-setosa' In [6]: import csv dataset = csv . reader ( open ( \"../../assets/iris.csv\" )) fields = next ( dataset ) numCorrect = 0.0 numTotal = 0.0 for datum in dataset : asRecord = dict ( zip ( fields , datum )) if engine . action ( asRecord ) == asRecord [ \"class\" ]: numCorrect += 1.0 numTotal += 1.0 print ( \"accuracy\" , numCorrect / numTotal ) accuracy 0.9533333333333334","title":"JSON"},{"location":"tutorials/prettypfa-examples/#prettypfa-conditional-statements","text":"In [7]: pfaDocument = prettypfa . jsonNode ( ''' input: record(sepal_length_cm: double, sepal_width_cm: double, petal_length_cm: double, petal_width_cm: double) output: string action: if (input.petal_length_cm < 2.5) \"Iris-setosa\" else if (input.petal_length_cm < 4.8) \"Iris-versicolor\" else if (input.petal_width_cm < 1.7) \"Iris-versicolor\" else \"Iris-virginica\" ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [8]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[8]: 'Iris-setosa'","title":"PrettyPFA (Conditional Statements)"},{"location":"tutorials/prettypfa-examples/#prettypfa-rule-based","text":"In [9]: pfaDocument = prettypfa . jsonNode ( ''' input: record(sepal_length_cm: double, sepal_width_cm: double, petal_length_cm: double, petal_width_cm: double) output: string types: Rules = array(record(field: string, cut: double, result: string)) cells: rules(Rules) = [ {field: \"petal_length_cm\", cut: 2.5, result: \"Iris-setosa\"}, {field: \"petal_length_cm\", cut: 4.8, result: \"Iris-versicolor\"}, {field: \"petal_width_cm\", cut: 1.7, result: \"Iris-versicolor\"}, {field: \"none\", cut: -1, result: \"Iris-virginica\"} ] action: var result = \"\"; for (index = 0; result == \"\"; index = index + 1) { var rule = rules[index]; var fieldValue = if (rule.field == \"sepal_length_cm\") input.sepal_length_cm else if (rule.field == \"sepal_width_cm\") input.sepal_width_cm else if (rule.field == \"petal_length_cm\") input.petal_length_cm else if (rule.field == \"petal_width_cm\") input.petal_width_cm else -1.0; if (rule.field == \"none\" || fieldValue < rule.cut) result = rule.result; }; result ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [10]: engine . action ({ \"sepal_length_cm\" : 5.1 , \"sepal_width_cm\" : 3.5 , \"petal_length_cm\" : 1.4 , \"petal_width_cm\" : 0.2 , \"class\" : \"Iris-setosa\" }) Out[10]: 'Iris-setosa'","title":"PrettyPFA (Rule Based)"},{"location":"tutorials/prettypfa-examples/#quadratic-formula","text":"In [11]: pfaDocument = prettypfa . json ( ''' input: record(a: double, b: double, c: double) output: union(null, record(Output, solution1: double, solution2: double)) action: var a = input.a, b = input.b, c = input.c; var discriminant = b**2 - 4*a*c; if (discriminant >= 0.0) { // if there are any real solutions, return them var x1 = -b + m.sqrt(discriminant)/(2*a); var x2 = -b - m.sqrt(discriminant)/(2*a); new(Output, solution1: x1, solution2: x2) } else // otherwise, return null (N/A) null ''' ) engine , = PFAEngine . fromJson ( pfaDocument ) In [12]: print ( engine . action ({ \"a\" : 1 , \"b\" : 8 , \"c\" : 4 })) {'solution1': -4.535898384862246, 'solution2': -11.464101615137753} In [13]: print ( engine . action ({ \"a\" : 1 , \"b\" : 2 , \"c\" : 3 })) None","title":"Quadratic Formula"},{"location":"tutorials/prettypfa-examples/#applying-function","text":"In [14]: pfa = prettypfa . json ( \"\"\" input: enum([linear, square, cube]) output: int action: apply(input, 2) fcns: linear = fcn(x: int -> int) x; square = fcn(x: int -> int) x**2; cube = fcn(x: int -> int) x**3; \"\"\" ) engine , = PFAEngine . fromJson ( pfa ) In [15]: engine . action ( \"cube\" ) Out[15]: 8","title":"Applying Function"},{"location":"tutorials/using-built-in-functions/","text":"/*! * * IPython notebook * */ /* CSS font colors for translated ANSI escape sequences */ /* The color values are a mix of http://www.xcolors.net/dl/baskerville-ivorylight and http://www.xcolors.net/dl/euphrasia */ .ansi-black-fg { color: #3E424D; } .ansi-black-bg { background-color: #3E424D; } .ansi-black-intense-fg { color: #282C36; } .ansi-black-intense-bg { background-color: #282C36; } .ansi-red-fg { color: #E75C58; } .ansi-red-bg { background-color: #E75C58; } .ansi-red-intense-fg { color: #B22B31; } .ansi-red-intense-bg { background-color: #B22B31; } .ansi-green-fg { color: #00A250; } .ansi-green-bg { background-color: #00A250; } .ansi-green-intense-fg { color: #007427; } .ansi-green-intense-bg { background-color: #007427; } .ansi-yellow-fg { color: #DDB62B; } .ansi-yellow-bg { background-color: #DDB62B; } .ansi-yellow-intense-fg { color: #B27D12; } .ansi-yellow-intense-bg { background-color: #B27D12; } .ansi-blue-fg { color: #208FFB; } .ansi-blue-bg { background-color: #208FFB; } .ansi-blue-intense-fg { color: #0065CA; } .ansi-blue-intense-bg { background-color: #0065CA; } .ansi-magenta-fg { color: #D160C4; } .ansi-magenta-bg { background-color: #D160C4; } .ansi-magenta-intense-fg { color: #A03196; } .ansi-magenta-intense-bg { background-color: #A03196; } .ansi-cyan-fg { color: #60C6C8; } .ansi-cyan-bg { background-color: #60C6C8; } .ansi-cyan-intense-fg { color: #258F8F; } .ansi-cyan-intense-bg { background-color: #258F8F; } .ansi-white-fg { color: #C5C1B4; } .ansi-white-bg { background-color: #C5C1B4; } .ansi-white-intense-fg { color: #A1A6B2; } .ansi-white-intense-bg { background-color: #A1A6B2; } .ansi-default-inverse-fg { color: #FFFFFF; } .ansi-default-inverse-bg { background-color: #000000; } .ansi-bold { font-weight: bold; } .ansi-underline { text-decoration: underline; } /* The following styles are deprecated an will be removed in a future version */ .ansibold { font-weight: bold; } .ansi-inverse { outline: 0.5px dotted; } /* use dark versions for foreground, to improve visibility */ .ansiblack { color: black; } .ansired { color: darkred; } .ansigreen { color: darkgreen; } .ansiyellow { color: #c4a000; } .ansiblue { color: darkblue; } .ansipurple { color: darkviolet; } .ansicyan { color: steelblue; } .ansigray { color: gray; } /* and light for background, for the same reason */ .ansibgblack { background-color: black; } .ansibgred { background-color: red; } .ansibggreen { background-color: green; } .ansibgyellow { background-color: yellow; } .ansibgblue { background-color: blue; } .ansibgpurple { background-color: magenta; } .ansibgcyan { background-color: cyan; } .ansibggray { background-color: gray; } div.cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; border-radius: 2px; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; border-width: 1px; border-style: solid; border-color: transparent; width: 100%; padding: 5px; /* This acts as a spacer between cells, that is outside the border */ margin: 0px; outline: none; position: relative; overflow: visible; } div.cell:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: transparent; } div.cell.jupyter-soft-selected { border-left-color: #E3F2FD; border-left-width: 1px; padding-left: 5px; border-right-color: #E3F2FD; border-right-width: 1px; background: #E3F2FD; } @media print { div.cell.jupyter-soft-selected { border-color: transparent; } } div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: #ababab; } div.cell.selected:before, div.cell.selected.jupyter-soft-selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #42A5F5; } @media print { div.cell.selected, div.cell.selected.jupyter-soft-selected { border-color: transparent; } } .edit_mode div.cell.selected { border-color: #66BB6A; } .edit_mode div.cell.selected:before { position: absolute; display: block; top: -1px; left: -1px; width: 5px; height: calc(100% + 2px); content: ''; background: #66BB6A; } @media print { .edit_mode div.cell.selected { border-color: transparent; } } .prompt { /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */ min-width: 14ex; /* This padding is tuned to match the padding on the CodeMirror editor. */ padding: 0.4em; margin: 0px; font-family: monospace; text-align: right; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; /* Don't highlight prompt number selection */ -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; /* Use default cursor */ cursor: default; } @media (max-width: 540px) { .prompt { text-align: left; } } div.inner_cell { min-width: 0; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_area { border: 1px solid #cfcfcf; border-radius: 2px; background: #f7f7f7; line-height: 1.21429em; } /* This is needed so that empty prompt areas can collapse to zero height when there is no content in the output_subarea and the prompt. The main purpose of this is to make sure that empty JavaScript output_subareas have no height. */ div.prompt:empty { padding-top: 0; padding-bottom: 0; } div.unrecognized_cell { padding: 5px 5px 5px 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.unrecognized_cell .inner_cell { border-radius: 2px; padding: 5px; font-weight: bold; color: red; border: 1px solid #cfcfcf; background: #eaeaea; } div.unrecognized_cell .inner_cell a { color: inherit; text-decoration: none; } div.unrecognized_cell .inner_cell a:hover { color: inherit; text-decoration: none; } @media (max-width: 540px) { div.unrecognized_cell > div.prompt { display: none; } } div.code_cell { /* avoid page breaking on code cells when printing */ } @media print { div.code_cell { page-break-inside: avoid; } } /* any special styling for code cells that are currently running goes here */ div.input { page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.input { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } /* input_area and input_prompt must match in top border and margin for alignment */ div.input_prompt { color: #303F9F; border-top: 1px solid transparent; } div.input_area > div.highlight { margin: 0.4em; border: none; padding: 0px; background-color: transparent; } div.input_area > div.highlight > pre { margin: 0px; border: none; padding: 0px; background-color: transparent; } /* The following gets added to the <head> if it is detected that the user has a * monospace font with inconsistent normal/bold/italic height. See * notebookmain.js. Such fonts will have keywords vertically offset with * respect to the rest of the text. The user should select a better font. * See: https://github.com/ipython/ipython/issues/1503 * * .CodeMirror span { * vertical-align: bottom; * } */ .CodeMirror { line-height: 1.21429em; /* Changed from 1em to our global default */ font-size: 14px; height: auto; /* Changed to auto to autogrow */ background: none; /* Changed from white to allow our bg to show through */ } .CodeMirror-scroll { /* The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/ /* We have found that if it is visible, vertical scrollbars appear with font size changes.*/ overflow-y: hidden; overflow-x: auto; } .CodeMirror-lines { /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */ /* we have set a different line-height and want this to scale with that. */ /* Note that this should set vertical padding only, since CodeMirror assumes that horizontal padding will be set on CodeMirror pre */ padding: 0.4em 0; } .CodeMirror-linenumber { padding: 0 8px 0 4px; } .CodeMirror-gutters { border-bottom-left-radius: 2px; border-top-left-radius: 2px; } .CodeMirror pre { /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only, use .CodeMirror-lines for vertical */ padding: 0 0.4em; border: 0; border-radius: 0; } .CodeMirror-cursor { border-left: 1.4px solid black; } @media screen and (min-width: 2138px) and (max-width: 4319px) { .CodeMirror-cursor { border-left: 2px solid black; } } @media screen and (min-width: 4320px) { .CodeMirror-cursor { border-left: 4px solid black; } } /* Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org> Adapted from GitHub theme */ .highlight-base { color: #000; } .highlight-variable { color: #000; } .highlight-variable-2 { color: #1a1a1a; } .highlight-variable-3 { color: #333333; } .highlight-string { color: #BA2121; } .highlight-comment { color: #408080; font-style: italic; } .highlight-number { color: #080; } .highlight-atom { color: #88F; } .highlight-keyword { color: #008000; font-weight: bold; } .highlight-builtin { color: #008000; } .highlight-error { color: #f00; } .highlight-operator { color: #AA22FF; font-weight: bold; } .highlight-meta { color: #AA22FF; } /* previously not defined, copying from default codemirror */ .highlight-def { color: #00f; } .highlight-string-2 { color: #f50; } .highlight-qualifier { color: #555; } .highlight-bracket { color: #997; } .highlight-tag { color: #170; } .highlight-attribute { color: #00c; } .highlight-header { color: blue; } .highlight-quote { color: #090; } .highlight-link { color: #00c; } /* apply the same style to codemirror */ .cm-s-ipython span.cm-keyword { color: #008000; font-weight: bold; } .cm-s-ipython span.cm-atom { color: #88F; } .cm-s-ipython span.cm-number { color: #080; } .cm-s-ipython span.cm-def { color: #00f; } .cm-s-ipython span.cm-variable { color: #000; } .cm-s-ipython span.cm-operator { color: #AA22FF; font-weight: bold; } .cm-s-ipython span.cm-variable-2 { color: #1a1a1a; } .cm-s-ipython span.cm-variable-3 { color: #333333; } .cm-s-ipython span.cm-comment { color: #408080; font-style: italic; } .cm-s-ipython span.cm-string { color: #BA2121; } .cm-s-ipython span.cm-string-2 { color: #f50; } .cm-s-ipython span.cm-meta { color: #AA22FF; } .cm-s-ipython span.cm-qualifier { color: #555; } .cm-s-ipython span.cm-builtin { color: #008000; } .cm-s-ipython span.cm-bracket { color: #997; } .cm-s-ipython span.cm-tag { color: #170; } .cm-s-ipython span.cm-attribute { color: #00c; } .cm-s-ipython span.cm-header { color: blue; } .cm-s-ipython span.cm-quote { color: #090; } .cm-s-ipython span.cm-link { color: #00c; } .cm-s-ipython span.cm-error { color: #f00; } .cm-s-ipython span.cm-tab { background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=); background-position: right; background-repeat: no-repeat; } div.output_wrapper { /* this position must be relative to enable descendents to be absolute within it */ position: relative; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; z-index: 1; } /* class for the output area when it should be height-limited */ div.output_scroll { /* ideally, this would be max-height, but FF barfs all over that */ height: 24em; /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */ width: 100%; overflow: auto; border-radius: 2px; -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8); display: block; } /* output div while it is collapsed */ div.output_collapsed { margin: 0px; padding: 0px; /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } div.out_prompt_overlay { height: 100%; padding: 0px 0.4em; position: absolute; border-radius: 2px; } div.out_prompt_overlay:hover { /* use inner shadow to get border that is computed the same on WebKit/FF */ -webkit-box-shadow: inset 0 0 1px #000; box-shadow: inset 0 0 1px #000; background: rgba(240, 240, 240, 0.5); } div.output_prompt { color: #D84315; } /* This class is the outer container of all output sections. */ div.output_area { padding: 0px; page-break-inside: avoid; /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } div.output_area .MathJax_Display { text-align: left !important; } div.output_area div.output_area div.output_area img, div.output_area svg { max-width: 100%; height: auto; } div.output_area img.unconfined, div.output_area svg.unconfined { max-width: none; } div.output_area .mglyph > img { max-width: none; } /* This is needed to protect the pre formating from global settings such as that of bootstrap */ .output { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } @media (max-width: 540px) { div.output_area { /* Old browsers */ display: -webkit-box; -webkit-box-orient: vertical; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: vertical; -moz-box-align: stretch; display: box; box-orient: vertical; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: column; align-items: stretch; } } div.output_area pre { margin: 0; padding: 1px 0 1px 0; border: 0; vertical-align: baseline; color: black; background-color: transparent; border-radius: 0; } /* This class is for the output subarea inside the output_area and after the prompt div. */ div.output_subarea { overflow-x: auto; padding: 0.4em; /* Old browsers */ -webkit-box-flex: 1; -moz-box-flex: 1; box-flex: 1; /* Modern browsers */ flex: 1; max-width: calc(100% - 14ex); } div.output_scroll div.output_subarea { overflow-x: visible; } /* The rest of the output_* classes are for special styling of the different output types */ /* all text output has this class: */ div.output_text { text-align: left; color: #000; /* This has to match that of the the CodeMirror class line-height below */ line-height: 1.21429em; } /* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */ div.output_stderr { background: #fdd; /* very light red background for stderr */ } div.output_latex { text-align: left; } /* Empty output_javascript divs should have no height */ div.output_javascript:empty { padding: 0; } .js-error { color: darkred; } /* raw_input styles */ div.raw_input_container { line-height: 1.21429em; padding-top: 5px; } pre.raw_input_prompt { /* nothing needed here. */ } input.raw_input { font-family: monospace; font-size: inherit; color: inherit; width: auto; /* make sure input baseline aligns with prompt */ vertical-align: baseline; /* padding + margin = 0.5em between prompt and cursor */ padding: 0em 0.25em; margin: 0em 0.25em; } input.raw_input:focus { box-shadow: none; } p.p-space { margin-bottom: 10px; } div.output_unrecognized { padding: 5px; font-weight: bold; color: red; } div.output_unrecognized a { color: inherit; text-decoration: none; } div.output_unrecognized a:hover { color: inherit; text-decoration: none; } .rendered_html { color: #000; /* any extras will just be numbers: */ } .rendered_html :link { text-decoration: underline; } .rendered_html :visited { text-decoration: underline; } .rendered_html h1:first-child { margin-top: 0.538em; } .rendered_html h2:first-child { margin-top: 0.636em; } .rendered_html h3:first-child { margin-top: 0.777em; } .rendered_html h4:first-child { margin-top: 1em; } .rendered_html h5:first-child { margin-top: 1em; } .rendered_html h6:first-child { margin-top: 1em; } .rendered_html ul:not(.list-inline), .rendered_html ol:not(.list-inline) { padding-left: 2em; } .rendered_html * + ul { margin-top: 1em; } .rendered_html * + ol { margin-top: 1em; } .rendered_html pre, .rendered_html tr, .rendered_html th, .rendered_html tbody tr:nth-child(odd) { background: #f5f5f5; } .rendered_html tbody tr:hover { background: rgba(66, 165, 245, 0.2); } .rendered_html * + table { margin-top: 1em; } .rendered_html * + p { margin-top: 1em; } .rendered_html * + img { margin-top: 1em; } .rendered_html img, .rendered_html img.unconfined, .rendered_html * + .alert { margin-top: 1em; } [dir=\"rtl\"] div.text_cell { /* Old browsers */ display: -webkit-box; -webkit-box-orient: horizontal; -webkit-box-align: stretch; display: -moz-box; -moz-box-orient: horizontal; -moz-box-align: stretch; display: box; box-orient: horizontal; box-align: stretch; /* Modern browsers */ display: flex; flex-direction: row; align-items: stretch; } @media (max-width: 540px) { div.text_cell > div.prompt { display: none; } } div.text_cell_render { /*font-family: \"Helvetica Neue\", Arial, Helvetica, Geneva, sans-serif;*/ outline: none; resize: none; width: inherit; border-style: none; padding: 0.5em 0.5em 0.5em 0.4em; color: #000; box-sizing: border-box; -moz-box-sizing: border-box; -webkit-box-sizing: border-box; } a.anchor-link:link { text-decoration: none; padding: 0px 20px; visibility: hidden; } h1:hover .anchor-link, h2:hover .anchor-link, h3:hover .anchor-link, h4:hover .anchor-link, h5:hover .anchor-link, h6:hover .anchor-link { visibility: visible; } .text_cell.rendered .input_area { display: none; } .text_cell.rendered .text_cell.rendered .rendered_html tr, .text_cell.rendered .rendered_html th, .text_cell.rendered .text_cell.unrendered .text_cell_render { display: none; } .text_cell .dropzone .input_area { border: 2px dashed #bababa; margin: -1px; } .cm-header-1, .cm-header-2, .cm-header-3, .cm-header-4, .cm-header-5, .cm-header-6 { font-weight: bold; font-family: \"Helvetica Neue\", Helvetica, Arial, sans-serif; } .cm-header-1 { font-size: 185.7%; } .cm-header-2 { font-size: 157.1%; } .cm-header-3 { font-size: 128.6%; } .cm-header-4 { font-size: 110%; } .cm-header-5 { font-size: 100%; font-style: italic; } .cm-header-6 { font-size: 100%; font-style: italic; } .highlight-ipynb .hll { background-color: #ffffcc } .highlight-ipynb { background: #f8f8f8; } .highlight-ipynb .c { color: #408080; font-style: italic } /* Comment */ .highlight-ipynb .err { border: 1px solid #FF0000 } /* Error */ .highlight-ipynb .k { color: #008000; font-weight: bold } /* Keyword */ .highlight-ipynb .o { color: #666666 } /* Operator */ .highlight-ipynb .ch { color: #408080; font-style: italic } /* Comment.Hashbang */ .highlight-ipynb .cm { color: #408080; font-style: italic } /* Comment.Multiline */ .highlight-ipynb .cp { color: #BC7A00 } /* Comment.Preproc */ .highlight-ipynb .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */ .highlight-ipynb .c1 { color: #408080; font-style: italic } /* Comment.Single */ .highlight-ipynb .cs { color: #408080; font-style: italic } /* Comment.Special */ .highlight-ipynb .gd { color: #A00000 } /* Generic.Deleted */ .highlight-ipynb .ge { font-style: italic } /* Generic.Emph */ .highlight-ipynb .gr { color: #FF0000 } /* Generic.Error */ .highlight-ipynb .gh { color: #000080; font-weight: bold } /* Generic.Heading */ .highlight-ipynb .gi { color: #00A000 } /* Generic.Inserted */ .highlight-ipynb .go { color: #888888 } /* Generic.Output */ .highlight-ipynb .gp { color: #000080; font-weight: bold } /* Generic.Prompt */ .highlight-ipynb .gs { font-weight: bold } /* Generic.Strong */ .highlight-ipynb .gu { color: #800080; font-weight: bold } /* Generic.Subheading */ .highlight-ipynb .gt { color: #0044DD } /* Generic.Traceback */ .highlight-ipynb .kc { color: #008000; font-weight: bold } /* Keyword.Constant */ .highlight-ipynb .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */ .highlight-ipynb .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */ .highlight-ipynb .kp { color: #008000 } /* Keyword.Pseudo */ .highlight-ipynb .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */ .highlight-ipynb .kt { color: #B00040 } /* Keyword.Type */ .highlight-ipynb .m { color: #666666 } /* Literal.Number */ .highlight-ipynb .s { color: #BA2121 } /* Literal.String */ .highlight-ipynb .na { color: #7D9029 } /* Name.Attribute */ .highlight-ipynb .nb { color: #008000 } /* Name.Builtin */ .highlight-ipynb .nc { color: #0000FF; font-weight: bold } /* Name.Class */ .highlight-ipynb .no { color: #880000 } /* Name.Constant */ .highlight-ipynb .nd { color: #AA22FF } /* Name.Decorator */ .highlight-ipynb .ni { color: #999999; font-weight: bold } /* Name.Entity */ .highlight-ipynb .ne { color: #D2413A; font-weight: bold } /* Name.Exception */ .highlight-ipynb .nf { color: #0000FF } /* Name.Function */ .highlight-ipynb .nl { color: #A0A000 } /* Name.Label */ .highlight-ipynb .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */ .highlight-ipynb .nt { color: #008000; font-weight: bold } /* Name.Tag */ .highlight-ipynb .nv { color: #19177C } /* Name.Variable */ .highlight-ipynb .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */ .highlight-ipynb .w { color: #bbbbbb } /* Text.Whitespace */ .highlight-ipynb .mb { color: #666666 } /* Literal.Number.Bin */ .highlight-ipynb .mf { color: #666666 } /* Literal.Number.Float */ .highlight-ipynb .mh { color: #666666 } /* Literal.Number.Hex */ .highlight-ipynb .mi { color: #666666 } /* Literal.Number.Integer */ .highlight-ipynb .mo { color: #666666 } /* Literal.Number.Oct */ .highlight-ipynb .sa { color: #BA2121 } /* Literal.String.Affix */ .highlight-ipynb .sb { color: #BA2121 } /* Literal.String.Backtick */ .highlight-ipynb .sc { color: #BA2121 } /* Literal.String.Char */ .highlight-ipynb .dl { color: #BA2121 } /* Literal.String.Delimiter */ .highlight-ipynb .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */ .highlight-ipynb .s2 { color: #BA2121 } /* Literal.String.Double */ .highlight-ipynb .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */ .highlight-ipynb .sh { color: #BA2121 } /* Literal.String.Heredoc */ .highlight-ipynb .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */ .highlight-ipynb .sx { color: #008000 } /* Literal.String.Other */ .highlight-ipynb .sr { color: #BB6688 } /* Literal.String.Regex */ .highlight-ipynb .s1 { color: #BA2121 } /* Literal.String.Single */ .highlight-ipynb .ss { color: #19177C } /* Literal.String.Symbol */ .highlight-ipynb .bp { color: #008000 } /* Name.Builtin.Pseudo */ .highlight-ipynb .fm { color: #0000FF } /* Name.Function.Magic */ .highlight-ipynb .vc { color: #19177C } /* Name.Variable.Class */ .highlight-ipynb .vg { color: #19177C } /* Name.Variable.Global */ .highlight-ipynb .vi { color: #19177C } /* Name.Variable.Instance */ .highlight-ipynb .vm { color: #19177C } /* Name.Variable.Magic */ .highlight-ipynb .il { color: #666666 } /* Literal.Number.Integer.Long */ .rendered_html a{text-decoration:inherit !important}.rendered_html :link{text-decoration:inherit !important}.rendered_html :visited{text-decoration:inherit !important}pre code{background-color:inherit !important}.highlight{color:#000000}.highlight code{color:#000000}.highlight .n{color:#333333}.highlight .p{color:#000000}.text_cell .prompt{display:none !important}div.input_prompt{padding:0.2em 0.4em}div.output_prompt{padding:0.4em}.text_cell{margin:0 !important;padding:0 !important;border:none !important}.text_cell_render{margin:0 !important;padding:0 !important;border:none !important}.rendered_html *+p{margin-top:inherit !important}.anchor-link{display:none !important}.code_cell{margin:0 !important;padding:5px 0 !important;border:none !important}.celltoolbar{border:thin solid #CFCFCF;border-bottom:none;background:#EEE;border-radius:2px 2px 0px 0px;width:100%;height:29px;padding-right:4px;box-orient:horizontal;box-align:stretch;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;box-pack:end;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start;display:-webkit-flex}.celltoolbar .tags_button_container{display:-webkit-box;display:-ms-flexbox;display:flex}.celltoolbar .tags_button_container .tag-container{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;overflow:hidden;position:relative}.celltoolbar .tags_button_container .tag-container .cell-tag{background-color:#fff;white-space:nowrap;margin:3px 4px;padding:0 4px;border-radius:1px;border:1px solid #ccc;-webkit-box-shadow:none;box-shadow:none;width:inherit;font-size:13px;font-family:\"Helvetica Neue\", Helvetica, Arial, sans-serif;height:22px;line-height:22px;display:inline-block}div.input_area>div.highlight{margin:0.25em 0.4em !important}.code_cell pre{font-size:12px !important}.output_html table.dataframe{font-family:Arial, sans-serif;font-size:13px;line-height:20px}.output_html table.dataframe th,td{padding:4px;text-align:left}.bk-plot-wrapper tbody tr{background:none !important}.bk-plot-wrapper tbody tr:hover{background:none !important} /*# sourceMappingURL=jupyter-fixes.min.css.map */ MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], [\"\\\\(\",\"\\\\)\"] ], displayMath: [ ['$$','$$'], [\"\\\\[\",\"\\\\]\"] ], processEscapes: true, processEnvironments: true }, // Center justify equations in code and markdown cells. Elsewhere // we use CSS to left justify single line equations in code cells. displayAlign: 'center', \"HTML-CSS\": { styles: {'.MathJax_Display': {\"margin\": 0}}, linebreaks: { automatic: true } } }); Full list of functions provided in PFA specification is available here . In [1]: from titus.genpy import PFAEngine inputs = range ( 1 , 10 ) One-parameter Functions \u00b6 One-parameter functions accept a single input argument. Examples: m.sqrt m.sin m.cos m.tan m.exp m.ln (natural logarithm) m.log10 (logarithm base 10) m.floor m.ceil m.round One-parameter functions do not need to enclose arguments in square brackets: {\"m.sin\": 3.14} is permitted instead of {\"m.sin\": [3.14]} . YAML In [2]: pfa = \"\"\" input: double output: double action: - m.sqrt: [input]\"\"\" In [3]: engine , = PFAEngine . fromYaml ( pfa ) In [4]: for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0 [ ] for single parameter function is not mandatory. In [5]: pfa = \"\"\" input: double output: double action: - m.sqrt: input\"\"\" In [6]: engine , = PFAEngine . fromYaml ( pfa ) for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0 JSON In [7]: pfa = \"\"\" { \"input\":\"double\", \"output\":\"double\", \"action\":[ {\"m.sqrt\": \"input\"} ] } \"\"\" engine , = PFAEngine . fromJson ( pfa ) for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0 Two-parameter Functions \u00b6 Two-parameter functions accept two input arguments. Examples: \"+\" (addition) \"-\" (subtraction) \"x\" (multiplication) \"/\" (floating-point division) \"//\" (integer division) \"u-\" (negation) \"%\" (modulo) \"%%\" (remainder) \"xx\" (exponentiation) YAML In [8]: pfa = \"\"\" input: double output: double action: - {m.round: {\"*\": [{m.sin: {+: [input, 100]}}, 100]}}\"\"\" engine2 , = PFAEngine . fromYaml ( pfa ) for num in inputs : print ( engine2 . action ( num )) 45 99 62 -32 -97 -73 18 93 82 JSON In [9]: pfa = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"action\": [{ \"m.round\": { \"*\": [ {\"m.sin\": {\"+\": [\"input\", 100]}}, 100 ] } }] } \"\"\" engine2 , = PFAEngine . fromJson ( pfa ) for num in inputs : print ( engine2 . action ( num )) 45 99 62 -32 -97 -73 18 93 82","title":"Using Built-in Functions"},{"location":"tutorials/using-built-in-functions/#one-parameter-functions","text":"One-parameter functions accept a single input argument. Examples: m.sqrt m.sin m.cos m.tan m.exp m.ln (natural logarithm) m.log10 (logarithm base 10) m.floor m.ceil m.round One-parameter functions do not need to enclose arguments in square brackets: {\"m.sin\": 3.14} is permitted instead of {\"m.sin\": [3.14]} . YAML In [2]: pfa = \"\"\" input: double output: double action: - m.sqrt: [input]\"\"\" In [3]: engine , = PFAEngine . fromYaml ( pfa ) In [4]: for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0 [ ] for single parameter function is not mandatory. In [5]: pfa = \"\"\" input: double output: double action: - m.sqrt: input\"\"\" In [6]: engine , = PFAEngine . fromYaml ( pfa ) for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0 JSON In [7]: pfa = \"\"\" { \"input\":\"double\", \"output\":\"double\", \"action\":[ {\"m.sqrt\": \"input\"} ] } \"\"\" engine , = PFAEngine . fromJson ( pfa ) for num in inputs : print ( engine . action ( num )) 1.0 1.4142135623730951 1.7320508075688772 2.0 2.23606797749979 2.449489742783178 2.6457513110645907 2.8284271247461903 3.0","title":"One-parameter Functions"},{"location":"tutorials/using-built-in-functions/#two-parameter-functions","text":"Two-parameter functions accept two input arguments. Examples: \"+\" (addition) \"-\" (subtraction) \"x\" (multiplication) \"/\" (floating-point division) \"//\" (integer division) \"u-\" (negation) \"%\" (modulo) \"%%\" (remainder) \"xx\" (exponentiation) YAML In [8]: pfa = \"\"\" input: double output: double action: - {m.round: {\"*\": [{m.sin: {+: [input, 100]}}, 100]}}\"\"\" engine2 , = PFAEngine . fromYaml ( pfa ) for num in inputs : print ( engine2 . action ( num )) 45 99 62 -32 -97 -73 18 93 82 JSON In [9]: pfa = \"\"\" { \"input\": \"double\", \"output\": \"double\", \"action\": [{ \"m.round\": { \"*\": [ {\"m.sin\": {\"+\": [\"input\", 100]}}, 100 ] } }] } \"\"\" engine2 , = PFAEngine . fromJson ( pfa ) for num in inputs : print ( engine2 . action ( num )) 45 99 62 -32 -97 -73 18 93 82","title":"Two-parameter Functions"}]}